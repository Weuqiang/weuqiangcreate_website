---
sidebar_position: 7
title: 
tags: [, , Jest, React Testing Library, E2E]
---

# 

E2E

## 

```javascript
const testPyramid = {
  // 
  structure: {
    e2e: {
      level: '',
      percentage: '10%',
      cost: '',
      speed: '',
      coverage: ''
    },
    integration: {
      level: '',
      percentage: '20%',
      cost: '',
      speed: '',
      coverage: ''
    },
    unit: {
      level: '',
      percentage: '70%',
      cost: '',
      speed: '',
      coverage: ''
    }
  },
  
  principles: [
    '',
    '',
    'E2E',
    ''
  ]
};
```

## 

### Jest

```javascript
// sum.js
export function sum(a, b) {
  return a + b;
}

// sum.test.js
import { sum } from './sum';

describe('sum', () => {
  test('1 + 2 = 3', () => {
    expect(sum(1, 2)).toBe(3);
  });
  
  test('', () => {
    expect(sum(-1, -2)).toBe(-3);
  });
  
  test('', () => {
    expect(sum(0.1, 0.2)).toBeCloseTo(0.3);
  });
});

// 
describe('', () => {
  test('', () => {
    expect(2 + 2).toBe(4);                    // 
    expect({ name: 'John' }).toEqual({ name: 'John' }); // 
  });
  
  test('', () => {
    expect(true).toBeTruthy();
    expect(false).toBeFalsy();
    expect(null).toBeNull();
    expect(undefined).toBeUndefined();
    expect('hello').toBeDefined();
  });
  
  test('', () => {
    expect(10).toBeGreaterThan(5);
    expect(10).toBeGreaterThanOrEqual(10);
    expect(5).toBeLessThan(10);
    expect(5).toBeLessThanOrEqual(5);
  });
  
  test('', () => {
    expect('hello world').toMatch(/world/);
    expect('hello').toContain('ell');
  });
  
  test('', () => {
    expect([1, 2, 3]).toContain(2);
    expect([1, 2, 3]).toHaveLength(3);
  });
  
  test('', () => {
    expect({ name: 'John', age: 30 }).toHaveProperty('name');
    expect({ name: 'John', age: 30 }).toHaveProperty('name', 'John');
  });
  
  test('', () => {
    expect(() => {
      throw new Error('');
    }).toThrow('');
  });
});
```

### 

```javascript
// api.js
export async function fetchUser(id) {
  const response = await fetch(`/api/users/${id}`);
  return response.json();
}

// api.test.js
import { fetchUser } from './api';

describe('fetchUser', () => {
  // 1Promise
  test('', () => {
    return fetchUser(1).then(user => {
      expect(user.name).toBe('John');
    });
  });
  
  // 2async/await
  test('', async () => {
    const user = await fetchUser(1);
    expect(user.name).toBe('John');
  });
  
  // 3resolves/rejects
  test('', () => {
    return expect(fetchUser(1)).resolves.toEqual({
      id: 1,
      name: 'John'
    });
  });
  
  test('', () => {
    return expect(fetchUser(-1)).rejects.toThrow('User not found');
  });
});
```

### MockSpy

```javascript
// 
describe('Mock', () => {
  test('', () => {
    const mockFn = jest.fn();
    
    mockFn('hello');
    mockFn('world');
    
    expect(mockFn).toHaveBeenCalledTimes(2);
    expect(mockFn).toHaveBeenCalledWith('hello');
    expect(mockFn).toHaveBeenLastCalledWith('world');
  });
  
  test('', () => {
    const mockFn = jest.fn()
      .mockReturnValue(42)
      .mockReturnValueOnce(1)
      .mockReturnValueOnce(2);
    
    expect(mockFn()).toBe(1);
    expect(mockFn()).toBe(2);
    expect(mockFn()).toBe(42);
  });
  
  test('', () => {
    const mockFn = jest.fn(x => x * 2);
    
    expect(mockFn(5)).toBe(10);
  });
});

// 
jest.mock('./api');

import { fetchUser } from './api';

test('API', async () => {
  fetchUser.mockResolvedValue({ id: 1, name: 'John' });
  
  const user = await fetchUser(1);
  expect(user.name).toBe('John');
});

// Spy
describe('Spy', () => {
  test('', () => {
    const user = {
      getName: () => 'John'
    };
    
    const spy = jest.spyOn(user, 'getName');
    
    user.getName();
    
    expect(spy).toHaveBeenCalled();
    
    spy.mockRestore();
  });
});
```

## React

### React Testing Library

```javascript
// Button.jsx
export function Button({ onClick, children }) {
  return (
    <button onClick={onClick}>
      {children}
    </button>
  );
}

// Button.test.jsx
import { render, screen, fireEvent } from '@testing-library/react';
import { Button } from './Button';

describe('Button', () => {
  test('', () => {
    render(<Button>Click me</Button>);
    
    expect(screen.getByText('Click me')).toBeInTheDocument();
  });
  
  test('', () => {
    const handleClick = jest.fn();
    render(<Button onClick={handleClick}>Click me</Button>);
    
    fireEvent.click(screen.getByText('Click me'));
    
    expect(handleClick).toHaveBeenCalledTimes(1);
  });
});

// Counter.jsx
import { useState } from 'react';

export function Counter() {
  const [count, setCount] = useState(0);
  
  return (
    <div>
      <p>Count: {count}</p>
      <button onClick={() => setCount(count + 1)}>Increment</button>
      <button onClick={() => setCount(count - 1)}>Decrement</button>
    </div>
  );
}

// Counter.test.jsx
import { render, screen, fireEvent } from '@testing-library/react';
import { Counter } from './Counter';

describe('Counter', () => {
  test('0', () => {
    render(<Counter />);
    expect(screen.getByText('Count: 0')).toBeInTheDocument();
  });
  
  test('', () => {
    render(<Counter />);
    
    fireEvent.click(screen.getByText('Increment'));
    expect(screen.getByText('Count: 1')).toBeInTheDocument();
    
    fireEvent.click(screen.getByText('Increment'));
    expect(screen.getByText('Count: 2')).toBeInTheDocument();
  });
  
  test('', () => {
    render(<Counter />);
    
    fireEvent.click(screen.getByText('Decrement'));
    expect(screen.getByText('Count: -1')).toBeInTheDocument();
  });
});
```

### 

```javascript
// UserProfile.jsx
import { useState, useEffect } from 'react';

export function UserProfile({ userId }) {
  const [user, setUser] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);
  
  useEffect(() => {
    fetchUser(userId)
      .then(data => {
        setUser(data);
        setLoading(false);
      })
      .catch(err => {
        setError(err.message);
        setLoading(false);
      });
  }, [userId]);
  
  if (loading) return <div>Loading...</div>;
  if (error) return <div>Error: {error}</div>;
  
  return (
    <div>
      <h1>{user.name}</h1>
      <p>{user.email}</p>
    </div>
  );
}

// UserProfile.test.jsx
import { render, screen, waitFor } from '@testing-library/react';
import { UserProfile } from './UserProfile';
import { fetchUser } from './api';

jest.mock('./api');

describe('UserProfile', () => {
  test('', () => {
    fetchUser.mockImplementation(() => new Promise(() => {}));
    
    render(<UserProfile userId={1} />);
    
    expect(screen.getByText('Loading...')).toBeInTheDocument();
  });
  
  test('', async () => {
    fetchUser.mockResolvedValue({
      name: 'John',
      email: 'john@example.com'
    });
    
    render(<UserProfile userId={1} />);
    
    await waitFor(() => {
      expect(screen.getByText('John')).toBeInTheDocument();
      expect(screen.getByText('john@example.com')).toBeInTheDocument();
    });
  });
  
  test('', async () => {
    fetchUser.mockRejectedValue(new Error('Failed to fetch'));
    
    render(<UserProfile userId={1} />);
    
    await waitFor(() => {
      expect(screen.getByText('Error: Failed to fetch')).toBeInTheDocument();
    });
  });
});
```

### Hooks

```javascript
// useCounter.js
import { useState, useCallback } from 'react';

export function useCounter(initialValue = 0) {
  const [count, setCount] = useState(initialValue);
  
  const increment = useCallback(() => {
    setCount(c => c + 1);
  }, []);
  
  const decrement = useCallback(() => {
    setCount(c => c - 1);
  }, []);
  
  const reset = useCallback(() => {
    setCount(initialValue);
  }, [initialValue]);
  
  return { count, increment, decrement, reset };
}

// useCounter.test.js
import { renderHook, act } from '@testing-library/react';
import { useCounter } from './useCounter';

describe('useCounter', () => {
  test('', () => {
    const { result } = renderHook(() => useCounter(10));
    
    expect(result.current.count).toBe(10);
  });
  
  test('', () => {
    const { result } = renderHook(() => useCounter());
    
    act(() => {
      result.current.increment();
    });
    
    expect(result.current.count).toBe(1);
  });
  
  test('', () => {
    const { result } = renderHook(() => useCounter());
    
    act(() => {
      result.current.decrement();
    });
    
    expect(result.current.count).toBe(-1);
  });
  
  test('', () => {
    const { result } = renderHook(() => useCounter(10));
    
    act(() => {
      result.current.increment();
      result.current.increment();
    });
    
    expect(result.current.count).toBe(12);
    
    act(() => {
      result.current.reset();
    });
    
    expect(result.current.count).toBe(10);
  });
});
```

## 

### 

```javascript
// TodoList.jsx
import { useState } from 'react';

export function TodoList() {
  const [todos, setTodos] = useState([]);
  const [input, setInput] = useState('');
  
  const addTodo = () => {
    if (input.trim()) {
      setTodos([...todos, { id: Date.now(), text: input, completed: false }]);
      setInput('');
    }
  };
  
  const toggleTodo = (id) => {
    setTodos(todos.map(todo =>
      todo.id === id ? { ...todo, completed: !todo.completed } : todo
    ));
  };
  
  const deleteTodo = (id) => {
    setTodos(todos.filter(todo => todo.id !== id));
  };
  
  return (
    <div>
      <input
        value={input}
        onChange={e => setInput(e.target.value)}
        placeholder="Add todo"
      />
      <button onClick={addTodo}>Add</button>
      
      <ul>
        {todos.map(todo => (
          <li key={todo.id}>
            <input
              type="checkbox"
              checked={todo.completed}
              onChange={() => toggleTodo(todo.id)}
            />
            <span style={{ textDecoration: todo.completed ? 'line-through' : 'none' }}>
              {todo.text}
            </span>
            <button onClick={() => deleteTodo(todo.id)}>Delete</button>
          </li>
        ))}
      </ul>
    </div>
  );
}

// TodoList.test.jsx
import { render, screen, fireEvent } from '@testing-library/react';
import userEvent from '@testing-library/user-event';
import { TodoList } from './TodoList';

describe('TodoList', () => {
  test('Todo', async () => {
    const user = userEvent.setup();
    render(<TodoList />);
    
    // Todo
    const input = screen.getByPlaceholderText('Add todo');
    const addButton = screen.getByText('Add');
    
    await user.type(input, 'Buy milk');
    await user.click(addButton);
    
    expect(screen.getByText('Buy milk')).toBeInTheDocument();
    
    // Todo
    await user.type(input, 'Buy eggs');
    await user.click(addButton);
    
    expect(screen.getByText('Buy eggs')).toBeInTheDocument();
    
    // Todo
    const checkbox = screen.getAllByRole('checkbox')[0];
    await user.click(checkbox);
    
    expect(screen.getByText('Buy milk')).toHaveStyle({
      textDecoration: 'line-through'
    });
    
    // Todo
    const deleteButtons = screen.getAllByText('Delete');
    await user.click(deleteButtons[0]);
    
    expect(screen.queryByText('Buy milk')).not.toBeInTheDocument();
    expect(screen.getByText('Buy eggs')).toBeInTheDocument();
  });
});
```

## E2E

### Cypress

```javascript
// cypress/e2e/login.cy.js
describe('', () => {
  beforeEach(() => {
    cy.visit('/login');
  });
  
  it('', () => {
    cy.get('[data-testid="email"]').type('user@example.com');
    cy.get('[data-testid="password"]').type('password123');
    cy.get('[data-testid="submit"]').click();
    
    cy.url().should('include', '/dashboard');
    cy.contains('Welcome').should('be.visible');
  });
  
  it('', () => {
    cy.get('[data-testid="email"]').type('wrong@example.com');
    cy.get('[data-testid="password"]').type('wrongpassword');
    cy.get('[data-testid="submit"]').click();
    
    cy.contains('Invalid credentials').should('be.visible');
  });
  
  it('', () => {
    cy.get('[data-testid="submit"]').click();
    
    cy.contains('Email is required').should('be.visible');
    cy.contains('Password is required').should('be.visible');
  });
});

// cypress/e2e/shopping.cy.js
describe('', () => {
  it('', () => {
    // 
    cy.visit('/login');
    cy.get('[data-testid="email"]').type('user@example.com');
    cy.get('[data-testid="password"]').type('password123');
    cy.get('[data-testid="submit"]').click();
    
    // 
    cy.visit('/products');
    cy.contains('iPhone').click();
    
    // 
    cy.get('[data-testid="add-to-cart"]').click();
    cy.contains('Added to cart').should('be.visible');
    
    // 
    cy.get('[data-testid="cart-icon"]').click();
    cy.contains('iPhone').should('be.visible');
    
    // 
    cy.get('[data-testid="checkout"]').click();
    cy.get('[data-testid="address"]').type('123 Main St');
    cy.get('[data-testid="confirm-order"]').click();
    
    // 
    cy.contains('Order placed successfully').should('be.visible');
  });
});
```

### Playwright

```javascript
// tests/login.spec.js
import { test, expect } from '@playwright/test';

test.describe('', () => {
  test.beforeEach(async ({ page }) => {
    await page.goto('/login');
  });
  
  test('', async ({ page }) => {
    await page.fill('[data-testid="email"]', 'user@example.com');
    await page.fill('[data-testid="password"]', 'password123');
    await page.click('[data-testid="submit"]');
    
    await expect(page).toHaveURL(/.*dashboard/);
    await expect(page.locator('text=Welcome')).toBeVisible();
  });
  
  test('', async ({ page }) => {
    await page.fill('[data-testid="email"]', 'wrong@example.com');
    await page.fill('[data-testid="password"]', 'wrongpassword');
    await page.click('[data-testid="submit"]');
    
    await expect(page.locator('text=Invalid credentials')).toBeVisible();
  });
});
```

## 

```javascript
// jest.config.js
module.exports = {
  collectCoverage: true,
  collectCoverageFrom: [
    'src/**/*.{js,jsx,ts,tsx}',
    '!src/**/*.test.{js,jsx,ts,tsx}',
    '!src/index.js'
  ],
  coverageThreshold: {
    global: {
      branches: 80,
      functions: 80,
      lines: 80,
      statements: 80
    }
  }
};

// 
// npm test -- --coverage
```

## 

```javascript
const testingBestPractices = {
  // 1. 
  naming: {
    describe: '',
    test: '',
    example: 'test("", () => {})'
  },
  
  // 2. AAA
  aaa: {
    arrange: '',
    act: '',
    assert: ''
  },
  
  // 3. 
  independence: [
    '',
    '',
    'beforeEach'
  ],
  
  // 4. 
  readability: [
    '',
    '',
    ''
  ],
  
  // 5. 
  coverage: [
    '',
    '',
    '100%'
  ]
};
```

## 


-  ****Jest
-  ****
-  **E2E**CypressPlaywright
-  ****
-  ****AAA

****

