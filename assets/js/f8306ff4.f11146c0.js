"use strict";(globalThis.webpackChunkweuqiangcreate_website=globalThis.webpackChunkweuqiangcreate_website||[]).push([[74778],{21(n,e,r){r.r(e),r.d(e,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>i,metadata:()=>a,toc:()=>o});const a=JSON.parse('{"id":"\u6570\u5b66\u57fa\u7840/\u5fae\u79ef\u5206\u4e0e\u4f18\u5316","title":"\u5fae\u79ef\u5206\u4e0e\u4f18\u5316 - \u8bad\u7ec3\u795e\u7ecf\u7f51\u7edc\u7684\u6570\u5b66","description":"\u5fae\u79ef\u5206\u542c\u8d77\u6765\u5f88\u5413\u4eba\uff1f\u5176\u5b9e\u5b83\u5c31\u662f\u544a\u8bc9\u4f60\u5f80\u54ea\u4e2a\u65b9\u5411\u8c03\u6574\u53c2\u6570\u3002\u8fd9\u4e00\u7ae0\u6559\u4f60\u771f\u6b63\u7406\u89e3\u68af\u5ea6\u4e0b\u964d\u548c\u53cd\u5411\u4f20\u64ad\u3002","source":"@site/docs/docs/\u6570\u5b66\u57fa\u7840/\u5fae\u79ef\u5206\u4e0e\u4f18\u5316.mdx","sourceDirName":"\u6570\u5b66\u57fa\u7840","slug":"/\u6570\u5b66\u57fa\u7840/\u5fae\u79ef\u5206\u4e0e\u4f18\u5316","permalink":"/weuqiangcreate_website/docs/\u6570\u5b66\u57fa\u7840/\u5fae\u79ef\u5206\u4e0e\u4f18\u5316","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"\u5fae\u79ef\u5206\u4e0e\u4f18\u5316 - \u8bad\u7ec3\u795e\u7ecf\u7f51\u7edc\u7684\u6570\u5b66"},"sidebar":"tutorialSidebar","previous":{"title":"\u6982\u7387\u7edf\u8ba1 - \u7406\u89e3AI\u7684\u4e0d\u786e\u5b9a\u6027","permalink":"/weuqiangcreate_website/docs/\u6570\u5b66\u57fa\u7840/\u6982\u7387\u7edf\u8ba1"},"next":{"title":"\u4fe1\u606f\u8bba - \u8861\u91cf\u4fe1\u606f\u7684\u6570\u5b66","permalink":"/weuqiangcreate_website/docs/\u6570\u5b66\u57fa\u7840/\u4fe1\u606f\u8bba"}}');var t=r(74848),d=r(28453);const i={sidebar_position:3,title:"\u5fae\u79ef\u5206\u4e0e\u4f18\u5316 - \u8bad\u7ec3\u795e\u7ecf\u7f51\u7edc\u7684\u6570\u5b66"},s="\u5fae\u79ef\u5206\u4e0e\u4f18\u5316 - \u8ba9AI\u5b66\u4f1a\u5b66\u4e60",l={},o=[{value:"\u7b2c\u4e00\u90e8\u5206\uff1a\u5bfc\u6570 - \u53d8\u5316\u7387",id:"\u7b2c\u4e00\u90e8\u5206\u5bfc\u6570---\u53d8\u5316\u7387",level:2},{value:"\u4ec0\u4e48\u662f\u5bfc\u6570\uff1f",id:"\u4ec0\u4e48\u662f\u5bfc\u6570",level:3},{value:"\u5e38\u89c1\u51fd\u6570\u7684\u5bfc\u6570",id:"\u5e38\u89c1\u51fd\u6570\u7684\u5bfc\u6570",level:3},{value:"\u68af\u5ea6\u4e0b\u964d - \u627e\u6700\u5c0f\u503c",id:"\u68af\u5ea6\u4e0b\u964d---\u627e\u6700\u5c0f\u503c",level:3},{value:"\u7b2c\u4e8c\u90e8\u5206\uff1a\u94fe\u5f0f\u6cd5\u5219 - \u53cd\u5411\u4f20\u64ad\u7684\u6838\u5fc3",id:"\u7b2c\u4e8c\u90e8\u5206\u94fe\u5f0f\u6cd5\u5219---\u53cd\u5411\u4f20\u64ad\u7684\u6838\u5fc3",level:2},{value:"\u4ec0\u4e48\u662f\u94fe\u5f0f\u6cd5\u5219\uff1f",id:"\u4ec0\u4e48\u662f\u94fe\u5f0f\u6cd5\u5219",level:3},{value:"\u795e\u7ecf\u7f51\u7edc\u4e2d\u7684\u94fe\u5f0f\u6cd5\u5219",id:"\u795e\u7ecf\u7f51\u7edc\u4e2d\u7684\u94fe\u5f0f\u6cd5\u5219",level:3},{value:"\u7b2c\u4e09\u90e8\u5206\uff1a\u5e38\u89c1\u6fc0\u6d3b\u51fd\u6570\u53ca\u5176\u5bfc\u6570",id:"\u7b2c\u4e09\u90e8\u5206\u5e38\u89c1\u6fc0\u6d3b\u51fd\u6570\u53ca\u5176\u5bfc\u6570",level:2},{value:"\u7b2c\u56db\u90e8\u5206\uff1a\u5b9e\u6218 - \u81ea\u52a8\u6c42\u5bfc\u7cfb\u7edf",id:"\u7b2c\u56db\u90e8\u5206\u5b9e\u6218---\u81ea\u52a8\u6c42\u5bfc\u7cfb\u7edf",level:2}];function x(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,d.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"\u5fae\u79ef\u5206\u4e0e\u4f18\u5316---\u8ba9ai\u5b66\u4f1a\u5b66\u4e60",children:"\u5fae\u79ef\u5206\u4e0e\u4f18\u5316 - \u8ba9AI\u5b66\u4f1a\u5b66\u4e60"})}),"\n",(0,t.jsxs)(e.p,{children:["\u5fae\u79ef\u5206\u542c\u8d77\u6765\u5f88\u5413\u4eba\uff1f\u5176\u5b9e\u5b83\u5c31\u662f",(0,t.jsx)(e.strong,{children:"\u544a\u8bc9\u4f60\u5f80\u54ea\u4e2a\u65b9\u5411\u8c03\u6574\u53c2\u6570"}),"\u3002\u8fd9\u4e00\u7ae0\u6559\u4f60\u771f\u6b63\u7406\u89e3\u68af\u5ea6\u4e0b\u964d\u548c\u53cd\u5411\u4f20\u64ad\u3002"]}),"\n",(0,t.jsx)(e.h2,{id:"\u7b2c\u4e00\u90e8\u5206\u5bfc\u6570---\u53d8\u5316\u7387",children:"\u7b2c\u4e00\u90e8\u5206\uff1a\u5bfc\u6570 - \u53d8\u5316\u7387"}),"\n",(0,t.jsx)(e.h3,{id:"\u4ec0\u4e48\u662f\u5bfc\u6570",children:"\u4ec0\u4e48\u662f\u5bfc\u6570\uff1f"}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"\u5bfc\u6570\u5c31\u662f\u51fd\u6570\u7684\u53d8\u5316\u7387"}),"\u3002"]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"import numpy as np\nimport matplotlib.pyplot as plt\n\n# \u51fd\u6570\uff1ay = x^2\nx = np.linspace(-5, 5, 100)\ny = x ** 2\n\n# \u5bfc\u6570\uff1ady/dx = 2x\ndy_dx = 2 * x\n\n# \u53ef\u89c6\u5316\nfig, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 4))\n\nax1.plot(x, y, 'b-', linewidth=2)\nax1.set_title('\u51fd\u6570: y = x\xb2')\nax1.set_xlabel('x')\nax1.set_ylabel('y')\nax1.grid(True)\n\nax2.plot(x, dy_dx, 'r-', linewidth=2)\nax2.axhline(y=0, color='k', linestyle='--')\nax2.set_title('\u5bfc\u6570: dy/dx = 2x')\nax2.set_xlabel('x')\nax2.set_ylabel('dy/dx')\nax2.grid(True)\n\nplt.tight_layout()\nplt.show()\n"})}),"\n",(0,t.jsxs)(e.p,{children:[(0,t.jsx)(e.strong,{children:"\u5bfc\u6570\u7684\u610f\u4e49"}),"\uff1a"]}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"\u5bfc\u6570 > 0\uff1a\u51fd\u6570\u5728\u589e\u52a0\uff0c\u5f80\u5de6\u8d70\u80fd\u51cf\u5c0f"}),"\n",(0,t.jsx)(e.li,{children:"\u5bfc\u6570 < 0\uff1a\u51fd\u6570\u5728\u51cf\u5c11\uff0c\u5f80\u53f3\u8d70\u80fd\u51cf\u5c0f"}),"\n",(0,t.jsx)(e.li,{children:"\u5bfc\u6570 = 0\uff1a\u53ef\u80fd\u662f\u6700\u5c0f\u503c\u6216\u6700\u5927\u503c"}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"\u5e38\u89c1\u51fd\u6570\u7684\u5bfc\u6570",children:"\u5e38\u89c1\u51fd\u6570\u7684\u5bfc\u6570"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'# 1. \u5e42\u51fd\u6570\uff1ad(x^n)/dx = n*x^(n-1)\ndef power_derivative(x, n):\n    return n * x ** (n - 1)\n\n# 2. \u6307\u6570\u51fd\u6570\uff1ad(e^x)/dx = e^x\ndef exp_derivative(x):\n    return np.exp(x)\n\n# 3. \u5bf9\u6570\u51fd\u6570\uff1ad(ln(x))/dx = 1/x\ndef log_derivative(x):\n    return 1 / x\n\n# 4. \u4e09\u89d2\u51fd\u6570\uff1ad(sin(x))/dx = cos(x)\ndef sin_derivative(x):\n    return np.cos(x)\n\n# \u9a8c\u8bc1\nx = 2.0\nh = 0.0001\n\n# \u6570\u503c\u5bfc\u6570\nf = lambda x: x**3\nnumerical = (f(x + h) - f(x)) / h\nanalytical = 3 * x**2\n\nprint(f"\u6570\u503c\u5bfc\u6570: {numerical:.6f}")\nprint(f"\u89e3\u6790\u5bfc\u6570: {analytical:.6f}")\nprint(f"\u8bef\u5dee: {abs(numerical - analytical):.10f}")\n'})}),"\n",(0,t.jsx)(e.h3,{id:"\u68af\u5ea6\u4e0b\u964d---\u627e\u6700\u5c0f\u503c",children:"\u68af\u5ea6\u4e0b\u964d - \u627e\u6700\u5c0f\u503c"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"def gradient_descent_demo():\n    \"\"\"\u68af\u5ea6\u4e0b\u964d\u627e\u6700\u5c0f\u503c\"\"\"\n    # \u51fd\u6570\uff1af(x) = (x - 3)^2\n    # \u5bfc\u6570\uff1af'(x) = 2(x - 3)\n    \n    def f(x):\n        return (x - 3) ** 2\n    \n    def df(x):\n        return 2 * (x - 3)\n    \n    # \u68af\u5ea6\u4e0b\u964d\n    x = 0  # \u8d77\u70b9\n    learning_rate = 0.1\n    history = [x]\n    \n    for i in range(20):\n        gradient = df(x)\n        x = x - learning_rate * gradient  # \u5f80\u68af\u5ea6\u53cd\u65b9\u5411\u8d70\n        history.append(x)\n        \n        if i % 5 == 0:\n            print(f\"Step {i}: x = {x:.4f}, f(x) = {f(x):.4f}, gradient = {gradient:.4f}\")\n    \n    # \u53ef\u89c6\u5316\n    x_plot = np.linspace(-1, 7, 100)\n    y_plot = f(x_plot)\n    \n    plt.figure(figsize=(10, 6))\n    plt.plot(x_plot, y_plot, 'b-', linewidth=2, label='f(x) = (x-3)\xb2')\n    plt.plot(history, [f(h) for h in history], 'ro-', markersize=8, label='\u68af\u5ea6\u4e0b\u964d\u8def\u5f84')\n    plt.xlabel('x')\n    plt.ylabel('f(x)')\n    plt.title('\u68af\u5ea6\u4e0b\u964d\u627e\u6700\u5c0f\u503c')\n    plt.legend()\n    plt.grid(True)\n    plt.show()\n    \n    print(f\"\\n\u6700\u7ec8\u7ed3\u679c: x = {x:.4f}, \u7406\u8bba\u6700\u5c0f\u503c\u70b9: x = 3\")\n\ngradient_descent_demo()\n"})}),"\n",(0,t.jsx)(e.h2,{id:"\u7b2c\u4e8c\u90e8\u5206\u94fe\u5f0f\u6cd5\u5219---\u53cd\u5411\u4f20\u64ad\u7684\u6838\u5fc3",children:"\u7b2c\u4e8c\u90e8\u5206\uff1a\u94fe\u5f0f\u6cd5\u5219 - \u53cd\u5411\u4f20\u64ad\u7684\u6838\u5fc3"}),"\n",(0,t.jsx)(e.h3,{id:"\u4ec0\u4e48\u662f\u94fe\u5f0f\u6cd5\u5219",children:"\u4ec0\u4e48\u662f\u94fe\u5f0f\u6cd5\u5219\uff1f"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"\u590d\u5408\u51fd\u6570\u7684\u5bfc\u6570 = \u5916\u5c42\u5bfc\u6570 \xd7 \u5185\u5c42\u5bfc\u6570"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'# \u94fe\u5f0f\u6cd5\u5219\uff1a\u5982\u679c y = f(g(x))\uff0c\u90a3\u4e48 dy/dx = df/dg * dg/dx\n\n# \u4f8b\u5b50\uff1ay = (2x + 1)^2\n# \u8bbe u = 2x + 1\uff0c\u5219 y = u^2\n# dy/dx = dy/du * du/dx = 2u * 2 = 4(2x + 1)\n\ndef chain_rule_example(x):\n    """\u624b\u52a8\u8ba1\u7b97\u94fe\u5f0f\u6cd5\u5219"""\n    # \u524d\u5411\u4f20\u64ad\n    u = 2 * x + 1\n    y = u ** 2\n    \n    # \u53cd\u5411\u4f20\u64ad\n    dy_du = 2 * u  # y\u5bf9u\u7684\u5bfc\u6570\n    du_dx = 2      # u\u5bf9x\u7684\u5bfc\u6570\n    dy_dx = dy_du * du_dx  # \u94fe\u5f0f\u6cd5\u5219\n    \n    return y, dy_dx\n\nx = 3\ny, grad = chain_rule_example(x)\nprint(f"x={x}, y={y}, dy/dx={grad}")\n# x=3, y=49, dy/dx=28\n\n# \u9a8c\u8bc1\nh = 0.0001\nf = lambda x: (2*x + 1)**2\nnumerical_grad = (f(x + h) - f(x)) / h\nprint(f"\u6570\u503c\u68af\u5ea6: {numerical_grad:.4f}")\n'})}),"\n",(0,t.jsx)(e.h3,{id:"\u795e\u7ecf\u7f51\u7edc\u4e2d\u7684\u94fe\u5f0f\u6cd5\u5219",children:"\u795e\u7ecf\u7f51\u7edc\u4e2d\u7684\u94fe\u5f0f\u6cd5\u5219"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'class SimpleNetwork:\n    """\u6f14\u793a\u94fe\u5f0f\u6cd5\u5219\u7684\u7b80\u5355\u7f51\u7edc"""\n    \n    def __init__(self):\n        self.W1 = np.random.randn(2, 3) * 0.01\n        self.W2 = np.random.randn(3, 1) * 0.01\n    \n    def forward(self, x):\n        """\u524d\u5411\u4f20\u64ad\uff1a\u4fdd\u5b58\u4e2d\u95f4\u7ed3\u679c"""\n        self.x = x\n        \n        # \u7b2c\u4e00\u5c42\n        self.z1 = np.dot(x, self.W1)\n        self.a1 = np.maximum(0, self.z1)  # ReLU\n        \n        # \u7b2c\u4e8c\u5c42\n        self.z2 = np.dot(self.a1, self.W2)\n        \n        return self.z2\n    \n    def backward(self, grad_output):\n        """\u53cd\u5411\u4f20\u64ad\uff1a\u94fe\u5f0f\u6cd5\u5219"""\n        # \u7b2c\u4e8c\u5c42\u68af\u5ea6\n        # dL/dW2 = dL/dz2 * dz2/dW2\n        grad_W2 = np.dot(self.a1.T, grad_output)\n        \n        # \u4f20\u5230\u7b2c\u4e00\u5c42\n        # dL/da1 = dL/dz2 * dz2/da1\n        grad_a1 = np.dot(grad_output, self.W2.T)\n        \n        # ReLU\u68af\u5ea6\n        grad_z1 = grad_a1.copy()\n        grad_z1[self.z1 <= 0] = 0\n        \n        # \u7b2c\u4e00\u5c42\u68af\u5ea6\n        # dL/dW1 = dL/dz1 * dz1/dW1\n        grad_W1 = np.dot(self.x.T, grad_z1)\n        \n        return grad_W1, grad_W2\n    \n    def check_gradients(self):\n        """\u6570\u503c\u68af\u5ea6\u68c0\u9a8c"""\n        x = np.array([[1.0, 2.0]])\n        \n        # \u524d\u5411\u4f20\u64ad\n        output = self.forward(x)\n        \n        # \u53cd\u5411\u4f20\u64ad\n        grad_W1, grad_W2 = self.backward(np.array([[1.0]]))\n        \n        # \u6570\u503c\u68af\u5ea6\n        eps = 1e-5\n        numerical_grad_W1 = np.zeros_like(self.W1)\n        \n        for i in range(self.W1.shape[0]):\n            for j in range(self.W1.shape[1]):\n                self.W1[i, j] += eps\n                output_plus = self.forward(x)\n                \n                self.W1[i, j] -= 2 * eps\n                output_minus = self.forward(x)\n                \n                self.W1[i, j] += eps\n                \n                numerical_grad_W1[i, j] = (output_plus - output_minus) / (2 * eps)\n        \n        # \u6bd4\u8f83\n        diff = np.linalg.norm(grad_W1 - numerical_grad_W1)\n        print(f"\u68af\u5ea6\u5dee\u5f02: {diff:.10f}")\n        print("\u89e3\u6790\u68af\u5ea6:\\n", grad_W1)\n        print("\u6570\u503c\u68af\u5ea6:\\n", numerical_grad_W1)\n\n# \u6d4b\u8bd5\nnet = SimpleNetwork()\nnet.check_gradients()\n'})}),"\n",(0,t.jsx)(e.h2,{id:"\u7b2c\u4e09\u90e8\u5206\u5e38\u89c1\u6fc0\u6d3b\u51fd\u6570\u53ca\u5176\u5bfc\u6570",children:"\u7b2c\u4e09\u90e8\u5206\uff1a\u5e38\u89c1\u6fc0\u6d3b\u51fd\u6570\u53ca\u5176\u5bfc\u6570"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'class ActivationFunctions:\n    """\u5e38\u89c1\u6fc0\u6d3b\u51fd\u6570\u53ca\u5176\u5bfc\u6570"""\n    \n    @staticmethod\n    def sigmoid(x):\n        """Sigmoid: \u03c3(x) = 1 / (1 + e^(-x))"""\n        return 1 / (1 + np.exp(-x))\n    \n    @staticmethod\n    def sigmoid_derivative(x):\n        """Sigmoid\u5bfc\u6570: \u03c3\'(x) = \u03c3(x) * (1 - \u03c3(x))"""\n        s = ActivationFunctions.sigmoid(x)\n        return s * (1 - s)\n    \n    @staticmethod\n    def tanh(x):\n        """Tanh: tanh(x) = (e^x - e^(-x)) / (e^x + e^(-x))"""\n        return np.tanh(x)\n    \n    @staticmethod\n    def tanh_derivative(x):\n        """Tanh\u5bfc\u6570: tanh\'(x) = 1 - tanh\xb2(x)"""\n        t = np.tanh(x)\n        return 1 - t**2\n    \n    @staticmethod\n    def relu(x):\n        """ReLU: max(0, x)"""\n        return np.maximum(0, x)\n    \n    @staticmethod\n    def relu_derivative(x):\n        """ReLU\u5bfc\u6570: 1 if x > 0 else 0"""\n        return (x > 0).astype(float)\n    \n    @staticmethod\n    def leaky_relu(x, alpha=0.01):\n        """Leaky ReLU: max(\u03b1x, x)"""\n        return np.where(x > 0, x, alpha * x)\n    \n    @staticmethod\n    def leaky_relu_derivative(x, alpha=0.01):\n        """Leaky ReLU\u5bfc\u6570"""\n        return np.where(x > 0, 1, alpha)\n    \n    @staticmethod\n    def visualize():\n        """\u53ef\u89c6\u5316\u6fc0\u6d3b\u51fd\u6570"""\n        x = np.linspace(-5, 5, 1000)\n        \n        fig, axes = plt.subplots(2, 4, figsize=(16, 8))\n        \n        # Sigmoid\n        axes[0, 0].plot(x, ActivationFunctions.sigmoid(x))\n        axes[0, 0].set_title(\'Sigmoid\')\n        axes[0, 0].grid(True)\n        \n        axes[1, 0].plot(x, ActivationFunctions.sigmoid_derivative(x))\n        axes[1, 0].set_title(\'Sigmoid\u5bfc\u6570\')\n        axes[1, 0].grid(True)\n        \n        # Tanh\n        axes[0, 1].plot(x, ActivationFunctions.tanh(x))\n        axes[0, 1].set_title(\'Tanh\')\n        axes[0, 1].grid(True)\n        \n        axes[1, 1].plot(x, ActivationFunctions.tanh_derivative(x))\n        axes[1, 1].set_title(\'Tanh\u5bfc\u6570\')\n        axes[1, 1].grid(True)\n        \n        # ReLU\n        axes[0, 2].plot(x, ActivationFunctions.relu(x))\n        axes[0, 2].set_title(\'ReLU\')\n        axes[0, 2].grid(True)\n        \n        axes[1, 2].plot(x, ActivationFunctions.relu_derivative(x))\n        axes[1, 2].set_title(\'ReLU\u5bfc\u6570\')\n        axes[1, 2].grid(True)\n        \n        # Leaky ReLU\n        axes[0, 3].plot(x, ActivationFunctions.leaky_relu(x))\n        axes[0, 3].set_title(\'Leaky ReLU\')\n        axes[0, 3].grid(True)\n        \n        axes[1, 3].plot(x, ActivationFunctions.leaky_relu_derivative(x))\n        axes[1, 3].set_title(\'Leaky ReLU\u5bfc\u6570\')\n        axes[1, 3].grid(True)\n        \n        plt.tight_layout()\n        plt.show()\n\n# \u53ef\u89c6\u5316\nActivationFunctions.visualize()\n'})}),"\n",(0,t.jsx)(e.h2,{id:"\u7b2c\u56db\u90e8\u5206\u5b9e\u6218---\u81ea\u52a8\u6c42\u5bfc\u7cfb\u7edf",children:"\u7b2c\u56db\u90e8\u5206\uff1a\u5b9e\u6218 - \u81ea\u52a8\u6c42\u5bfc\u7cfb\u7edf"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'class Tensor:\n    """\u652f\u6301\u81ea\u52a8\u6c42\u5bfc\u7684\u5f20\u91cf"""\n    \n    def __init__(self, data, requires_grad=False, _children=()):\n        self.data = np.array(data, dtype=float)\n        self.grad = None\n        self.requires_grad = requires_grad\n        self._backward = lambda: None\n        self._prev = set(_children)\n    \n    def __repr__(self):\n        return f"Tensor({self.data}, grad={self.grad})"\n    \n    def __add__(self, other):\n        """\u52a0\u6cd5"""\n        other = other if isinstance(other, Tensor) else Tensor(other)\n        out = Tensor(self.data + other.data, requires_grad=True, _children=(self, other))\n        \n        def _backward():\n            if self.requires_grad:\n                self.grad = self.grad + out.grad if self.grad is not None else out.grad.copy()\n            if other.requires_grad:\n                other.grad = other.grad + out.grad if other.grad is not None else out.grad.copy()\n        \n        out._backward = _backward\n        return out\n    \n    def __mul__(self, other):\n        """\u4e58\u6cd5"""\n        other = other if isinstance(other, Tensor) else Tensor(other)\n        out = Tensor(self.data * other.data, requires_grad=True, _children=(self, other))\n        \n        def _backward():\n            if self.requires_grad:\n                grad = other.data * out.grad\n                self.grad = self.grad + grad if self.grad is not None else grad.copy()\n            if other.requires_grad:\n                grad = self.data * out.grad\n                other.grad = other.grad + grad if other.grad is not None else grad.copy()\n        \n        out._backward = _backward\n        return out\n    \n    def __pow__(self, power):\n        """\u5e42\u8fd0\u7b97"""\n        out = Tensor(self.data ** power, requires_grad=True, _children=(self,))\n        \n        def _backward():\n            if self.requires_grad:\n                grad = power * (self.data ** (power - 1)) * out.grad\n                self.grad = self.grad + grad if self.grad is not None else grad.copy()\n        \n        out._backward = _backward\n        return out\n    \n    def relu(self):\n        """ReLU\u6fc0\u6d3b"""\n        out = Tensor(np.maximum(0, self.data), requires_grad=True, _children=(self,))\n        \n        def _backward():\n            if self.requires_grad:\n                grad = (self.data > 0).astype(float) * out.grad\n                self.grad = self.grad + grad if self.grad is not None else grad.copy()\n        \n        out._backward = _backward\n        return out\n    \n    def backward(self):\n        """\u53cd\u5411\u4f20\u64ad"""\n        # \u62d3\u6251\u6392\u5e8f\n        topo = []\n        visited = set()\n        \n        def build_topo(v):\n            if v not in visited:\n                visited.add(v)\n                for child in v._prev:\n                    build_topo(child)\n                topo.append(v)\n        \n        build_topo(self)\n        \n        # \u53cd\u5411\u4f20\u64ad\n        self.grad = np.ones_like(self.data)\n        for node in reversed(topo):\n            node._backward()\n\n# \u6d4b\u8bd5\u81ea\u52a8\u6c42\u5bfc\nprint("=== \u6d4b\u8bd51: \u7b80\u5355\u51fd\u6570 ===")\nx = Tensor([2.0], requires_grad=True)\ny = Tensor([3.0], requires_grad=True)\n\n# z = x * y + x^2\nz = x * y + x ** 2\n\nz.backward()\n\nprint(f"x = {x.data}, dx = {x.grad}")  # dx = y + 2x = 3 + 4 = 7\nprint(f"y = {y.data}, dy = {y.grad}")  # dy = x = 2\n\nprint("\\n=== \u6d4b\u8bd52: \u795e\u7ecf\u7f51\u7edc ===")\n# \u7b80\u5355\u7684\u795e\u7ecf\u7f51\u7edc\uff1ay = relu(x * w1) * w2\nx = Tensor([1.0], requires_grad=True)\nw1 = Tensor([2.0], requires_grad=True)\nw2 = Tensor([3.0], requires_grad=True)\n\nh = (x * w1).relu()\ny = h * w2\n\ny.backward()\n\nprint(f"x = {x.data}, dx = {x.grad}")\nprint(f"w1 = {w1.data}, dw1 = {w1.grad}")\nprint(f"w2 = {w2.data}, dw2 = {w2.grad}")\n'})}),"\n",(0,t.jsxs)(e.p,{children:["\u4e0b\u4e00\u7ae0\uff1a",(0,t.jsx)(e.a,{href:"/weuqiangcreate_website/docs/%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/%E4%BF%A1%E6%81%AF%E8%AE%BA",children:"\u4fe1\u606f\u8bba"})]})]})}function u(n={}){const{wrapper:e}={...(0,d.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(x,{...n})}):x(n)}},28453(n,e,r){r.d(e,{R:()=>i,x:()=>s});var a=r(96540);const t={},d=a.createContext(t);function i(n){const e=a.useContext(d);return a.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function s(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:i(n.components),a.createElement(d.Provider,{value:e},n.children)}}}]);