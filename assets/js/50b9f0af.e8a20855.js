"use strict";(globalThis.webpackChunkweuqiangcreate_website=globalThis.webpackChunkweuqiangcreate_website||[]).push([[25376],{37543(n,e,r){r.r(e),r.d(e,{assets:()=>c,contentTitle:()=>t,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"\u7f16\u7a0b\u5916\u7684\u57fa\u7840/Nginx","title":"Nginx - Web\u670d\u52a1\u5668\u4e0e\u53cd\u5411\u4ee3\u7406","description":"Nginx\u662f\u4e00\u4e2a\u9ad8\u6027\u80fd\u7684HTTP\u548c\u53cd\u5411\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u4e5f\u662f\u4e00\u4e2aIMAP/POP3/SMTP\u4ee3\u7406\u670d\u52a1\u5668\u3002\u5b83\u4ee5\u9ad8\u5e76\u53d1\u3001\u4f4e\u5185\u5b58\u5360\u7528\u8457\u79f0\uff0c\u662f\u73b0\u4ee3Web\u67b6\u6784\u7684\u6838\u5fc3\u7ec4\u4ef6\u3002","source":"@site/docs/docs/\u7f16\u7a0b\u5916\u7684\u57fa\u7840/Nginx.mdx","sourceDirName":"\u7f16\u7a0b\u5916\u7684\u57fa\u7840","slug":"/\u7f16\u7a0b\u5916\u7684\u57fa\u7840/Nginx","permalink":"/weuqiangcreate_website/docs/\u7f16\u7a0b\u5916\u7684\u57fa\u7840/Nginx","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":10,"frontMatter":{"sidebar_position":10,"title":"Nginx - Web\u670d\u52a1\u5668\u4e0e\u53cd\u5411\u4ee3\u7406"},"sidebar":"tutorialSidebar","previous":{"title":"Docker","permalink":"/weuqiangcreate_website/docs/\u7f16\u7a0b\u5916\u7684\u57fa\u7840/Docker"},"next":{"title":"\u4e8c\u8fdb\u5236\u4e0e\u7f16\u7801","permalink":"/weuqiangcreate_website/docs/\u7f16\u7a0b\u5916\u7684\u57fa\u7840/binary"}}');var i=r(74848),a=r(28453);const l={sidebar_position:10,title:"Nginx - Web\u670d\u52a1\u5668\u4e0e\u53cd\u5411\u4ee3\u7406"},t="Nginx - \u9ad8\u6027\u80fdWeb\u670d\u52a1\u5668",c={},d=[{value:"\u4e3a\u4ec0\u4e48\u9009\u62e9Nginx\uff1f",id:"\u4e3a\u4ec0\u4e48\u9009\u62e9nginx",level:2},{value:"\u6027\u80fd\u5bf9\u6bd4",id:"\u6027\u80fd\u5bf9\u6bd4",level:3},{value:"\u5e94\u7528\u573a\u666f",id:"\u5e94\u7528\u573a\u666f",level:3},{value:"\u5b89\u88c5Nginx",id:"\u5b89\u88c5nginx",level:2},{value:"Ubuntu/Debian",id:"ubuntudebian",level:3},{value:"CentOS/RHEL",id:"centosrhel",level:3},{value:"Docker\u65b9\u5f0f",id:"docker\u65b9\u5f0f",level:3},{value:"\u9a8c\u8bc1\u5b89\u88c5",id:"\u9a8c\u8bc1\u5b89\u88c5",level:3},{value:"\u6838\u5fc3\u6982\u5ff5",id:"\u6838\u5fc3\u6982\u5ff5",level:2},{value:"\u76ee\u5f55\u7ed3\u6784",id:"\u76ee\u5f55\u7ed3\u6784",level:3},{value:"\u914d\u7f6e\u6587\u4ef6\u7ed3\u6784",id:"\u914d\u7f6e\u6587\u4ef6\u7ed3\u6784",level:3},{value:"\u57fa\u7840\u914d\u7f6e",id:"\u57fa\u7840\u914d\u7f6e",level:2},{value:"1. \u9759\u6001\u7f51\u7ad9\u6258\u7ba1",id:"1-\u9759\u6001\u7f51\u7ad9\u6258\u7ba1",level:3},{value:"2. \u53cd\u5411\u4ee3\u7406",id:"2-\u53cd\u5411\u4ee3\u7406",level:3},{value:"3. \u8d1f\u8f7d\u5747\u8861",id:"3-\u8d1f\u8f7d\u5747\u8861",level:3},{value:"\u8d1f\u8f7d\u5747\u8861\u7b56\u7565",id:"\u8d1f\u8f7d\u5747\u8861\u7b56\u7565",level:3},{value:"HTTPS\u914d\u7f6e",id:"https\u914d\u7f6e",level:2},{value:"\u4f7f\u7528Let&#39;s Encrypt\u514d\u8d39\u8bc1\u4e66",id:"\u4f7f\u7528lets-encrypt\u514d\u8d39\u8bc1\u4e66",level:3},{value:"\u624b\u52a8\u914d\u7f6eHTTPS",id:"\u624b\u52a8\u914d\u7f6ehttps",level:3},{value:"\u9ad8\u7ea7\u914d\u7f6e",id:"\u9ad8\u7ea7\u914d\u7f6e",level:2},{value:"1. \u7f13\u5b58\u914d\u7f6e",id:"1-\u7f13\u5b58\u914d\u7f6e",level:3},{value:"2. Gzip\u538b\u7f29",id:"2-gzip\u538b\u7f29",level:3},{value:"3. \u9650\u6d41\u9650\u901f",id:"3-\u9650\u6d41\u9650\u901f",level:3},{value:"4. \u9632\u76d7\u94fe",id:"4-\u9632\u76d7\u94fe",level:3},{value:"5. \u8de8\u57df\u914d\u7f6e\uff08CORS\uff09",id:"5-\u8de8\u57df\u914d\u7f6ecors",level:3},{value:"6. WebSocket\u652f\u6301",id:"6-websocket\u652f\u6301",level:3},{value:"\u5b9e\u6218\u9879\u76ee",id:"\u5b9e\u6218\u9879\u76ee",level:2},{value:"\u9879\u76ee1\uff1a\u524d\u540e\u7aef\u5206\u79bb\u90e8\u7f72",id:"\u9879\u76ee1\u524d\u540e\u7aef\u5206\u79bb\u90e8\u7f72",level:3},{value:"\u9879\u76ee2\uff1a\u591a\u57df\u540d\u591a\u9879\u76ee",id:"\u9879\u76ee2\u591a\u57df\u540d\u591a\u9879\u76ee",level:3},{value:"\u9879\u76ee3\uff1a\u9ad8\u53ef\u7528\u67b6\u6784",id:"\u9879\u76ee3\u9ad8\u53ef\u7528\u67b6\u6784",level:3},{value:"\u9879\u76ee4\uff1aDocker + Nginx\u5fae\u670d\u52a1",id:"\u9879\u76ee4docker--nginx\u5fae\u670d\u52a1",level:3},{value:"\u6027\u80fd\u4f18\u5316",id:"\u6027\u80fd\u4f18\u5316",level:2},{value:"1. Worker\u8fdb\u7a0b\u4f18\u5316",id:"1-worker\u8fdb\u7a0b\u4f18\u5316",level:3},{value:"2. \u6587\u4ef6\u4f18\u5316",id:"2-\u6587\u4ef6\u4f18\u5316",level:3},{value:"3. \u7f13\u51b2\u533a\u4f18\u5316",id:"3-\u7f13\u51b2\u533a\u4f18\u5316",level:3},{value:"\u76d1\u63a7\u4e0e\u65e5\u5fd7",id:"\u76d1\u63a7\u4e0e\u65e5\u5fd7",level:2},{value:"1. \u8bbf\u95ee\u65e5\u5fd7\u683c\u5f0f",id:"1-\u8bbf\u95ee\u65e5\u5fd7\u683c\u5f0f",level:3},{value:"2. \u72b6\u6001\u76d1\u63a7",id:"2-\u72b6\u6001\u76d1\u63a7",level:3},{value:"3. \u65e5\u5fd7\u5206\u6790",id:"3-\u65e5\u5fd7\u5206\u6790",level:3},{value:"\u5e38\u89c1\u95ee\u9898",id:"\u5e38\u89c1\u95ee\u9898",level:2},{value:"1. 403 Forbidden",id:"1-403-forbidden",level:3},{value:"2. 502 Bad Gateway",id:"2-502-bad-gateway",level:3},{value:"3. \u914d\u7f6e\u6d4b\u8bd5\u5931\u8d25",id:"3-\u914d\u7f6e\u6d4b\u8bd5\u5931\u8d25",level:3},{value:"4. \u91cd\u542f\u5931\u8d25",id:"4-\u91cd\u542f\u5931\u8d25",level:3},{value:"\u6700\u4f73\u5b9e\u8df5",id:"\u6700\u4f73\u5b9e\u8df5",level:2},{value:"1. \u914d\u7f6e\u6587\u4ef6\u7ec4\u7ec7",id:"1-\u914d\u7f6e\u6587\u4ef6\u7ec4\u7ec7",level:3},{value:"2. \u5b89\u5168\u52a0\u56fa",id:"2-\u5b89\u5168\u52a0\u56fa",level:3},{value:"3. \u5907\u4efd\u914d\u7f6e",id:"3-\u5907\u4efd\u914d\u7f6e",level:3},{value:"\u5b66\u4e60\u8d44\u6e90",id:"\u5b66\u4e60\u8d44\u6e90",level:2}];function o(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"nginx---\u9ad8\u6027\u80fdweb\u670d\u52a1\u5668",children:"Nginx - \u9ad8\u6027\u80fdWeb\u670d\u52a1\u5668"})}),"\n",(0,i.jsx)(e.p,{children:"Nginx\u662f\u4e00\u4e2a\u9ad8\u6027\u80fd\u7684HTTP\u548c\u53cd\u5411\u4ee3\u7406\u670d\u52a1\u5668\uff0c\u4e5f\u662f\u4e00\u4e2aIMAP/POP3/SMTP\u4ee3\u7406\u670d\u52a1\u5668\u3002\u5b83\u4ee5\u9ad8\u5e76\u53d1\u3001\u4f4e\u5185\u5b58\u5360\u7528\u8457\u79f0\uff0c\u662f\u73b0\u4ee3Web\u67b6\u6784\u7684\u6838\u5fc3\u7ec4\u4ef6\u3002"}),"\n",(0,i.jsx)(e.h2,{id:"\u4e3a\u4ec0\u4e48\u9009\u62e9nginx",children:"\u4e3a\u4ec0\u4e48\u9009\u62e9Nginx\uff1f"}),"\n",(0,i.jsx)(e.h3,{id:"\u6027\u80fd\u5bf9\u6bd4",children:"\u6027\u80fd\u5bf9\u6bd4"}),"\n",(0,i.jsxs)(e.table,{children:[(0,i.jsx)(e.thead,{children:(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.th,{children:"\u7279\u6027"}),(0,i.jsx)(e.th,{children:"Nginx"}),(0,i.jsx)(e.th,{children:"Apache"}),(0,i.jsx)(e.th,{children:"IIS"})]})}),(0,i.jsxs)(e.tbody,{children:[(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u5e76\u53d1\u5904\u7406"}),(0,i.jsx)(e.td,{children:"10\u4e07+"}),(0,i.jsx)(e.td,{children:"1\u4e07+"}),(0,i.jsx)(e.td,{children:"5\u4e07+"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u5185\u5b58\u5360\u7528"}),(0,i.jsx)(e.td,{children:"\u6781\u4f4e"}),(0,i.jsx)(e.td,{children:"\u4e2d\u7b49"}),(0,i.jsx)(e.td,{children:"\u8f83\u9ad8"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u914d\u7f6e\u96be\u5ea6"}),(0,i.jsx)(e.td,{children:"\u7b80\u5355"}),(0,i.jsx)(e.td,{children:"\u590d\u6742"}),(0,i.jsx)(e.td,{children:"\u4e2d\u7b49"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u9759\u6001\u6587\u4ef6"}),(0,i.jsx)(e.td,{children:"\u6781\u5feb"}),(0,i.jsx)(e.td,{children:"\u5feb"}),(0,i.jsx)(e.td,{children:"\u5feb"})]}),(0,i.jsxs)(e.tr,{children:[(0,i.jsx)(e.td,{children:"\u53cd\u5411\u4ee3\u7406"}),(0,i.jsx)(e.td,{children:"\u4f18\u79c0"}),(0,i.jsx)(e.td,{children:"\u4e00\u822c"}),(0,i.jsx)(e.td,{children:"\u4e00\u822c"})]})]})]}),"\n",(0,i.jsx)(e.h3,{id:"\u5e94\u7528\u573a\u666f",children:"\u5e94\u7528\u573a\u666f"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u9759\u6001\u8d44\u6e90\u670d\u52a1\u5668"}),"\uff1a\u56fe\u7247\u3001CSS\u3001JS\u6587\u4ef6"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u53cd\u5411\u4ee3\u7406"}),"\uff1a\u8d1f\u8f7d\u5747\u8861\u3001API\u7f51\u5173"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"HTTPS\u670d\u52a1\u5668"}),"\uff1aSSL/TLS\u7ec8\u6b62"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u7f13\u5b58\u670d\u52a1\u5668"}),"\uff1a\u51cf\u8f7b\u540e\u7aef\u538b\u529b"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u9650\u6d41\u9650\u901f"}),"\uff1a\u9632\u6b62\u6076\u610f\u653b\u51fb"]}),"\n"]}),"\n",(0,i.jsx)(e.h2,{id:"\u5b89\u88c5nginx",children:"\u5b89\u88c5Nginx"}),"\n",(0,i.jsx)(e.h3,{id:"ubuntudebian",children:"Ubuntu/Debian"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# \u66f4\u65b0\u8f6f\u4ef6\u6e90\nsudo apt update\n\n# \u5b89\u88c5Nginx\nsudo apt install nginx -y\n\n# \u542f\u52a8Nginx\nsudo systemctl start nginx\n\n# \u8bbe\u7f6e\u5f00\u673a\u81ea\u542f\nsudo systemctl enable nginx\n\n# \u67e5\u770b\u72b6\u6001\nsudo systemctl status nginx\n\n# \u6d4b\u8bd5\u914d\u7f6e\u6587\u4ef6\nsudo nginx -t\n\n# \u91cd\u65b0\u52a0\u8f7d\u914d\u7f6e\uff08\u4e0d\u4e2d\u65ad\u670d\u52a1\uff09\nsudo nginx -s reload\n"})}),"\n",(0,i.jsx)(e.h3,{id:"centosrhel",children:"CentOS/RHEL"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# \u5b89\u88c5Nginx\nsudo yum install nginx -y\n\n# \u542f\u52a8\u670d\u52a1\nsudo systemctl start nginx\nsudo systemctl enable nginx\n"})}),"\n",(0,i.jsx)(e.h3,{id:"docker\u65b9\u5f0f",children:"Docker\u65b9\u5f0f"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# \u8fd0\u884cNginx\u5bb9\u5668\ndocker run -d \\\n  --name nginx \\\n  -p 80:80 \\\n  -v /path/to/html:/usr/share/nginx/html \\\n  -v /path/to/nginx.conf:/etc/nginx/nginx.conf \\\n  nginx:latest\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u9a8c\u8bc1\u5b89\u88c5",children:"\u9a8c\u8bc1\u5b89\u88c5"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# \u68c0\u67e5\u7248\u672c\nnginx -v\n\n# \u8bbf\u95ee\u6d4b\u8bd5\ncurl http://localhost\n\n# \u6216\u5728\u6d4f\u89c8\u5668\u6253\u5f00\n# http://\u4f60\u7684\u670d\u52a1\u5668IP\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u6838\u5fc3\u6982\u5ff5",children:"\u6838\u5fc3\u6982\u5ff5"}),"\n",(0,i.jsx)(e.h3,{id:"\u76ee\u5f55\u7ed3\u6784",children:"\u76ee\u5f55\u7ed3\u6784"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"/etc/nginx/\n\u251c\u2500\u2500 nginx.conf              # \u4e3b\u914d\u7f6e\u6587\u4ef6\n\u251c\u2500\u2500 conf.d/                 # \u5b50\u914d\u7f6e\u6587\u4ef6\u76ee\u5f55\n\u2502   \u2514\u2500\u2500 default.conf\n\u251c\u2500\u2500 sites-available/        # \u53ef\u7528\u7ad9\u70b9\u914d\u7f6e\n\u251c\u2500\u2500 sites-enabled/          # \u542f\u7528\u7ad9\u70b9\u914d\u7f6e\uff08\u8f6f\u94fe\u63a5\uff09\n\u251c\u2500\u2500 snippets/               # \u914d\u7f6e\u7247\u6bb5\n\u251c\u2500\u2500 mime.types              # \u6587\u4ef6\u7c7b\u578b\u6620\u5c04\n\u2514\u2500\u2500 modules-enabled/        # \u542f\u7528\u7684\u6a21\u5757\n\n/var/log/nginx/\n\u251c\u2500\u2500 access.log              # \u8bbf\u95ee\u65e5\u5fd7\n\u2514\u2500\u2500 error.log               # \u9519\u8bef\u65e5\u5fd7\n\n/usr/share/nginx/html/      # \u9ed8\u8ba4\u7f51\u7ad9\u6839\u76ee\u5f55\n\u2514\u2500\u2500 index.html\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u914d\u7f6e\u6587\u4ef6\u7ed3\u6784",children:"\u914d\u7f6e\u6587\u4ef6\u7ed3\u6784"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-nginx",children:"# \u5168\u5c40\u5757\uff1a\u5f71\u54cd\u6574\u4e2aNginx\u670d\u52a1\u5668\nuser nginx;\nworker_processes auto;\n\n# events\u5757\uff1a\u5f71\u54cdNginx\u670d\u52a1\u5668\u4e0e\u7528\u6237\u7684\u7f51\u7edc\u8fde\u63a5\nevents {\n    worker_connections 1024;\n}\n\n# http\u5757\uff1a\u914d\u7f6eHTTP\u670d\u52a1\u5668\nhttp {\n    # http\u5168\u5c40\u5757\n    include mime.types;\n    default_type application/octet-stream;\n    \n    # server\u5757\uff1a\u914d\u7f6e\u865a\u62df\u4e3b\u673a\n    server {\n        # server\u5168\u5c40\u5757\n        listen 80;\n        server_name example.com;\n        \n        # location\u5757\uff1a\u914d\u7f6e\u8bf7\u6c42\u8def\u7531\n        location / {\n            root /usr/share/nginx/html;\n            index index.html;\n        }\n    }\n}\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u57fa\u7840\u914d\u7f6e",children:"\u57fa\u7840\u914d\u7f6e"}),"\n",(0,i.jsx)(e.h3,{id:"1-\u9759\u6001\u7f51\u7ad9\u6258\u7ba1",children:"1. \u9759\u6001\u7f51\u7ad9\u6258\u7ba1"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-nginx",children:'server {\n    listen 80;\n    server_name example.com www.example.com;\n    \n    # \u7f51\u7ad9\u6839\u76ee\u5f55\n    root /var/www/example.com;\n    index index.html index.htm;\n    \n    # \u65e5\u5fd7\u914d\u7f6e\n    access_log /var/log/nginx/example.access.log;\n    error_log /var/log/nginx/example.error.log;\n    \n    # \u4e3b\u9875\u9762\n    location / {\n        try_files $uri $uri/ =404;\n    }\n    \n    # \u9759\u6001\u8d44\u6e90\u7f13\u5b58\n    location ~* \\.(jpg|jpeg|png|gif|ico|css|js)$ {\n        expires 30d;\n        add_header Cache-Control "public, immutable";\n    }\n    \n    # \u7981\u6b62\u8bbf\u95ee\u9690\u85cf\u6587\u4ef6\n    location ~ /\\. {\n        deny all;\n    }\n}\n'})}),"\n",(0,i.jsx)(e.h3,{id:"2-\u53cd\u5411\u4ee3\u7406",children:"2. \u53cd\u5411\u4ee3\u7406"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-nginx",children:"# \u4ee3\u7406\u5230\u540e\u7aef\u5e94\u7528\nserver {\n    listen 80;\n    server_name api.example.com;\n    \n    location / {\n        # \u4ee3\u7406\u5230\u540e\u7aef\u670d\u52a1\n        proxy_pass http://localhost:3000;\n        \n        # \u4f20\u9012\u771f\u5b9eIP\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n        \n        # \u8d85\u65f6\u8bbe\u7f6e\n        proxy_connect_timeout 60s;\n        proxy_send_timeout 60s;\n        proxy_read_timeout 60s;\n    }\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"3-\u8d1f\u8f7d\u5747\u8861",children:"3. \u8d1f\u8f7d\u5747\u8861"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-nginx",children:"# \u5b9a\u4e49\u540e\u7aef\u670d\u52a1\u5668\u7ec4\nupstream backend {\n    # \u8f6e\u8be2\uff08\u9ed8\u8ba4\uff09\n    server 192.168.1.10:8080;\n    server 192.168.1.11:8080;\n    server 192.168.1.12:8080;\n    \n    # \u6743\u91cd\u5206\u914d\n    # server 192.168.1.10:8080 weight=3;\n    # server 192.168.1.11:8080 weight=2;\n    # server 192.168.1.12:8080 weight=1;\n    \n    # \u5065\u5eb7\u68c0\u67e5\n    # server 192.168.1.10:8080 max_fails=3 fail_timeout=30s;\n}\n\nserver {\n    listen 80;\n    server_name app.example.com;\n    \n    location / {\n        proxy_pass http://backend;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n    }\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u8d1f\u8f7d\u5747\u8861\u7b56\u7565",children:"\u8d1f\u8f7d\u5747\u8861\u7b56\u7565"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-nginx",children:"# 1. \u8f6e\u8be2\uff08\u9ed8\u8ba4\uff09\nupstream backend {\n    server server1.com;\n    server server2.com;\n}\n\n# 2. \u6743\u91cd\nupstream backend {\n    server server1.com weight=3;\n    server server2.com weight=1;\n}\n\n# 3. IP\u54c8\u5e0c\uff08\u540c\u4e00IP\u603b\u662f\u8bbf\u95ee\u540c\u4e00\u670d\u52a1\u5668\uff09\nupstream backend {\n    ip_hash;\n    server server1.com;\n    server server2.com;\n}\n\n# 4. \u6700\u5c11\u8fde\u63a5\nupstream backend {\n    least_conn;\n    server server1.com;\n    server server2.com;\n}\n\n# 5. \u54cd\u5e94\u65f6\u95f4\u6700\u77ed\uff08\u9700\u8981\u7b2c\u4e09\u65b9\u6a21\u5757\uff09\nupstream backend {\n    fair;\n    server server1.com;\n    server server2.com;\n}\n"})}),"\n",(0,i.jsx)(e.h2,{id:"https\u914d\u7f6e",children:"HTTPS\u914d\u7f6e"}),"\n",(0,i.jsx)(e.h3,{id:"\u4f7f\u7528lets-encrypt\u514d\u8d39\u8bc1\u4e66",children:"\u4f7f\u7528Let's Encrypt\u514d\u8d39\u8bc1\u4e66"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# \u5b89\u88c5Certbot\nsudo apt install certbot python3-certbot-nginx -y\n\n# \u81ea\u52a8\u914d\u7f6eHTTPS\nsudo certbot --nginx -d example.com -d www.example.com\n\n# \u6d4b\u8bd5\u81ea\u52a8\u7eed\u671f\nsudo certbot renew --dry-run\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u624b\u52a8\u914d\u7f6ehttps",children:"\u624b\u52a8\u914d\u7f6eHTTPS"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-nginx",children:'server {\n    listen 80;\n    server_name example.com www.example.com;\n    \n    # HTTP\u91cd\u5b9a\u5411\u5230HTTPS\n    return 301 https://$server_name$request_uri;\n}\n\nserver {\n    listen 443 ssl http2;\n    server_name example.com www.example.com;\n    \n    # SSL\u8bc1\u4e66\n    ssl_certificate /etc/nginx/ssl/example.com.crt;\n    ssl_certificate_key /etc/nginx/ssl/example.com.key;\n    \n    # SSL\u914d\u7f6e\n    ssl_protocols TLSv1.2 TLSv1.3;\n    ssl_ciphers HIGH:!aNULL:!MD5;\n    ssl_prefer_server_ciphers on;\n    \n    # HSTS\uff08\u5f3a\u5236HTTPS\uff09\n    add_header Strict-Transport-Security "max-age=31536000" always;\n    \n    # \u5176\u4ed6\u5b89\u5168\u5934\n    add_header X-Frame-Options "SAMEORIGIN" always;\n    add_header X-Content-Type-Options "nosniff" always;\n    add_header X-XSS-Protection "1; mode=block" always;\n    \n    location / {\n        root /var/www/example.com;\n        index index.html;\n    }\n}\n'})}),"\n",(0,i.jsx)(e.h2,{id:"\u9ad8\u7ea7\u914d\u7f6e",children:"\u9ad8\u7ea7\u914d\u7f6e"}),"\n",(0,i.jsx)(e.h3,{id:"1-\u7f13\u5b58\u914d\u7f6e",children:"1. \u7f13\u5b58\u914d\u7f6e"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-nginx",children:'# \u5b9a\u4e49\u7f13\u5b58\u8def\u5f84\nproxy_cache_path /var/cache/nginx levels=1:2 keys_zone=my_cache:10m max_size=1g inactive=60m;\n\nserver {\n    listen 80;\n    server_name example.com;\n    \n    location / {\n        proxy_pass http://backend;\n        \n        # \u542f\u7528\u7f13\u5b58\n        proxy_cache my_cache;\n        proxy_cache_valid 200 60m;\n        proxy_cache_valid 404 10m;\n        \n        # \u7f13\u5b58\u952e\n        proxy_cache_key "$scheme$request_method$host$request_uri";\n        \n        # \u6dfb\u52a0\u7f13\u5b58\u72b6\u6001\u5934\n        add_header X-Cache-Status $upstream_cache_status;\n        \n        # \u7f13\u5b58\u7ed5\u8fc7\u6761\u4ef6\n        proxy_cache_bypass $http_pragma $http_authorization;\n        proxy_no_cache $http_pragma $http_authorization;\n    }\n}\n'})}),"\n",(0,i.jsx)(e.h3,{id:"2-gzip\u538b\u7f29",children:"2. Gzip\u538b\u7f29"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-nginx",children:'http {\n    # \u542f\u7528Gzip\n    gzip on;\n    gzip_vary on;\n    gzip_proxied any;\n    gzip_comp_level 6;\n    gzip_types text/plain text/css text/xml text/javascript \n               application/json application/javascript application/xml+rss \n               application/rss+xml font/truetype font/opentype \n               application/vnd.ms-fontobject image/svg+xml;\n    gzip_disable "msie6";\n    \n    # \u6700\u5c0f\u538b\u7f29\u6587\u4ef6\u5927\u5c0f\n    gzip_min_length 1000;\n}\n'})}),"\n",(0,i.jsx)(e.h3,{id:"3-\u9650\u6d41\u9650\u901f",children:"3. \u9650\u6d41\u9650\u901f"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-nginx",children:"# \u5b9a\u4e49\u9650\u6d41\u533a\u57df\nhttp {\n    # \u9650\u5236\u8bf7\u6c42\u9891\u7387\uff08\u6bcf\u79d210\u4e2a\u8bf7\u6c42\uff09\n    limit_req_zone $binary_remote_addr zone=req_limit:10m rate=10r/s;\n    \n    # \u9650\u5236\u8fde\u63a5\u6570\n    limit_conn_zone $binary_remote_addr zone=conn_limit:10m;\n    \n    server {\n        listen 80;\n        server_name example.com;\n        \n        location /api/ {\n            # \u5e94\u7528\u9650\u6d41\uff08\u5141\u8bb8\u7a81\u53d120\u4e2a\u8bf7\u6c42\uff09\n            limit_req zone=req_limit burst=20 nodelay;\n            \n            # \u9650\u5236\u5e76\u53d1\u8fde\u63a5\u6570\n            limit_conn conn_limit 10;\n            \n            # \u9650\u5236\u4e0b\u8f7d\u901f\u5ea6\uff08\u6bcf\u79d2500KB\uff09\n            limit_rate 500k;\n            \n            proxy_pass http://backend;\n        }\n    }\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"4-\u9632\u76d7\u94fe",children:"4. \u9632\u76d7\u94fe"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-nginx",children:"location ~* \\.(jpg|jpeg|png|gif)$ {\n    valid_referers none blocked example.com *.example.com;\n    if ($invalid_referer) {\n        return 403;\n        # \u6216\u8fd4\u56de\u9632\u76d7\u94fe\u56fe\u7247\n        # rewrite ^/ /images/forbidden.png break;\n    }\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"5-\u8de8\u57df\u914d\u7f6ecors",children:"5. \u8de8\u57df\u914d\u7f6e\uff08CORS\uff09"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-nginx",children:"location /api/ {\n    # \u5141\u8bb8\u7684\u6e90\n    add_header Access-Control-Allow-Origin *;\n    \n    # \u5141\u8bb8\u7684\u65b9\u6cd5\n    add_header Access-Control-Allow-Methods 'GET, POST, PUT, DELETE, OPTIONS';\n    \n    # \u5141\u8bb8\u7684\u5934\n    add_header Access-Control-Allow-Headers 'DNT,X-Mx-ReqToken,Keep-Alive,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Authorization';\n    \n    # \u9884\u68c0\u8bf7\u6c42\u7f13\u5b58\u65f6\u95f4\n    add_header Access-Control-Max-Age 1728000;\n    \n    # \u5904\u7406OPTIONS\u8bf7\u6c42\n    if ($request_method = 'OPTIONS') {\n        return 204;\n    }\n    \n    proxy_pass http://backend;\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"6-websocket\u652f\u6301",children:"6. WebSocket\u652f\u6301"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-nginx",children:'location /ws/ {\n    proxy_pass http://backend;\n    \n    # WebSocket\u5fc5\u9700\u914d\u7f6e\n    proxy_http_version 1.1;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection "upgrade";\n    \n    # \u8d85\u65f6\u8bbe\u7f6e\n    proxy_connect_timeout 7d;\n    proxy_send_timeout 7d;\n    proxy_read_timeout 7d;\n}\n'})}),"\n",(0,i.jsx)(e.h2,{id:"\u5b9e\u6218\u9879\u76ee",children:"\u5b9e\u6218\u9879\u76ee"}),"\n",(0,i.jsx)(e.h3,{id:"\u9879\u76ee1\u524d\u540e\u7aef\u5206\u79bb\u90e8\u7f72",children:"\u9879\u76ee1\uff1a\u524d\u540e\u7aef\u5206\u79bb\u90e8\u7f72"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-nginx",children:'# /etc/nginx/conf.d/myapp.conf\n\n# \u524d\u7aef\nserver {\n    listen 80;\n    server_name www.example.com;\n    \n    root /var/www/frontend/dist;\n    index index.html;\n    \n    # SPA\u8def\u7531\u652f\u6301\n    location / {\n        try_files $uri $uri/ /index.html;\n    }\n    \n    # \u9759\u6001\u8d44\u6e90\u7f13\u5b58\n    location /static/ {\n        expires 1y;\n        add_header Cache-Control "public, immutable";\n    }\n}\n\n# \u540e\u7aefAPI\nserver {\n    listen 80;\n    server_name api.example.com;\n    \n    location / {\n        proxy_pass http://localhost:3000;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    }\n}\n'})}),"\n",(0,i.jsx)(e.h3,{id:"\u9879\u76ee2\u591a\u57df\u540d\u591a\u9879\u76ee",children:"\u9879\u76ee2\uff1a\u591a\u57df\u540d\u591a\u9879\u76ee"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-nginx",children:"# \u9879\u76ee1\nserver {\n    listen 80;\n    server_name project1.com;\n    root /var/www/project1;\n    index index.html;\n}\n\n# \u9879\u76ee2\nserver {\n    listen 80;\n    server_name project2.com;\n    root /var/www/project2;\n    index index.html;\n}\n\n# \u9879\u76ee3\uff08Node.js\u5e94\u7528\uff09\nserver {\n    listen 80;\n    server_name project3.com;\n    \n    location / {\n        proxy_pass http://localhost:3000;\n    }\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u9879\u76ee3\u9ad8\u53ef\u7528\u67b6\u6784",children:"\u9879\u76ee3\uff1a\u9ad8\u53ef\u7528\u67b6\u6784"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-nginx",children:"# \u4e3b\u8d1f\u8f7d\u5747\u8861\u5668\u914d\u7f6e\nupstream web_backend {\n    # \u5065\u5eb7\u68c0\u67e5\n    server web1.example.com:80 max_fails=3 fail_timeout=30s;\n    server web2.example.com:80 max_fails=3 fail_timeout=30s;\n    server web3.example.com:80 backup;  # \u5907\u7528\u670d\u52a1\u5668\n}\n\nupstream api_backend {\n    least_conn;  # \u6700\u5c11\u8fde\u63a5\n    server api1.example.com:8080 weight=3;\n    server api2.example.com:8080 weight=2;\n    server api3.example.com:8080 weight=1;\n}\n\n# \u524d\u7aef\u670d\u52a1\nserver {\n    listen 80;\n    server_name www.example.com;\n    \n    location / {\n        proxy_pass http://web_backend;\n        proxy_next_upstream error timeout http_500 http_502 http_503;\n    }\n}\n\n# API\u670d\u52a1\nserver {\n    listen 80;\n    server_name api.example.com;\n    \n    # \u9650\u6d41\n    limit_req zone=api_limit burst=50 nodelay;\n    \n    location / {\n        proxy_pass http://api_backend;\n        \n        # \u7f13\u5b58\n        proxy_cache api_cache;\n        proxy_cache_valid 200 5m;\n    }\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\u9879\u76ee4docker--nginx\u5fae\u670d\u52a1",children:"\u9879\u76ee4\uff1aDocker + Nginx\u5fae\u670d\u52a1"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-yaml",children:'# docker-compose.yml\nversion: \'3.8\'\n\nservices:\n  nginx:\n    image: nginx:latest\n    ports:\n      - "80:80"\n      - "443:443"\n    volumes:\n      - ./nginx.conf:/etc/nginx/nginx.conf\n      - ./ssl:/etc/nginx/ssl\n    depends_on:\n      - frontend\n      - backend\n    networks:\n      - app-network\n\n  frontend:\n    build: ./frontend\n    networks:\n      - app-network\n\n  backend:\n    build: ./backend\n    networks:\n      - app-network\n\n  database:\n    image: postgres:15\n    environment:\n      POSTGRES_PASSWORD: secret\n    networks:\n      - app-network\n\nnetworks:\n  app-network:\n    driver: bridge\n'})}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-nginx",children:"# nginx.conf\nevents {\n    worker_connections 1024;\n}\n\nhttp {\n    upstream frontend {\n        server frontend:3000;\n    }\n    \n    upstream backend {\n        server backend:8000;\n    }\n    \n    server {\n        listen 80;\n        \n        location / {\n            proxy_pass http://frontend;\n        }\n        \n        location /api/ {\n            proxy_pass http://backend;\n        }\n    }\n}\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u6027\u80fd\u4f18\u5316",children:"\u6027\u80fd\u4f18\u5316"}),"\n",(0,i.jsx)(e.h3,{id:"1-worker\u8fdb\u7a0b\u4f18\u5316",children:"1. Worker\u8fdb\u7a0b\u4f18\u5316"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-nginx",children:"# \u81ea\u52a8\u8bbe\u7f6e\u4e3aCPU\u6838\u5fc3\u6570\nworker_processes auto;\n\n# \u7ed1\u5b9aworker\u5230CPU\u6838\u5fc3\nworker_cpu_affinity auto;\n\n# \u6bcf\u4e2aworker\u7684\u6700\u5927\u8fde\u63a5\u6570\nevents {\n    worker_connections 10240;\n    use epoll;  # Linux\u9ad8\u6548\u4e8b\u4ef6\u6a21\u578b\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"2-\u6587\u4ef6\u4f18\u5316",children:"2. \u6587\u4ef6\u4f18\u5316"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-nginx",children:"http {\n    # \u9ad8\u6548\u6587\u4ef6\u4f20\u8f93\n    sendfile on;\n    tcp_nopush on;\n    tcp_nodelay on;\n    \n    # \u8fde\u63a5\u8d85\u65f6\n    keepalive_timeout 65;\n    keepalive_requests 100;\n    \n    # \u6587\u4ef6\u7f13\u5b58\n    open_file_cache max=10000 inactive=20s;\n    open_file_cache_valid 30s;\n    open_file_cache_min_uses 2;\n    open_file_cache_errors on;\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"3-\u7f13\u51b2\u533a\u4f18\u5316",children:"3. \u7f13\u51b2\u533a\u4f18\u5316"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-nginx",children:"http {\n    client_body_buffer_size 128k;\n    client_max_body_size 10m;\n    client_header_buffer_size 1k;\n    large_client_header_buffers 4 4k;\n    output_buffers 1 32k;\n    postpone_output 1460;\n}\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u76d1\u63a7\u4e0e\u65e5\u5fd7",children:"\u76d1\u63a7\u4e0e\u65e5\u5fd7"}),"\n",(0,i.jsx)(e.h3,{id:"1-\u8bbf\u95ee\u65e5\u5fd7\u683c\u5f0f",children:"1. \u8bbf\u95ee\u65e5\u5fd7\u683c\u5f0f"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-nginx",children:'http {\n    # \u81ea\u5b9a\u4e49\u65e5\u5fd7\u683c\u5f0f\n    log_format main \'$remote_addr - $remote_user [$time_local] "$request" \'\n                    \'$status $body_bytes_sent "$http_referer" \'\n                    \'"$http_user_agent" "$http_x_forwarded_for" \'\n                    \'rt=$request_time uct="$upstream_connect_time" \'\n                    \'uht="$upstream_header_time" urt="$upstream_response_time"\';\n    \n    access_log /var/log/nginx/access.log main;\n    \n    # JSON\u683c\u5f0f\u65e5\u5fd7\uff08\u4fbf\u4e8e\u5206\u6790\uff09\n    log_format json escape=json \'{\'\n        \'"time":"$time_iso8601",\'\n        \'"remote_addr":"$remote_addr",\'\n        \'"request":"$request",\'\n        \'"status":$status,\'\n        \'"body_bytes_sent":$body_bytes_sent,\'\n        \'"request_time":$request_time,\'\n        \'"upstream_response_time":"$upstream_response_time"\'\n    \'}\';\n}\n'})}),"\n",(0,i.jsx)(e.h3,{id:"2-\u72b6\u6001\u76d1\u63a7",children:"2. \u72b6\u6001\u76d1\u63a7"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-nginx",children:"# \u542f\u7528\u72b6\u6001\u9875\u9762\nserver {\n    listen 8080;\n    server_name localhost;\n    \n    location /nginx_status {\n        stub_status on;\n        access_log off;\n        allow 127.0.0.1;\n        deny all;\n    }\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:["\u8bbf\u95ee ",(0,i.jsx)(e.code,{children:"http://localhost:8080/nginx_status"})," \u67e5\u770b\uff1a"]}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"Active connections: 291\nserver accepts handled requests\n 16630948 16630948 31070465\nReading: 6 Writing: 179 Waiting: 106\n"})}),"\n",(0,i.jsx)(e.h3,{id:"3-\u65e5\u5fd7\u5206\u6790",children:"3. \u65e5\u5fd7\u5206\u6790"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# \u7edf\u8ba1\u8bbf\u95ee\u6700\u591a\u7684IP\nawk '{print $1}' /var/log/nginx/access.log | sort | uniq -c | sort -rn | head -10\n\n# \u7edf\u8ba1\u8bbf\u95ee\u6700\u591a\u7684URL\nawk '{print $7}' /var/log/nginx/access.log | sort | uniq -c | sort -rn | head -10\n\n# \u7edf\u8ba1\u72b6\u6001\u7801\u5206\u5e03\nawk '{print $9}' /var/log/nginx/access.log | sort | uniq -c | sort -rn\n\n# \u7edf\u8ba1\u54cd\u5e94\u65f6\u95f4\nawk '{print $NF}' /var/log/nginx/access.log | sort -n | tail -100\n\n# \u5b9e\u65f6\u67e5\u770b\u65e5\u5fd7\ntail -f /var/log/nginx/access.log\n\n# \u4f7f\u7528GoAccess\u5206\u6790\u65e5\u5fd7\uff08\u9700\u5b89\u88c5\uff09\ngoaccess /var/log/nginx/access.log -o report.html --log-format=COMBINED\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u5e38\u89c1\u95ee\u9898",children:"\u5e38\u89c1\u95ee\u9898"}),"\n",(0,i.jsx)(e.h3,{id:"1-403-forbidden",children:"1. 403 Forbidden"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# \u68c0\u67e5\u6587\u4ef6\u6743\u9650\nls -la /var/www/html\n\n# \u4fee\u6539\u6743\u9650\nsudo chown -R www-data:www-data /var/www/html\nsudo chmod -R 755 /var/www/html\n\n# \u68c0\u67e5SELinux\uff08CentOS\uff09\ngetenforce\nsudo setenforce 0\n"})}),"\n",(0,i.jsx)(e.h3,{id:"2-502-bad-gateway",children:"2. 502 Bad Gateway"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# \u68c0\u67e5\u540e\u7aef\u670d\u52a1\u662f\u5426\u8fd0\u884c\nnetstat -tuln | grep 3000\n\n# \u68c0\u67e5\u9632\u706b\u5899\nsudo ufw status\n\n# \u67e5\u770b\u9519\u8bef\u65e5\u5fd7\nsudo tail -f /var/log/nginx/error.log\n"})}),"\n",(0,i.jsx)(e.h3,{id:"3-\u914d\u7f6e\u6d4b\u8bd5\u5931\u8d25",children:"3. \u914d\u7f6e\u6d4b\u8bd5\u5931\u8d25"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# \u6d4b\u8bd5\u914d\u7f6e\nsudo nginx -t\n\n# \u67e5\u770b\u8be6\u7ec6\u9519\u8bef\nsudo nginx -t -c /etc/nginx/nginx.conf\n\n# \u68c0\u67e5\u8bed\u6cd5\nsudo nginx -T\n"})}),"\n",(0,i.jsx)(e.h3,{id:"4-\u91cd\u542f\u5931\u8d25",children:"4. \u91cd\u542f\u5931\u8d25"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# \u67e5\u770bNginx\u72b6\u6001\nsudo systemctl status nginx\n\n# \u67e5\u770b\u7aef\u53e3\u5360\u7528\nsudo lsof -i :80\n\n# \u6740\u6389\u5360\u7528\u8fdb\u7a0b\nsudo kill -9 $(lsof -t -i:80)\n\n# \u91cd\u65b0\u542f\u52a8\nsudo systemctl restart nginx\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u6700\u4f73\u5b9e\u8df5",children:"\u6700\u4f73\u5b9e\u8df5"}),"\n",(0,i.jsx)(e.h3,{id:"1-\u914d\u7f6e\u6587\u4ef6\u7ec4\u7ec7",children:"1. \u914d\u7f6e\u6587\u4ef6\u7ec4\u7ec7"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"/etc/nginx/\n\u251c\u2500\u2500 nginx.conf                    # \u4e3b\u914d\u7f6e\n\u251c\u2500\u2500 conf.d/\n\u2502   \u251c\u2500\u2500 gzip.conf                # Gzip\u914d\u7f6e\n\u2502   \u251c\u2500\u2500 security.conf            # \u5b89\u5168\u914d\u7f6e\n\u2502   \u2514\u2500\u2500 cache.conf               # \u7f13\u5b58\u914d\u7f6e\n\u2514\u2500\u2500 sites-available/\n    \u251c\u2500\u2500 example.com.conf         # \u7ad9\u70b9\u914d\u7f6e\n    \u2514\u2500\u2500 api.example.com.conf\n"})}),"\n",(0,i.jsx)(e.h3,{id:"2-\u5b89\u5168\u52a0\u56fa",children:"2. \u5b89\u5168\u52a0\u56fa"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-nginx",children:'# \u9690\u85cf\u7248\u672c\u53f7\nhttp {\n    server_tokens off;\n}\n\n# \u9650\u5236\u8bf7\u6c42\u65b9\u6cd5\nserver {\n    if ($request_method !~ ^(GET|POST|HEAD)$) {\n        return 405;\n    }\n}\n\n# \u9632\u6b62\u70b9\u51fb\u52ab\u6301\nadd_header X-Frame-Options "SAMEORIGIN" always;\n\n# \u9632\u6b62MIME\u7c7b\u578b\u55c5\u63a2\nadd_header X-Content-Type-Options "nosniff" always;\n\n# XSS\u4fdd\u62a4\nadd_header X-XSS-Protection "1; mode=block" always;\n\n# CSP\u7b56\u7565\nadd_header Content-Security-Policy "default-src \'self\'" always;\n'})}),"\n",(0,i.jsx)(e.h3,{id:"3-\u5907\u4efd\u914d\u7f6e",children:"3. \u5907\u4efd\u914d\u7f6e"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"# \u5907\u4efd\u914d\u7f6e\u6587\u4ef6\nsudo cp /etc/nginx/nginx.conf /etc/nginx/nginx.conf.backup\n\n# \u5b9a\u671f\u5907\u4efd\u811a\u672c\n#!/bin/bash\nDATE=$(date +%Y%m%d)\ntar -czf /backup/nginx-$DATE.tar.gz /etc/nginx/\n"})}),"\n",(0,i.jsx)(e.h2,{id:"\u5b66\u4e60\u8d44\u6e90",children:"\u5b66\u4e60\u8d44\u6e90"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u5b98\u65b9\u6587\u6863"}),"\uff1a",(0,i.jsx)(e.a,{href:"https://nginx.org/en/docs/",children:"https://nginx.org/en/docs/"})]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"Nginx\u914d\u7f6e\u751f\u6210\u5668"}),"\uff1a",(0,i.jsx)(e.a,{href:"https://www.digitalocean.com/community/tools/nginx",children:"https://www.digitalocean.com/community/tools/nginx"})]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.strong,{children:"\u6d4b\u8bd5\u5de5\u5177"}),"\uff1a",(0,i.jsx)(e.a,{href:"https://github.com/yandex/gixy%EF%BC%88%E9%85%8D%E7%BD%AE%E5%AE%89%E5%85%A8%E6%A3%80%E6%9F%A5%EF%BC%89",children:"https://github.com/yandex/gixy\uff08\u914d\u7f6e\u5b89\u5168\u68c0\u67e5\uff09"})]}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:["\u8bb0\u4f4f\uff1a",(0,i.jsx)(e.strong,{children:"Nginx\u914d\u7f6e\u4fee\u6539\u540e\u4e00\u5b9a\u8981\u5148\u6d4b\u8bd5\uff08nginx -t\uff09\uff0c\u518d\u91cd\u8f7d\uff08nginx -s reload\uff09\uff01"})]})]})}function h(n={}){const{wrapper:e}={...(0,a.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(o,{...n})}):o(n)}},28453(n,e,r){r.d(e,{R:()=>l,x:()=>t});var s=r(96540);const i={},a=s.createContext(i);function l(n){const e=s.useContext(a);return s.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function t(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:l(n.components),s.createElement(a.Provider,{value:e},n.children)}}}]);