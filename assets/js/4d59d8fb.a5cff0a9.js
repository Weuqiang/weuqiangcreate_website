"use strict";(globalThis.webpackChunkweuqiangcreate_website=globalThis.webpackChunkweuqiangcreate_website||[]).push([[28465],{32859(n,e,s){s.r(e),s.d(e,{assets:()=>i,contentTitle:()=>o,default:()=>p,frontMatter:()=>d,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"\u5927\u6570\u636e\u6280\u672f/Hadoop\u751f\u6001\u7cfb\u7edf","title":"Hadoop\u751f\u6001\u7cfb\u7edf - \u4ece\u96f6\u5f00\u59cb","description":"Hadoop\u662f\u5927\u6570\u636e\u7684\u57fa\u7840\uff0c\u4f46\u5f88\u591a\u6559\u7a0b\u53ea\u8bb2\u6982\u5ff5\u3002\u8fd9\u4e00\u7ae0\u4f1a\u5e26\u4f60\u771f\u6b63\u642d\u5efa\u548c\u4f7f\u7528Hadoop\u3002","source":"@site/docs/docs/\u5927\u6570\u636e\u6280\u672f/Hadoop\u751f\u6001\u7cfb\u7edf.mdx","sourceDirName":"\u5927\u6570\u636e\u6280\u672f","slug":"/\u5927\u6570\u636e\u6280\u672f/Hadoop\u751f\u6001\u7cfb\u7edf","permalink":"/weuqiangcreate_website/docs/\u5927\u6570\u636e\u6280\u672f/Hadoop\u751f\u6001\u7cfb\u7edf","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"Hadoop\u751f\u6001\u7cfb\u7edf - \u4ece\u96f6\u5f00\u59cb"},"sidebar":"tutorialSidebar","previous":{"title":"\u5927\u6570\u636e\u6280\u672f","permalink":"/weuqiangcreate_website/docs/\u5927\u6570\u636e\u6280\u672f/"},"next":{"title":"Spark - \u5feb\u5982\u95ea\u7535\u7684\u5927\u6570\u636e\u5904\u7406","permalink":"/weuqiangcreate_website/docs/\u5927\u6570\u636e\u6280\u672f/Spark\u5feb\u901f\u5927\u6570\u636e\u5206\u6790"}}');var a=s(74848),r=s(28453);const d={sidebar_position:1,title:"Hadoop\u751f\u6001\u7cfb\u7edf - \u4ece\u96f6\u5f00\u59cb"},o="Hadoop\u751f\u6001\u7cfb\u7edf - \u5927\u6570\u636e\u7684\u57fa\u77f3",i={},l=[{value:"\u7b2c\u4e00\u90e8\u5206\uff1a\u7406\u89e3Hadoop",id:"\u7b2c\u4e00\u90e8\u5206\u7406\u89e3hadoop",level:2},{value:"\u4e3a\u4ec0\u4e48\u9700\u8981Hadoop\uff1f",id:"\u4e3a\u4ec0\u4e48\u9700\u8981hadoop",level:3},{value:"Hadoop\u4e09\u5927\u6838\u5fc3",id:"hadoop\u4e09\u5927\u6838\u5fc3",level:3},{value:"\u7b2c\u4e8c\u90e8\u5206\uff1aHDFS - \u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf",id:"\u7b2c\u4e8c\u90e8\u5206hdfs---\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf",level:2},{value:"HDFS\u7684\u8bbe\u8ba1\u601d\u60f3",id:"hdfs\u7684\u8bbe\u8ba1\u601d\u60f3",level:3},{value:"HDFS\u67b6\u6784",id:"hdfs\u67b6\u6784",level:3},{value:"\u5b9e\u6218\uff1a\u642d\u5efaHDFS",id:"\u5b9e\u6218\u642d\u5efahdfs",level:3},{value:"HDFS\u9ad8\u7ea7\u7279\u6027",id:"hdfs\u9ad8\u7ea7\u7279\u6027",level:3},{value:"\u7b2c\u4e09\u90e8\u5206\uff1aMapReduce - \u5206\u5e03\u5f0f\u8ba1\u7b97",id:"\u7b2c\u4e09\u90e8\u5206mapreduce---\u5206\u5e03\u5f0f\u8ba1\u7b97",level:2},{value:"MapReduce\u601d\u60f3",id:"mapreduce\u601d\u60f3",level:3},{value:"\u5b9e\u6218\uff1aWordCount",id:"\u5b9e\u6218wordcount",level:3},{value:"MapReduce\u4f18\u5316\u6280\u5de7",id:"mapreduce\u4f18\u5316\u6280\u5de7",level:3},{value:"\u7b2c\u56db\u90e8\u5206\uff1aYARN - \u8d44\u6e90\u7ba1\u7406",id:"\u7b2c\u56db\u90e8\u5206yarn---\u8d44\u6e90\u7ba1\u7406",level:2},{value:"YARN\u67b6\u6784",id:"yarn\u67b6\u6784",level:3},{value:"YARN\u547d\u4ee4",id:"yarn\u547d\u4ee4",level:3},{value:"\u7b2c\u4e94\u90e8\u5206\uff1a\u5b9e\u6218\u9879\u76ee",id:"\u7b2c\u4e94\u90e8\u5206\u5b9e\u6218\u9879\u76ee",level:2},{value:"\u9879\u76ee\uff1a\u7535\u5546\u65e5\u5fd7\u5206\u6790\u7cfb\u7edf",id:"\u9879\u76ee\u7535\u5546\u65e5\u5fd7\u5206\u6790\u7cfb\u7edf",level:3},{value:"\u603b\u7ed3",id:"\u603b\u7ed3",level:2},{value:"\u7ec3\u4e60\u9898",id:"\u7ec3\u4e60\u9898",level:2}];function c(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e.header,{children:(0,a.jsx)(e.h1,{id:"hadoop\u751f\u6001\u7cfb\u7edf---\u5927\u6570\u636e\u7684\u57fa\u77f3",children:"Hadoop\u751f\u6001\u7cfb\u7edf - \u5927\u6570\u636e\u7684\u57fa\u77f3"})}),"\n",(0,a.jsxs)(e.p,{children:["Hadoop\u662f\u5927\u6570\u636e\u7684\u57fa\u7840\uff0c\u4f46\u5f88\u591a\u6559\u7a0b\u53ea\u8bb2\u6982\u5ff5\u3002\u8fd9\u4e00\u7ae0\u4f1a\u5e26\u4f60",(0,a.jsx)(e.strong,{children:"\u771f\u6b63\u642d\u5efa\u548c\u4f7f\u7528Hadoop"}),"\u3002"]}),"\n",(0,a.jsx)(e.h2,{id:"\u7b2c\u4e00\u90e8\u5206\u7406\u89e3hadoop",children:"\u7b2c\u4e00\u90e8\u5206\uff1a\u7406\u89e3Hadoop"}),"\n",(0,a.jsx)(e.h3,{id:"\u4e3a\u4ec0\u4e48\u9700\u8981hadoop",children:"\u4e3a\u4ec0\u4e48\u9700\u8981Hadoop\uff1f"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"\u95ee\u9898"}),"\uff1a\u4f60\u67091TB\u7684\u65e5\u5fd7\u6587\u4ef6\uff0c\u8981\u7edf\u8ba1\u6bcf\u4e2aIP\u7684\u8bbf\u95ee\u6b21\u6570\u3002"]}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"\u4f20\u7edf\u65b9\u5f0f"}),"\uff1a"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:"# \u5355\u673a\u5904\u7406 - \u5185\u5b58\u7206\u4e86\uff01\nip_counts = {}\nwith open('1TB_log.txt') as f:  # \u5185\u5b58\u88c5\u4e0d\u4e0b\n    for line in f:\n        ip = extract_ip(line)\n        ip_counts[ip] = ip_counts.get(ip, 0) + 1\n"})}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"Hadoop\u65b9\u5f0f"}),"\uff1a"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:"# \u5206\u5e03\u5f0f\u5904\u7406 - 100\u53f0\u673a\u5668\u5e76\u884c\n# \u6bcf\u53f0\u673a\u5668\u5904\u740610GB\uff0c\u6700\u540e\u6c47\u603b\u7ed3\u679c\n# \u539f\u672c\u9700\u898110\u5c0f\u65f6\uff0c\u73b0\u5728\u53ea\u9700\u89816\u5206\u949f\uff01\n"})}),"\n",(0,a.jsx)(e.h3,{id:"hadoop\u4e09\u5927\u6838\u5fc3",children:"Hadoop\u4e09\u5927\u6838\u5fc3"}),"\n",(0,a.jsxs)(e.ol,{children:["\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"HDFS"}),"\uff1a\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf\uff08\u5b58\u50a8\uff09"]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"MapReduce"}),"\uff1a\u5206\u5e03\u5f0f\u8ba1\u7b97\u6846\u67b6\uff08\u8ba1\u7b97\uff09"]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"YARN"}),"\uff1a\u8d44\u6e90\u7ba1\u7406\u5668\uff08\u8c03\u5ea6\uff09"]}),"\n"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502           \u5e94\u7528\u5c42                     \u2502\n\u2502    MapReduce\u3001Spark\u3001Hive           \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n              \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502           YARN                       \u2502\n\u2502      \u8d44\u6e90\u7ba1\u7406\u548c\u4efb\u52a1\u8c03\u5ea6               \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n              \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502           HDFS                       \u2502\n\u2502      \u5206\u5e03\u5f0f\u6587\u4ef6\u5b58\u50a8                   \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,a.jsx)(e.h2,{id:"\u7b2c\u4e8c\u90e8\u5206hdfs---\u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf",children:"\u7b2c\u4e8c\u90e8\u5206\uff1aHDFS - \u5206\u5e03\u5f0f\u6587\u4ef6\u7cfb\u7edf"}),"\n",(0,a.jsx)(e.h3,{id:"hdfs\u7684\u8bbe\u8ba1\u601d\u60f3",children:"HDFS\u7684\u8bbe\u8ba1\u601d\u60f3"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"\u6838\u5fc3\u7406\u5ff5"}),"\uff1a"]}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:"\u4e00\u6b21\u5199\u5165\uff0c\u591a\u6b21\u8bfb\u53d6"}),"\n",(0,a.jsx)(e.li,{children:"\u5927\u6587\u4ef6\u5b58\u50a8\uff08GB\u3001TB\u7ea7\u522b\uff09"}),"\n",(0,a.jsx)(e.li,{children:"\u6d41\u5f0f\u6570\u636e\u8bbf\u95ee"}),"\n",(0,a.jsx)(e.li,{children:"\u786c\u4ef6\u6545\u969c\u662f\u5e38\u6001"}),"\n"]}),"\n",(0,a.jsx)(e.h3,{id:"hdfs\u67b6\u6784",children:"HDFS\u67b6\u6784"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  NameNode    \u2502  \u2190 \u7ba1\u7406\u8005\uff1a\u8bb0\u5f55\u6587\u4ef6\u5728\u54ea\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n       \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 DataNode 1   \u2502 DataNode 2   \u2502 DataNode 3   \u2502  \u2190 \u5de5\u4eba\uff1a\u5b58\u50a8\u6570\u636e\n\u2502 Block 1,3,5  \u2502 Block 2,4,6  \u2502 Block 1,2,3  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.strong,{children:"\u6587\u4ef6\u5982\u4f55\u5b58\u50a8\uff1f"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:"# \u5047\u8bbe\u4f60\u4e0a\u4f20\u4e00\u4e2a300MB\u7684\u6587\u4ef6\n# HDFS\u4f1a\u8fd9\u6837\u5904\u7406\uff1a\n\n1. \u5207\u5206\u6210\u5757\uff08\u9ed8\u8ba4128MB\uff09\n   \u6587\u4ef6 \u2192 Block1(128MB) + Block2(128MB) + Block3(44MB)\n\n2. \u6bcf\u4e2a\u5757\u590d\u52363\u4efd\uff08\u9632\u6b62\u4e22\u5931\uff09\n   Block1 \u2192 DataNode1, DataNode2, DataNode3\n   Block2 \u2192 DataNode2, DataNode3, DataNode1\n   Block3 \u2192 DataNode3, DataNode1, DataNode2\n\n3. NameNode\u8bb0\u5f55\u6620\u5c04\u5173\u7cfb\n   file.txt \u2192 [Block1@DN1,DN2,DN3, Block2@DN2,DN3,DN1, ...]\n"})}),"\n",(0,a.jsx)(e.h3,{id:"\u5b9e\u6218\u642d\u5efahdfs",children:"\u5b9e\u6218\uff1a\u642d\u5efaHDFS"}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.strong,{children:"1. \u4f7f\u7528Docker\u5feb\u901f\u642d\u5efa"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:'# docker-compose.yml\nversion: \'3\'\nservices:\n  namenode:\n    image: bde2020/hadoop-namenode:2.0.0-hadoop3.2.1-java8\n    container_name: namenode\n    ports:\n      - "9870:9870"\n      - "9000:9000"\n    environment:\n      - CLUSTER_NAME=test\n    volumes:\n      - hadoop_namenode:/hadoop/dfs/name\n\n  datanode:\n    image: bde2020/hadoop-datanode:2.0.0-hadoop3.2.1-java8\n    container_name: datanode\n    environment:\n      - CORE_CONF_fs_defaultFS=hdfs://namenode:9000\n    volumes:\n      - hadoop_datanode:/hadoop/dfs/data\n\nvolumes:\n  hadoop_namenode:\n  hadoop_datanode:\n'})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u542f\u52a8\ndocker-compose up -d\n\n# \u67e5\u770bWeb\u754c\u9762\n# \u6d4f\u89c8\u5668\u6253\u5f00: http://localhost:9870\n"})}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.strong,{children:"2. HDFS\u57fa\u672c\u64cd\u4f5c"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u8fdb\u5165\u5bb9\u5668\ndocker exec -it namenode bash\n\n# \u521b\u5efa\u76ee\u5f55\nhdfs dfs -mkdir -p /user/data\n\n# \u4e0a\u4f20\u6587\u4ef6\nhdfs dfs -put local_file.txt /user/data/\n\n# \u67e5\u770b\u6587\u4ef6\u5217\u8868\nhdfs dfs -ls /user/data/\n\n# \u67e5\u770b\u6587\u4ef6\u5185\u5bb9\nhdfs dfs -cat /user/data/local_file.txt\n\n# \u4e0b\u8f7d\u6587\u4ef6\nhdfs dfs -get /user/data/local_file.txt ./\n\n# \u5220\u9664\u6587\u4ef6\nhdfs dfs -rm /user/data/local_file.txt\n\n# \u67e5\u770b\u6587\u4ef6\u5927\u5c0f\nhdfs dfs -du -h /user/data/\n\n# \u67e5\u770b\u78c1\u76d8\u4f7f\u7528\u60c5\u51b5\nhdfs dfsadmin -report\n"})}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.strong,{children:"3. Python\u64cd\u4f5cHDFS"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:"from hdfs import InsecureClient\n\n# \u8fde\u63a5HDFS\nclient = InsecureClient('http://localhost:9870', user='root')\n\n# \u4e0a\u4f20\u6587\u4ef6\nclient.upload('/user/data/test.txt', 'local_test.txt')\n\n# \u4e0b\u8f7d\u6587\u4ef6\nclient.download('/user/data/test.txt', 'downloaded.txt')\n\n# \u8bfb\u53d6\u6587\u4ef6\nwith client.read('/user/data/test.txt', encoding='utf-8') as reader:\n    content = reader.read()\n    print(content)\n\n# \u5199\u5165\u6587\u4ef6\nwith client.write('/user/data/output.txt', encoding='utf-8') as writer:\n    writer.write('Hello HDFS!')\n\n# \u5217\u51fa\u76ee\u5f55\nfiles = client.list('/user/data/')\nprint(files)\n\n# \u5220\u9664\u6587\u4ef6\nclient.delete('/user/data/test.txt')\n\n# \u83b7\u53d6\u6587\u4ef6\u72b6\u6001\nstatus = client.status('/user/data/output.txt')\nprint(f\"\u6587\u4ef6\u5927\u5c0f: {status['length']} bytes\")\n"})}),"\n",(0,a.jsx)(e.h3,{id:"hdfs\u9ad8\u7ea7\u7279\u6027",children:"HDFS\u9ad8\u7ea7\u7279\u6027"}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.strong,{children:"1. \u526f\u672c\u653e\u7f6e\u7b56\u7565"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:"# HDFS\u7684\u667a\u80fd\u526f\u672c\u653e\u7f6e\n# \u7b2c\u4e00\u4e2a\u526f\u672c\uff1a\u5199\u5165\u7684DataNode\n# \u7b2c\u4e8c\u4e2a\u526f\u672c\uff1a\u4e0d\u540c\u673a\u67b6\u7684DataNode\n# \u7b2c\u4e09\u4e2a\u526f\u672c\uff1a\u7b2c\u4e8c\u4e2a\u526f\u672c\u540c\u673a\u67b6\u7684\u4e0d\u540cDataNode\n\n# \u8fd9\u6837\u8bbe\u8ba1\u7684\u597d\u5904\uff1a\n# - \u673a\u67b6\u6545\u969c\u4e0d\u4f1a\u4e22\u6570\u636e\n# - \u8bfb\u53d6\u65f6\u53ef\u4ee5\u9009\u62e9\u6700\u8fd1\u7684\u526f\u672c\n# - \u7f51\u7edc\u5e26\u5bbd\u5229\u7528\u7387\u9ad8\n"})}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.strong,{children:"2. \u6570\u636e\u5b8c\u6574\u6027"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# HDFS\u4f1a\u81ea\u52a8\u6821\u9a8c\u6570\u636e\n# \u6bcf\u4e2a\u5757\u90fd\u6709\u6821\u9a8c\u548c\uff08checksum\uff09\n\n# \u624b\u52a8\u68c0\u67e5\u6587\u4ef6\u5b8c\u6574\u6027\nhdfs fsck /user/data/file.txt -files -blocks -locations\n"})}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.strong,{children:"3. \u5feb\u7167"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u521b\u5efa\u5feb\u7167\u76ee\u5f55\nhdfs dfsadmin -allowSnapshot /user/data\n\n# \u521b\u5efa\u5feb\u7167\nhdfs dfs -createSnapshot /user/data snapshot1\n\n# \u67e5\u770b\u5feb\u7167\nhdfs dfs -ls /user/data/.snapshot/\n\n# \u6062\u590d\u5feb\u7167\nhdfs dfs -cp /user/data/.snapshot/snapshot1/file.txt /user/data/\n\n# \u5220\u9664\u5feb\u7167\nhdfs dfs -deleteSnapshot /user/data snapshot1\n"})}),"\n",(0,a.jsx)(e.h2,{id:"\u7b2c\u4e09\u90e8\u5206mapreduce---\u5206\u5e03\u5f0f\u8ba1\u7b97",children:"\u7b2c\u4e09\u90e8\u5206\uff1aMapReduce - \u5206\u5e03\u5f0f\u8ba1\u7b97"}),"\n",(0,a.jsx)(e.h3,{id:"mapreduce\u601d\u60f3",children:"MapReduce\u601d\u60f3"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"\u6838\u5fc3"}),"\uff1a\u5206\u800c\u6cbb\u4e4b"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:'# \u95ee\u9898\uff1a\u7edf\u8ba11TB\u6587\u672c\u4e2d\u6bcf\u4e2a\u5355\u8bcd\u51fa\u73b0\u6b21\u6570\n\n# Map\u9636\u6bb5\uff1a\u6bcf\u53f0\u673a\u5668\u5904\u7406\u4e00\u90e8\u5206\nMachine1: "hello world" \u2192 [("hello", 1), ("world", 1)]\nMachine2: "hello hadoop" \u2192 [("hello", 1), ("hadoop", 1)]\nMachine3: "world hadoop" \u2192 [("world", 1), ("hadoop", 1)]\n\n# Shuffle\u9636\u6bb5\uff1a\u76f8\u540ckey\u7684\u6570\u636e\u53d1\u9001\u5230\u540c\u4e00\u53f0\u673a\u5668\nMachine1: ("hello", [1, 1])\nMachine2: ("world", [1, 1])\nMachine3: ("hadoop", [1, 1])\n\n# Reduce\u9636\u6bb5\uff1a\u6c47\u603b\u7ed3\u679c\nMachine1: ("hello", 2)\nMachine2: ("world", 2)\nMachine3: ("hadoop", 2)\n'})}),"\n",(0,a.jsx)(e.h3,{id:"\u5b9e\u6218wordcount",children:"\u5b9e\u6218\uff1aWordCount"}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.strong,{children:"1. Python\u7248\u672c\uff08\u4f7f\u7528mrjob\uff09"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:'# wordcount.py\nfrom mrjob.job import MRJob\nimport re\n\nclass WordCount(MRJob):\n    \n    def mapper(self, _, line):\n        """Map\u9636\u6bb5\uff1a\u62c6\u5206\u5355\u8bcd"""\n        # \u6e05\u7406\u6587\u672c\uff0c\u63d0\u53d6\u5355\u8bcd\n        words = re.findall(r\'\\w+\', line.lower())\n        for word in words:\n            yield word, 1\n    \n    def reducer(self, word, counts):\n        """Reduce\u9636\u6bb5\uff1a\u6c47\u603b\u8ba1\u6570"""\n        yield word, sum(counts)\n\nif __name__ == \'__main__\':\n    WordCount.run()\n'})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u672c\u5730\u6d4b\u8bd5\npython wordcount.py input.txt\n\n# \u5728Hadoop\u4e0a\u8fd0\u884c\npython wordcount.py -r hadoop hdfs:///user/data/input.txt\n"})}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.strong,{children:"2. \u66f4\u590d\u6742\u7684\u4f8b\u5b50\uff1a\u65e5\u5fd7\u5206\u6790"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:'# log_analysis.py\nfrom mrjob.job import MRJob\nfrom mrjob.step import MRStep\nimport re\n\nclass LogAnalysis(MRJob):\n    \n    def steps(self):\n        """\u5b9a\u4e49\u591a\u4e2aMapReduce\u6b65\u9aa4"""\n        return [\n            MRStep(mapper=self.mapper_parse_log,\n                   reducer=self.reducer_count_by_ip),\n            MRStep(reducer=self.reducer_find_top)\n        ]\n    \n    def mapper_parse_log(self, _, line):\n        """\u89e3\u6790\u65e5\u5fd7\uff0c\u63d0\u53d6IP"""\n        # \u65e5\u5fd7\u683c\u5f0f: 192.168.1.1 - - [01/Jan/2024:10:00:00] "GET /index.html"\n        match = re.match(r\'(\\d+\\.\\d+\\.\\d+\\.\\d+)\', line)\n        if match:\n            ip = match.group(1)\n            yield ip, 1\n    \n    def reducer_count_by_ip(self, ip, counts):\n        """\u7edf\u8ba1\u6bcf\u4e2aIP\u7684\u8bbf\u95ee\u6b21\u6570"""\n        total = sum(counts)\n        yield None, (total, ip)  # \u8f93\u51fa(\u6b21\u6570, IP)\n    \n    def reducer_find_top(self, _, ip_counts):\n        """\u627e\u51fa\u8bbf\u95ee\u6700\u591a\u7684TOP10 IP"""\n        top_ips = sorted(ip_counts, reverse=True)[:10]\n        for count, ip in top_ips:\n            yield ip, count\n\nif __name__ == \'__main__\':\n    LogAnalysis.run()\n'})}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.strong,{children:"3. \u5b9e\u6218\u6848\u4f8b\uff1a\u7528\u6237\u884c\u4e3a\u5206\u6790"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:"# user_behavior.py\nfrom mrjob.job import MRJob\nfrom mrjob.step import MRStep\nimport json\n\nclass UserBehavior(MRJob):\n    \n    def steps(self):\n        return [\n            MRStep(mapper=self.mapper_parse_event,\n                   reducer=self.reducer_aggregate_user),\n            MRStep(mapper=self.mapper_user_stats,\n                   reducer=self.reducer_summary)\n        ]\n    \n    def mapper_parse_event(self, _, line):\n        \"\"\"\u89e3\u6790\u7528\u6237\u4e8b\u4ef6\"\"\"\n        try:\n            event = json.loads(line)\n            user_id = event['user_id']\n            action = event['action']\n            timestamp = event['timestamp']\n            \n            yield user_id, {\n                'action': action,\n                'timestamp': timestamp\n            }\n        except:\n            pass\n    \n    def reducer_aggregate_user(self, user_id, events):\n        \"\"\"\u805a\u5408\u5355\u4e2a\u7528\u6237\u7684\u884c\u4e3a\"\"\"\n        events_list = list(events)\n        \n        # \u7edf\u8ba1\u5404\u79cd\u884c\u4e3a\u6b21\u6570\n        action_counts = {}\n        for event in events_list:\n            action = event['action']\n            action_counts[action] = action_counts.get(action, 0) + 1\n        \n        # \u8ba1\u7b97\u6d3b\u8dc3\u5ea6\n        total_actions = sum(action_counts.values())\n        \n        yield 'user_stats', {\n            'user_id': user_id,\n            'total_actions': total_actions,\n            'action_counts': action_counts\n        }\n    \n    def mapper_user_stats(self, key, stats):\n        \"\"\"\u6309\u6d3b\u8dc3\u5ea6\u5206\u7c7b\u7528\u6237\"\"\"\n        total = stats['total_actions']\n        \n        if total >= 100:\n            category = 'highly_active'\n        elif total >= 10:\n            category = 'active'\n        else:\n            category = 'inactive'\n        \n        yield category, 1\n    \n    def reducer_summary(self, category, counts):\n        \"\"\"\u6c47\u603b\u7edf\u8ba1\"\"\"\n        yield category, sum(counts)\n\nif __name__ == '__main__':\n    UserBehavior.run()\n"})}),"\n",(0,a.jsx)(e.h3,{id:"mapreduce\u4f18\u5316\u6280\u5de7",children:"MapReduce\u4f18\u5316\u6280\u5de7"}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.strong,{children:"1. Combiner\uff1a\u672c\u5730\u805a\u5408"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:'class WordCountOptimized(MRJob):\n    \n    def mapper(self, _, line):\n        for word in line.split():\n            yield word, 1\n    \n    def combiner(self, word, counts):\n        """\u5728Map\u7aef\u5148\u505a\u4e00\u6b21\u805a\u5408\uff0c\u51cf\u5c11\u7f51\u7edc\u4f20\u8f93"""\n        yield word, sum(counts)\n    \n    def reducer(self, word, counts):\n        yield word, sum(counts)\n'})}),"\n",(0,a.jsx)(e.p,{children:(0,a.jsx)(e.strong,{children:"2. \u81ea\u5b9a\u4e49\u5206\u533a"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:"class CustomPartitioner(MRJob):\n    \n    def mapper(self, _, line):\n        # \u6309\u9996\u5b57\u6bcd\u5206\u533a\n        word = line.strip().lower()\n        if word:\n            first_letter = word[0]\n            yield (first_letter, word), 1\n    \n    def reducer(self, key, counts):\n        first_letter, word = key\n        yield word, sum(counts)\n"})}),"\n",(0,a.jsx)(e.h2,{id:"\u7b2c\u56db\u90e8\u5206yarn---\u8d44\u6e90\u7ba1\u7406",children:"\u7b2c\u56db\u90e8\u5206\uff1aYARN - \u8d44\u6e90\u7ba1\u7406"}),"\n",(0,a.jsx)(e.h3,{id:"yarn\u67b6\u6784",children:"YARN\u67b6\u6784"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  ResourceManager \u2502  \u2190 \u603b\u7ba1\uff1a\u5206\u914d\u8d44\u6e90\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n         \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502  NM1   \u2502  NM2   \u2502  NM3   \u2502  \u2190 NodeManager\uff1a\u7ba1\u7406\u5355\u673a\u8d44\u6e90\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n    \u2193        \u2193        \u2193\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502Container\u2502Container\u2502Container\u2502  \u2190 \u5bb9\u5668\uff1a\u8fd0\u884c\u4efb\u52a1\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,a.jsx)(e.h3,{id:"yarn\u547d\u4ee4",children:"YARN\u547d\u4ee4"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u67e5\u770b\u6240\u6709\u5e94\u7528\nyarn application -list\n\n# \u67e5\u770b\u5e94\u7528\u72b6\u6001\nyarn application -status application_1234567890_0001\n\n# \u6740\u6b7b\u5e94\u7528\nyarn application -kill application_1234567890_0001\n\n# \u67e5\u770b\u65e5\u5fd7\nyarn logs -applicationId application_1234567890_0001\n\n# \u67e5\u770b\u961f\u5217\nyarn queue -status default\n\n# \u67e5\u770b\u8282\u70b9\nyarn node -list\n"})}),"\n",(0,a.jsx)(e.h2,{id:"\u7b2c\u4e94\u90e8\u5206\u5b9e\u6218\u9879\u76ee",children:"\u7b2c\u4e94\u90e8\u5206\uff1a\u5b9e\u6218\u9879\u76ee"}),"\n",(0,a.jsx)(e.h3,{id:"\u9879\u76ee\u7535\u5546\u65e5\u5fd7\u5206\u6790\u7cfb\u7edf",children:"\u9879\u76ee\uff1a\u7535\u5546\u65e5\u5fd7\u5206\u6790\u7cfb\u7edf"}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"\u9700\u6c42"}),"\uff1a"]}),"\n",(0,a.jsxs)(e.ol,{children:["\n",(0,a.jsx)(e.li,{children:"\u7edf\u8ba1\u6bcf\u5929\u7684PV\u3001UV"}),"\n",(0,a.jsx)(e.li,{children:"\u5206\u6790\u70ed\u95e8\u5546\u54c1"}),"\n",(0,a.jsx)(e.li,{children:"\u7528\u6237\u884c\u4e3a\u8def\u5f84\u5206\u6790"}),"\n"]}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"\u6570\u636e\u683c\u5f0f"}),"\uff1a"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-json",children:'{\n  "timestamp": "2024-01-01 10:00:00",\n  "user_id": "user123",\n  "action": "view",\n  "item_id": "item456",\n  "category": "electronics"\n}\n'})}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"\u5b9e\u73b0"}),"\uff1a"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:"# ecommerce_analysis.py\nfrom mrjob.job import MRJob\nfrom mrjob.step import MRStep\nimport json\nfrom datetime import datetime\n\nclass EcommerceAnalysis(MRJob):\n    \n    def steps(self):\n        return [\n            MRStep(mapper=self.mapper_parse,\n                   reducer=self.reducer_daily_stats),\n            MRStep(mapper=self.mapper_category,\n                   reducer=self.reducer_top_items)\n        ]\n    \n    def mapper_parse(self, _, line):\n        \"\"\"\u89e3\u6790\u65e5\u5fd7\"\"\"\n        try:\n            log = json.loads(line)\n            \n            # \u63d0\u53d6\u65e5\u671f\n            date = log['timestamp'][:10]\n            user_id = log['user_id']\n            item_id = log['item_id']\n            category = log['category']\n            action = log['action']\n            \n            # \u8f93\u51fa\u591a\u4e2a\u7ef4\u5ea6\u7684\u6570\u636e\n            # 1. \u65e5\u671f+\u7528\u6237 -> \u7528\u4e8e\u8ba1\u7b97UV\n            yield (date, 'uv', user_id), 1\n            \n            # 2. \u65e5\u671f+PV -> \u7528\u4e8e\u8ba1\u7b97PV\n            yield (date, 'pv'), 1\n            \n            # 3. \u5546\u54c1\u70b9\u51fb\n            if action == 'view':\n                yield (date, 'item', item_id), 1\n            \n            # 4. \u7c7b\u522b\u7edf\u8ba1\n            yield (date, 'category', category), 1\n            \n        except Exception as e:\n            pass\n    \n    def reducer_daily_stats(self, key, values):\n        \"\"\"\u6bcf\u65e5\u7edf\u8ba1\"\"\"\n        if len(key) == 3:\n            date, metric_type, item = key\n            if metric_type == 'uv':\n                # UV\uff1a\u6bcf\u4e2a\u7528\u6237\u53ea\u8ba1\u6570\u4e00\u6b21\n                yield (date, 'uv'), 1\n            elif metric_type == 'item':\n                # \u5546\u54c1\u70b9\u51fb\u6b21\u6570\n                yield (date, 'item', item), sum(values)\n            elif metric_type == 'category':\n                # \u7c7b\u522b\u7edf\u8ba1\n                yield (date, 'category', item), sum(values)\n        else:\n            date, metric_type = key\n            if metric_type == 'pv':\n                # PV\uff1a\u603b\u70b9\u51fb\u6570\n                yield (date, 'pv'), sum(values)\n    \n    def mapper_category(self, key, value):\n        \"\"\"\u6309\u7c7b\u522b\u5206\u7ec4\"\"\"\n        if len(key) == 3:\n            date, metric_type, item = key\n            if metric_type == 'item':\n                # \u8f93\u51fa\u5546\u54c1\u70b9\u51fb\u6570\n                yield (date, 'top_items'), (value, item)\n            elif metric_type == 'category':\n                # \u8f93\u51fa\u7c7b\u522b\u7edf\u8ba1\n                yield (date, 'category_stats'), (item, value)\n        else:\n            # \u8f93\u51faPV/UV\n            yield key, value\n    \n    def reducer_top_items(self, key, values):\n        \"\"\"\u6c47\u603b\u7ed3\u679c\"\"\"\n        date, metric_type = key\n        \n        if metric_type == 'top_items':\n            # \u627e\u51faTOP10\u5546\u54c1\n            items = sorted(values, reverse=True)[:10]\n            for count, item_id in items:\n                yield f\"{date}_top_item\", f\"{item_id}: {count}\"\n        \n        elif metric_type == 'category_stats':\n            # \u7c7b\u522b\u7edf\u8ba1\n            for category, count in values:\n                yield f\"{date}_category\", f\"{category}: {count}\"\n        \n        else:\n            # PV/UV\n            total = sum(values)\n            yield f\"{date}_{metric_type}\", total\n\nif __name__ == '__main__':\n    EcommerceAnalysis.run()\n"})}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"\u8fd0\u884c"}),"\uff1a"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-bash",children:"# \u751f\u6210\u6d4b\u8bd5\u6570\u636e\npython generate_test_data.py > test_logs.json\n\n# \u672c\u5730\u6d4b\u8bd5\npython ecommerce_analysis.py test_logs.json\n\n# \u4e0a\u4f20\u5230HDFS\nhdfs dfs -put test_logs.json /user/data/logs/\n\n# \u5728Hadoop\u4e0a\u8fd0\u884c\npython ecommerce_analysis.py -r hadoop hdfs:///user/data/logs/test_logs.json \\\n    --output-dir hdfs:///user/data/output/\n"})}),"\n",(0,a.jsx)(e.h2,{id:"\u603b\u7ed3",children:"\u603b\u7ed3"}),"\n",(0,a.jsx)(e.p,{children:"Hadoop\u662f\u5927\u6570\u636e\u7684\u57fa\u7840\uff1a"}),"\n",(0,a.jsxs)(e.ol,{children:["\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"HDFS"}),"\uff1a\u5206\u5e03\u5f0f\u5b58\u50a8\uff0c\u53ef\u9760\u3001\u53ef\u6269\u5c55"]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"MapReduce"}),"\uff1a\u5206\u5e03\u5f0f\u8ba1\u7b97\uff0c\u7b80\u5355\u3001\u5f3a\u5927"]}),"\n",(0,a.jsxs)(e.li,{children:[(0,a.jsx)(e.strong,{children:"YARN"}),"\uff1a\u8d44\u6e90\u7ba1\u7406\uff0c\u7075\u6d3b\u3001\u9ad8\u6548"]}),"\n"]}),"\n",(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.strong,{children:"\u4e0b\u4e00\u6b65"}),"\uff1a"]}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:"\u5b66\u4e60Spark\uff08\u6bd4MapReduce\u5feb100\u500d\uff09"}),"\n",(0,a.jsx)(e.li,{children:"\u5b66\u4e60Hive\uff08\u7528SQL\u67e5\u8be2\u5927\u6570\u636e\uff09"}),"\n",(0,a.jsx)(e.li,{children:"\u5b66\u4e60HBase\uff08\u5b9e\u65f6\u67e5\u8be2\uff09"}),"\n"]}),"\n",(0,a.jsxs)(e.p,{children:["\u8bb0\u4f4f\uff1a",(0,a.jsx)(e.strong,{children:"Hadoop\u4e0d\u96be\uff0c\u591a\u52a8\u624b\uff01"})]}),"\n",(0,a.jsx)(e.h2,{id:"\u7ec3\u4e60\u9898",children:"\u7ec3\u4e60\u9898"}),"\n",(0,a.jsxs)(e.ol,{children:["\n",(0,a.jsx)(e.li,{children:"\u5b9e\u73b0\u4e00\u4e2a\u5012\u6392\u7d22\u5f15\uff08\u641c\u7d22\u5f15\u64ce\u7684\u57fa\u7840\uff09"}),"\n",(0,a.jsx)(e.li,{children:"\u5206\u6790Twitter\u6570\u636e\uff0c\u627e\u51fa\u70ed\u95e8\u8bdd\u9898"}),"\n",(0,a.jsx)(e.li,{children:"\u5b9e\u73b0PageRank\u7b97\u6cd5"}),"\n",(0,a.jsx)(e.li,{children:"\u6784\u5efa\u4e00\u4e2a\u63a8\u8350\u7cfb\u7edf\u7684\u79bb\u7ebf\u90e8\u5206"}),"\n"]}),"\n",(0,a.jsxs)(e.p,{children:["\u4e0b\u4e00\u7ae0\uff1a",(0,a.jsx)(e.a,{href:"/weuqiangcreate_website/docs/%E5%A4%A7%E6%95%B0%E6%8D%AE%E6%8A%80%E6%9C%AF/Spark%E5%BF%AB%E9%80%9F%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90",children:"Spark\u5feb\u901f\u5927\u6570\u636e\u5206\u6790"})]})]})}function p(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,a.jsx)(e,{...n,children:(0,a.jsx)(c,{...n})}):c(n)}},28453(n,e,s){s.d(e,{R:()=>d,x:()=>o});var t=s(96540);const a={},r=t.createContext(a);function d(n){const e=t.useContext(r);return t.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(a):n.components||a:d(n.components),t.createElement(r.Provider,{value:e},n.children)}}}]);