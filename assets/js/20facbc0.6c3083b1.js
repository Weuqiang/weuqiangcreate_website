"use strict";(globalThis.webpackChunkweuqiangcreate_website=globalThis.webpackChunkweuqiangcreate_website||[]).push([[28836],{41558(e,n,s){s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>c,frontMatter:()=>d,metadata:()=>r,toc:()=>u});const r=JSON.parse('{"id":"\u6570\u636e\u5e93/mysql","title":"MySQL - \u4ece\u5165\u95e8\u5230\u7cbe\u901a","description":"MySQL\u662f\u4e16\u754c\u4e0a\u6700\u6d41\u884c\u7684\u5f00\u6e90\u5173\u7cfb\u578b\u6570\u636e\u5e93\u3002\u8fd9\u4e00\u7ae0\u6559\u4f60\u4ece\u57fa\u7840\u5230\u9ad8\u7ea7\u7684MySQL\u6280\u672f\u3002","source":"@site/docs/docs/\u6570\u636e\u5e93/mysql.mdx","sourceDirName":"\u6570\u636e\u5e93","slug":"/\u6570\u636e\u5e93/mysql","permalink":"/weuqiangcreate_website/docs/\u6570\u636e\u5e93/mysql","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"MySQL - \u4ece\u5165\u95e8\u5230\u7cbe\u901a"},"sidebar":"tutorialSidebar","previous":{"title":"\u6570\u636e\u5e93","permalink":"/weuqiangcreate_website/docs/\u6570\u636e\u5e93/"},"next":{"title":"MongoDB - \u7075\u6d3b\u7684\u6587\u6863\u6570\u636e\u5e93","permalink":"/weuqiangcreate_website/docs/\u6570\u636e\u5e93/mongodb"}}');var E=s(74848),a=s(28453);const d={sidebar_position:1,title:"MySQL - \u4ece\u5165\u95e8\u5230\u7cbe\u901a"},i="MySQL - \u6700\u6d41\u884c\u7684\u5f00\u6e90\u6570\u636e\u5e93",l={},u=[{value:"\u7b2c\u4e00\u90e8\u5206\uff1aMySQL\u57fa\u7840",id:"\u7b2c\u4e00\u90e8\u5206mysql\u57fa\u7840",level:2},{value:"\u5b89\u88c5\u548c\u914d\u7f6e",id:"\u5b89\u88c5\u548c\u914d\u7f6e",level:3},{value:"\u6570\u636e\u5e93\u64cd\u4f5c",id:"\u6570\u636e\u5e93\u64cd\u4f5c",level:3},{value:"\u8868\u64cd\u4f5c",id:"\u8868\u64cd\u4f5c",level:3},{value:"\u7b2c\u4e8c\u90e8\u5206\uff1aCRUD\u64cd\u4f5c",id:"\u7b2c\u4e8c\u90e8\u5206crud\u64cd\u4f5c",level:2},{value:"\u63d2\u5165\u6570\u636e",id:"\u63d2\u5165\u6570\u636e",level:3},{value:"\u67e5\u8be2\u6570\u636e",id:"\u67e5\u8be2\u6570\u636e",level:3},{value:"\u66f4\u65b0\u6570\u636e",id:"\u66f4\u65b0\u6570\u636e",level:3},{value:"\u5220\u9664\u6570\u636e",id:"\u5220\u9664\u6570\u636e",level:3},{value:"\u7b2c\u4e09\u90e8\u5206\uff1a\u9ad8\u7ea7\u67e5\u8be2",id:"\u7b2c\u4e09\u90e8\u5206\u9ad8\u7ea7\u67e5\u8be2",level:2},{value:"\u8fde\u63a5\u67e5\u8be2",id:"\u8fde\u63a5\u67e5\u8be2",level:3},{value:"\u5b50\u67e5\u8be2",id:"\u5b50\u67e5\u8be2",level:3},{value:"\u7a97\u53e3\u51fd\u6570\uff08MySQL 8.0+\uff09",id:"\u7a97\u53e3\u51fd\u6570mysql-80",level:3},{value:"CTE\uff08\u516c\u5171\u8868\u8868\u8fbe\u5f0f\uff09",id:"cte\u516c\u5171\u8868\u8868\u8fbe\u5f0f",level:3},{value:"\u7b2c\u56db\u90e8\u5206\uff1a\u7d22\u5f15\u4f18\u5316",id:"\u7b2c\u56db\u90e8\u5206\u7d22\u5f15\u4f18\u5316",level:2},{value:"\u7d22\u5f15\u7c7b\u578b",id:"\u7d22\u5f15\u7c7b\u578b",level:3},{value:"\u7d22\u5f15\u539f\u7406",id:"\u7d22\u5f15\u539f\u7406",level:3},{value:"\u7d22\u5f15\u4f18\u5316\u6280\u5de7",id:"\u7d22\u5f15\u4f18\u5316\u6280\u5de7",level:3},{value:"\u7b2c\u4e94\u90e8\u5206\uff1a\u4e8b\u52a1\u548c\u9501",id:"\u7b2c\u4e94\u90e8\u5206\u4e8b\u52a1\u548c\u9501",level:2},{value:"\u4e8b\u52a1\u57fa\u7840",id:"\u4e8b\u52a1\u57fa\u7840",level:3},{value:"\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b",id:"\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b",level:3},{value:"\u9501\u673a\u5236",id:"\u9501\u673a\u5236",level:3},{value:"\u7b2c\u516d\u90e8\u5206\uff1a\u6027\u80fd\u4f18\u5316",id:"\u7b2c\u516d\u90e8\u5206\u6027\u80fd\u4f18\u5316",level:2},{value:"\u6162\u67e5\u8be2\u5206\u6790",id:"\u6162\u67e5\u8be2\u5206\u6790",level:3},{value:"\u67e5\u8be2\u4f18\u5316",id:"\u67e5\u8be2\u4f18\u5316",level:3},{value:"\u8868\u8bbe\u8ba1\u4f18\u5316",id:"\u8868\u8bbe\u8ba1\u4f18\u5316",level:3},{value:"\u7b2c\u4e03\u90e8\u5206\uff1a\u5b9e\u6218\u9879\u76ee",id:"\u7b2c\u4e03\u90e8\u5206\u5b9e\u6218\u9879\u76ee",level:2},{value:"\u9879\u76ee\uff1a\u7535\u5546\u6570\u636e\u5e93\u8bbe\u8ba1",id:"\u9879\u76ee\u7535\u5546\u6570\u636e\u5e93\u8bbe\u8ba1",level:3},{value:"\u603b\u7ed3",id:"\u603b\u7ed3",level:2},{value:"\u7ec3\u4e60\u9898",id:"\u7ec3\u4e60\u9898",level:2}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(n.header,{children:(0,E.jsx)(n.h1,{id:"mysql---\u6700\u6d41\u884c\u7684\u5f00\u6e90\u6570\u636e\u5e93",children:"MySQL - \u6700\u6d41\u884c\u7684\u5f00\u6e90\u6570\u636e\u5e93"})}),"\n",(0,E.jsxs)(n.p,{children:["MySQL\u662f\u4e16\u754c\u4e0a\u6700\u6d41\u884c\u7684\u5f00\u6e90\u5173\u7cfb\u578b\u6570\u636e\u5e93\u3002\u8fd9\u4e00\u7ae0\u6559\u4f60",(0,E.jsx)(n.strong,{children:"\u4ece\u57fa\u7840\u5230\u9ad8\u7ea7\u7684MySQL\u6280\u672f"}),"\u3002"]}),"\n",(0,E.jsx)(n.h2,{id:"\u7b2c\u4e00\u90e8\u5206mysql\u57fa\u7840",children:"\u7b2c\u4e00\u90e8\u5206\uff1aMySQL\u57fa\u7840"}),"\n",(0,E.jsx)(n.h3,{id:"\u5b89\u88c5\u548c\u914d\u7f6e",children:"\u5b89\u88c5\u548c\u914d\u7f6e"}),"\n",(0,E.jsxs)(n.p,{children:[(0,E.jsx)(n.strong,{children:"Docker\u65b9\u5f0f\uff08\u63a8\u8350\uff09"}),"\uff1a"]}),"\n",(0,E.jsx)(n.pre,{children:(0,E.jsx)(n.code,{className:"language-bash",children:"# \u542f\u52a8MySQL\ndocker run -d --name mysql \\\n  -e MYSQL_ROOT_PASSWORD=password \\\n  -p 3306:3306 \\\n  mysql:8.0\n\n# \u8fdb\u5165MySQL\ndocker exec -it mysql mysql -uroot -ppassword\n"})}),"\n",(0,E.jsxs)(n.p,{children:[(0,E.jsx)(n.strong,{children:"\u8fde\u63a5MySQL"}),"\uff1a"]}),"\n",(0,E.jsx)(n.pre,{children:(0,E.jsx)(n.code,{className:"language-bash",children:"# \u547d\u4ee4\u884c\u8fde\u63a5\nmysql -h localhost -u root -p\n\n# \u67e5\u770b\u7248\u672c\nSELECT VERSION();\n\n# \u67e5\u770b\u5f53\u524d\u7528\u6237\nSELECT USER();\n"})}),"\n",(0,E.jsx)(n.h3,{id:"\u6570\u636e\u5e93\u64cd\u4f5c",children:"\u6570\u636e\u5e93\u64cd\u4f5c"}),"\n",(0,E.jsx)(n.pre,{children:(0,E.jsx)(n.code,{className:"language-sql",children:"-- \u521b\u5efa\u6570\u636e\u5e93\nCREATE DATABASE ecommerce CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;\n\n-- \u67e5\u770b\u6570\u636e\u5e93\nSHOW DATABASES;\n\n-- \u4f7f\u7528\u6570\u636e\u5e93\nUSE ecommerce;\n\n-- \u5220\u9664\u6570\u636e\u5e93\nDROP DATABASE IF EXISTS test_db;\n"})}),"\n",(0,E.jsx)(n.h3,{id:"\u8868\u64cd\u4f5c",children:"\u8868\u64cd\u4f5c"}),"\n",(0,E.jsx)(n.pre,{children:(0,E.jsx)(n.code,{className:"language-sql",children:"-- \u521b\u5efa\u8868\nCREATE TABLE users (\n    id BIGINT PRIMARY KEY AUTO_INCREMENT,\n    username VARCHAR(50) NOT NULL UNIQUE,\n    email VARCHAR(100) NOT NULL,\n    password VARCHAR(255) NOT NULL,\n    age INT,\n    gender ENUM('M', 'F', 'Other'),\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n    INDEX idx_username (username),\n    INDEX idx_email (email)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;\n\n-- \u67e5\u770b\u8868\u7ed3\u6784\nDESC users;\nSHOW CREATE TABLE users;\n\n-- \u4fee\u6539\u8868\nALTER TABLE users ADD COLUMN phone VARCHAR(20);\nALTER TABLE users MODIFY COLUMN age TINYINT;\nALTER TABLE users DROP COLUMN phone;\nALTER TABLE users ADD INDEX idx_age (age);\n\n-- \u5220\u9664\u8868\nDROP TABLE IF EXISTS temp_table;\n"})}),"\n",(0,E.jsx)(n.h2,{id:"\u7b2c\u4e8c\u90e8\u5206crud\u64cd\u4f5c",children:"\u7b2c\u4e8c\u90e8\u5206\uff1aCRUD\u64cd\u4f5c"}),"\n",(0,E.jsx)(n.h3,{id:"\u63d2\u5165\u6570\u636e",children:"\u63d2\u5165\u6570\u636e"}),"\n",(0,E.jsx)(n.pre,{children:(0,E.jsx)(n.code,{className:"language-sql",children:"-- \u5355\u884c\u63d2\u5165\nINSERT INTO users (username, email, password, age, gender)\nVALUES ('alice', 'alice@example.com', 'hashed_password', 25, 'F');\n\n-- \u591a\u884c\u63d2\u5165\nINSERT INTO users (username, email, password, age, gender) VALUES\n('bob', 'bob@example.com', 'hashed_password', 30, 'M'),\n('charlie', 'charlie@example.com', 'hashed_password', 28, 'M'),\n('diana', 'diana@example.com', 'hashed_password', 26, 'F');\n\n-- \u63d2\u5165\u5e76\u8fd4\u56deID\nINSERT INTO users (username, email, password) \nVALUES ('eve', 'eve@example.com', 'hashed_password');\nSELECT LAST_INSERT_ID();\n\n-- \u63d2\u5165\u6216\u66f4\u65b0\uff08ON DUPLICATE KEY\uff09\nINSERT INTO users (id, username, email, password)\nVALUES (1, 'alice', 'alice@example.com', 'new_password')\nON DUPLICATE KEY UPDATE password = VALUES(password);\n"})}),"\n",(0,E.jsx)(n.h3,{id:"\u67e5\u8be2\u6570\u636e",children:"\u67e5\u8be2\u6570\u636e"}),"\n",(0,E.jsx)(n.pre,{children:(0,E.jsx)(n.code,{className:"language-sql",children:"-- \u57fa\u672c\u67e5\u8be2\nSELECT * FROM users;\nSELECT username, email FROM users;\n\n-- \u6761\u4ef6\u67e5\u8be2\nSELECT * FROM users WHERE age > 25;\nSELECT * FROM users WHERE gender = 'F' AND age BETWEEN 20 AND 30;\nSELECT * FROM users WHERE username LIKE 'a%';\nSELECT * FROM users WHERE email IN ('alice@example.com', 'bob@example.com');\n\n-- \u6392\u5e8f\nSELECT * FROM users ORDER BY age DESC;\nSELECT * FROM users ORDER BY age DESC, created_at ASC;\n\n-- \u9650\u5236\u7ed3\u679c\nSELECT * FROM users LIMIT 10;\nSELECT * FROM users LIMIT 10 OFFSET 20;  -- \u5206\u9875\n\n-- \u53bb\u91cd\nSELECT DISTINCT gender FROM users;\n\n-- \u805a\u5408\u51fd\u6570\nSELECT COUNT(*) FROM users;\nSELECT AVG(age) FROM users;\nSELECT MAX(age), MIN(age) FROM users;\nSELECT SUM(age) FROM users;\n\n-- \u5206\u7ec4\nSELECT gender, COUNT(*) as count, AVG(age) as avg_age\nFROM users\nGROUP BY gender;\n\n-- HAVING\u8fc7\u6ee4\nSELECT gender, COUNT(*) as count\nFROM users\nGROUP BY gender\nHAVING count > 10;\n"})}),"\n",(0,E.jsx)(n.h3,{id:"\u66f4\u65b0\u6570\u636e",children:"\u66f4\u65b0\u6570\u636e"}),"\n",(0,E.jsx)(n.pre,{children:(0,E.jsx)(n.code,{className:"language-sql",children:"-- \u66f4\u65b0\u5355\u884c\nUPDATE users SET age = 26 WHERE username = 'alice';\n\n-- \u66f4\u65b0\u591a\u884c\nUPDATE users SET age = age + 1 WHERE gender = 'M';\n\n-- \u66f4\u65b0\u591a\u4e2a\u5b57\u6bb5\nUPDATE users \nSET email = 'newemail@example.com', updated_at = NOW()\nWHERE id = 1;\n"})}),"\n",(0,E.jsx)(n.h3,{id:"\u5220\u9664\u6570\u636e",children:"\u5220\u9664\u6570\u636e"}),"\n",(0,E.jsx)(n.pre,{children:(0,E.jsx)(n.code,{className:"language-sql",children:"-- \u5220\u9664\u5355\u884c\nDELETE FROM users WHERE id = 1;\n\n-- \u5220\u9664\u591a\u884c\nDELETE FROM users WHERE age < 18;\n\n-- \u6e05\u7a7a\u8868\uff08\u4fdd\u7559\u7ed3\u6784\uff09\nTRUNCATE TABLE users;\n"})}),"\n",(0,E.jsx)(n.h2,{id:"\u7b2c\u4e09\u90e8\u5206\u9ad8\u7ea7\u67e5\u8be2",children:"\u7b2c\u4e09\u90e8\u5206\uff1a\u9ad8\u7ea7\u67e5\u8be2"}),"\n",(0,E.jsx)(n.h3,{id:"\u8fde\u63a5\u67e5\u8be2",children:"\u8fde\u63a5\u67e5\u8be2"}),"\n",(0,E.jsx)(n.pre,{children:(0,E.jsx)(n.code,{className:"language-sql",children:"-- \u521b\u5efa\u8ba2\u5355\u8868\nCREATE TABLE orders (\n    id BIGINT PRIMARY KEY AUTO_INCREMENT,\n    user_id BIGINT NOT NULL,\n    total_amount DECIMAL(10,2) NOT NULL,\n    status ENUM('pending', 'paid', 'shipped', 'completed') DEFAULT 'pending',\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id)\n);\n\n-- \u5185\u8fde\u63a5\nSELECT u.username, o.id as order_id, o.total_amount\nFROM users u\nINNER JOIN orders o ON u.id = o.user_id;\n\n-- \u5de6\u8fde\u63a5\uff08\u5305\u542b\u6ca1\u6709\u8ba2\u5355\u7684\u7528\u6237\uff09\nSELECT u.username, COUNT(o.id) as order_count\nFROM users u\nLEFT JOIN orders o ON u.id = o.user_id\nGROUP BY u.id, u.username;\n\n-- \u53f3\u8fde\u63a5\nSELECT u.username, o.id as order_id\nFROM users u\nRIGHT JOIN orders o ON u.id = o.user_id;\n\n-- \u81ea\u8fde\u63a5\uff08\u67e5\u627e\u540c\u9f84\u7528\u6237\uff09\nSELECT u1.username as user1, u2.username as user2, u1.age\nFROM users u1\nJOIN users u2 ON u1.age = u2.age AND u1.id < u2.id;\n"})}),"\n",(0,E.jsx)(n.h3,{id:"\u5b50\u67e5\u8be2",children:"\u5b50\u67e5\u8be2"}),"\n",(0,E.jsx)(n.pre,{children:(0,E.jsx)(n.code,{className:"language-sql",children:"-- WHERE\u5b50\u67e5\u8be2\nSELECT username FROM users\nWHERE id IN (\n    SELECT user_id FROM orders WHERE total_amount > 1000\n);\n\n-- FROM\u5b50\u67e5\u8be2\nSELECT avg_age FROM (\n    SELECT AVG(age) as avg_age FROM users GROUP BY gender\n) t;\n\n-- EXISTS\u5b50\u67e5\u8be2\nSELECT username FROM users u\nWHERE EXISTS (\n    SELECT 1 FROM orders o WHERE o.user_id = u.id\n);\n\n-- \u6807\u91cf\u5b50\u67e5\u8be2\nSELECT username, age,\n    (SELECT AVG(age) FROM users) as avg_age\nFROM users;\n"})}),"\n",(0,E.jsx)(n.h3,{id:"\u7a97\u53e3\u51fd\u6570mysql-80",children:"\u7a97\u53e3\u51fd\u6570\uff08MySQL 8.0+\uff09"}),"\n",(0,E.jsx)(n.pre,{children:(0,E.jsx)(n.code,{className:"language-sql",children:"-- ROW_NUMBER\uff1a\u6392\u540d\nSELECT \n    username,\n    age,\n    ROW_NUMBER() OVER (ORDER BY age DESC) as rank\nFROM users;\n\n-- RANK\uff1a\u6392\u540d\uff08\u5141\u8bb8\u5e76\u5217\uff09\nSELECT \n    username,\n    age,\n    RANK() OVER (ORDER BY age DESC) as rank\nFROM users;\n\n-- \u5206\u7ec4\u6392\u540d\nSELECT \n    username,\n    gender,\n    age,\n    ROW_NUMBER() OVER (PARTITION BY gender ORDER BY age DESC) as rank_in_gender\nFROM users;\n\n-- LAG/LEAD\uff1a\u8bbf\u95ee\u524d\u540e\u884c\nSELECT \n    username,\n    age,\n    LAG(age, 1) OVER (ORDER BY age) as prev_age,\n    LEAD(age, 1) OVER (ORDER BY age) as next_age\nFROM users;\n\n-- \u7d2f\u8ba1\u548c\nSELECT \n    username,\n    age,\n    SUM(age) OVER (ORDER BY id ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) as cumsum\nFROM users;\n"})}),"\n",(0,E.jsx)(n.h3,{id:"cte\u516c\u5171\u8868\u8868\u8fbe\u5f0f",children:"CTE\uff08\u516c\u5171\u8868\u8868\u8fbe\u5f0f\uff09"}),"\n",(0,E.jsx)(n.pre,{children:(0,E.jsx)(n.code,{className:"language-sql",children:"-- \u7b80\u5355CTE\nWITH high_value_users AS (\n    SELECT user_id, SUM(total_amount) as total\n    FROM orders\n    GROUP BY user_id\n    HAVING total > 10000\n)\nSELECT u.username, h.total\nFROM users u\nJOIN high_value_users h ON u.id = h.user_id;\n\n-- \u9012\u5f52CTE\uff08\u7ec4\u7ec7\u67b6\u6784\uff09\nWITH RECURSIVE org_tree AS (\n    -- \u57fa\u7840\u67e5\u8be2\uff1a\u9876\u5c42\n    SELECT id, name, manager_id, 1 as level\n    FROM employees\n    WHERE manager_id IS NULL\n    \n    UNION ALL\n    \n    -- \u9012\u5f52\u67e5\u8be2\uff1a\u4e0b\u7ea7\n    SELECT e.id, e.name, e.manager_id, o.level + 1\n    FROM employees e\n    JOIN org_tree o ON e.manager_id = o.id\n)\nSELECT * FROM org_tree;\n"})}),"\n",(0,E.jsx)(n.h2,{id:"\u7b2c\u56db\u90e8\u5206\u7d22\u5f15\u4f18\u5316",children:"\u7b2c\u56db\u90e8\u5206\uff1a\u7d22\u5f15\u4f18\u5316"}),"\n",(0,E.jsx)(n.h3,{id:"\u7d22\u5f15\u7c7b\u578b",children:"\u7d22\u5f15\u7c7b\u578b"}),"\n",(0,E.jsx)(n.pre,{children:(0,E.jsx)(n.code,{className:"language-sql",children:"-- \u666e\u901a\u7d22\u5f15\nCREATE INDEX idx_username ON users(username);\n\n-- \u552f\u4e00\u7d22\u5f15\nCREATE UNIQUE INDEX idx_email ON users(email);\n\n-- \u590d\u5408\u7d22\u5f15\nCREATE INDEX idx_age_gender ON users(age, gender);\n\n-- \u5168\u6587\u7d22\u5f15\nCREATE FULLTEXT INDEX idx_content ON articles(content);\n\n-- \u67e5\u770b\u7d22\u5f15\nSHOW INDEX FROM users;\n\n-- \u5220\u9664\u7d22\u5f15\nDROP INDEX idx_username ON users;\n"})}),"\n",(0,E.jsx)(n.h3,{id:"\u7d22\u5f15\u539f\u7406",children:"\u7d22\u5f15\u539f\u7406"}),"\n",(0,E.jsx)(n.pre,{children:(0,E.jsx)(n.code,{className:"language-sql",children:"-- B+\u6811\u7d22\u5f15\n-- \u4e3b\u952e\u7d22\u5f15\uff08\u805a\u7c07\u7d22\u5f15\uff09\uff1a\u53f6\u5b50\u8282\u70b9\u5b58\u50a8\u5b8c\u6574\u6570\u636e\n-- \u4e8c\u7ea7\u7d22\u5f15\uff1a\u53f6\u5b50\u8282\u70b9\u5b58\u50a8\u4e3b\u952e\u503c\n\n-- \u67e5\u770b\u6267\u884c\u8ba1\u5212\nEXPLAIN SELECT * FROM users WHERE username = 'alice';\n\n-- \u5f3a\u5236\u4f7f\u7528\u7d22\u5f15\nSELECT * FROM users FORCE INDEX (idx_username) WHERE username = 'alice';\n\n-- \u5ffd\u7565\u7d22\u5f15\nSELECT * FROM users IGNORE INDEX (idx_username) WHERE username = 'alice';\n"})}),"\n",(0,E.jsx)(n.h3,{id:"\u7d22\u5f15\u4f18\u5316\u6280\u5de7",children:"\u7d22\u5f15\u4f18\u5316\u6280\u5de7"}),"\n",(0,E.jsx)(n.pre,{children:(0,E.jsx)(n.code,{className:"language-sql",children:"-- \u2705 \u597d\u7684\u67e5\u8be2\uff1a\u4f7f\u7528\u7d22\u5f15\nSELECT * FROM users WHERE age = 25;\n\n-- \u274c \u574f\u7684\u67e5\u8be2\uff1a\u7d22\u5f15\u5931\u6548\nSELECT * FROM users WHERE age + 1 = 26;  -- \u5728\u5217\u4e0a\u4f7f\u7528\u51fd\u6570\nSELECT * FROM users WHERE age != 25;     -- \u4e0d\u7b49\u4e8e\nSELECT * FROM users WHERE age IS NULL;   -- NULL\u503c\nSELECT * FROM users WHERE username LIKE '%alice';  -- \u524d\u7f00\u6a21\u7cca\n\n-- \u590d\u5408\u7d22\u5f15\u6700\u5de6\u524d\u7f00\u539f\u5219\nCREATE INDEX idx_abc ON table(a, b, c);\n-- \u2705 \u53ef\u4ee5\u4f7f\u7528\u7d22\u5f15\uff1aWHERE a=1, WHERE a=1 AND b=2, WHERE a=1 AND b=2 AND c=3\n-- \u274c \u4e0d\u80fd\u4f7f\u7528\u7d22\u5f15\uff1aWHERE b=2, WHERE c=3, WHERE b=2 AND c=3\n\n-- \u8986\u76d6\u7d22\u5f15\uff1a\u67e5\u8be2\u7684\u5217\u90fd\u5728\u7d22\u5f15\u4e2d\nCREATE INDEX idx_username_email ON users(username, email);\nSELECT username, email FROM users WHERE username = 'alice';  -- \u4e0d\u9700\u8981\u56de\u8868\n"})}),"\n",(0,E.jsx)(n.h2,{id:"\u7b2c\u4e94\u90e8\u5206\u4e8b\u52a1\u548c\u9501",children:"\u7b2c\u4e94\u90e8\u5206\uff1a\u4e8b\u52a1\u548c\u9501"}),"\n",(0,E.jsx)(n.h3,{id:"\u4e8b\u52a1\u57fa\u7840",children:"\u4e8b\u52a1\u57fa\u7840"}),"\n",(0,E.jsx)(n.pre,{children:(0,E.jsx)(n.code,{className:"language-sql",children:"-- \u5f00\u59cb\u4e8b\u52a1\nSTART TRANSACTION;\n\n-- \u6267\u884c\u64cd\u4f5c\nUPDATE accounts SET balance = balance - 100 WHERE id = 1;\nUPDATE accounts SET balance = balance + 100 WHERE id = 2;\n\n-- \u63d0\u4ea4\u4e8b\u52a1\nCOMMIT;\n\n-- \u56de\u6eda\u4e8b\u52a1\nROLLBACK;\n\n-- \u8bbe\u7f6e\u4fdd\u5b58\u70b9\nSAVEPOINT sp1;\n-- \u56de\u6eda\u5230\u4fdd\u5b58\u70b9\nROLLBACK TO sp1;\n"})}),"\n",(0,E.jsx)(n.h3,{id:"\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b",children:"\u4e8b\u52a1\u9694\u79bb\u7ea7\u522b"}),"\n",(0,E.jsx)(n.pre,{children:(0,E.jsx)(n.code,{className:"language-sql",children:"-- \u67e5\u770b\u9694\u79bb\u7ea7\u522b\nSELECT @@transaction_isolation;\n\n-- \u8bbe\u7f6e\u9694\u79bb\u7ea7\u522b\nSET SESSION TRANSACTION ISOLATION LEVEL READ COMMITTED;\n\n-- \u56db\u79cd\u9694\u79bb\u7ea7\u522b\n-- 1. READ UNCOMMITTED\uff1a\u8bfb\u672a\u63d0\u4ea4\uff08\u810f\u8bfb\uff09\n-- 2. READ COMMITTED\uff1a\u8bfb\u5df2\u63d0\u4ea4\uff08\u4e0d\u53ef\u91cd\u590d\u8bfb\uff09\n-- 3. REPEATABLE READ\uff1a\u53ef\u91cd\u590d\u8bfb\uff08\u5e7b\u8bfb\uff09- MySQL\u9ed8\u8ba4\n-- 4. SERIALIZABLE\uff1a\u4e32\u884c\u5316\uff08\u6700\u9ad8\u7ea7\u522b\uff09\n"})}),"\n",(0,E.jsx)(n.h3,{id:"\u9501\u673a\u5236",children:"\u9501\u673a\u5236"}),"\n",(0,E.jsx)(n.pre,{children:(0,E.jsx)(n.code,{className:"language-sql",children:"-- \u5171\u4eab\u9501\uff08S\u9501\uff09\uff1a\u8bfb\u9501\nSELECT * FROM users WHERE id = 1 LOCK IN SHARE MODE;\n\n-- \u6392\u4ed6\u9501\uff08X\u9501\uff09\uff1a\u5199\u9501\nSELECT * FROM users WHERE id = 1 FOR UPDATE;\n\n-- \u8868\u9501\nLOCK TABLES users READ;\nUNLOCK TABLES;\n\n-- \u67e5\u770b\u9501\nSHOW OPEN TABLES WHERE In_use > 0;\nSELECT * FROM information_schema.innodb_locks;\n"})}),"\n",(0,E.jsx)(n.h2,{id:"\u7b2c\u516d\u90e8\u5206\u6027\u80fd\u4f18\u5316",children:"\u7b2c\u516d\u90e8\u5206\uff1a\u6027\u80fd\u4f18\u5316"}),"\n",(0,E.jsx)(n.h3,{id:"\u6162\u67e5\u8be2\u5206\u6790",children:"\u6162\u67e5\u8be2\u5206\u6790"}),"\n",(0,E.jsx)(n.pre,{children:(0,E.jsx)(n.code,{className:"language-sql",children:"-- \u5f00\u542f\u6162\u67e5\u8be2\u65e5\u5fd7\nSET GLOBAL slow_query_log = 'ON';\nSET GLOBAL long_query_time = 2;  -- \u8d85\u8fc72\u79d2\u7684\u67e5\u8be2\n\n-- \u67e5\u770b\u6162\u67e5\u8be2\nSHOW VARIABLES LIKE 'slow_query%';\n\n-- \u5206\u6790\u6162\u67e5\u8be2\n-- \u4f7f\u7528mysqldumpslow\u5de5\u5177\n"})}),"\n",(0,E.jsx)(n.h3,{id:"\u67e5\u8be2\u4f18\u5316",children:"\u67e5\u8be2\u4f18\u5316"}),"\n",(0,E.jsx)(n.pre,{children:(0,E.jsx)(n.code,{className:"language-python",children:'import mysql.connector\nimport time\n\nclass QueryOptimizer:\n    """\u67e5\u8be2\u4f18\u5316\u793a\u4f8b"""\n    \n    def __init__(self):\n        self.conn = mysql.connector.connect(\n            host=\'localhost\',\n            user=\'root\',\n            password=\'password\',\n            database=\'ecommerce\'\n        )\n        self.cursor = self.conn.cursor()\n    \n    def bad_query(self):\n        """\u274c \u574f\u7684\u67e5\u8be2\uff1aN+1\u95ee\u9898"""\n        start = time.time()\n        \n        # \u67e5\u8be2\u6240\u6709\u7528\u6237\n        self.cursor.execute("SELECT id, username FROM users LIMIT 100")\n        users = self.cursor.fetchall()\n        \n        # \u4e3a\u6bcf\u4e2a\u7528\u6237\u67e5\u8be2\u8ba2\u5355\uff08N+1\u6b21\u67e5\u8be2\uff09\n        for user_id, username in users:\n            self.cursor.execute(\n                "SELECT COUNT(*) FROM orders WHERE user_id = %s",\n                (user_id,)\n            )\n            count = self.cursor.fetchone()[0]\n            print(f"{username}: {count} orders")\n        \n        print(f"\u8017\u65f6: {time.time() - start:.2f}\u79d2")\n    \n    def good_query(self):\n        """\u2705 \u597d\u7684\u67e5\u8be2\uff1aJOIN\u4e00\u6b21\u67e5\u8be2"""\n        start = time.time()\n        \n        self.cursor.execute("""\n            SELECT u.username, COUNT(o.id) as order_count\n            FROM users u\n            LEFT JOIN orders o ON u.id = o.user_id\n            WHERE u.id <= 100\n            GROUP BY u.id, u.username\n        """)\n        \n        for username, count in self.cursor.fetchall():\n            print(f"{username}: {count} orders")\n        \n        print(f"\u8017\u65f6: {time.time() - start:.2f}\u79d2")\n    \n    def use_index(self):\n        """\u4f7f\u7528\u7d22\u5f15\u4f18\u5316"""\n        # \u274c \u574f\uff1a\u5168\u8868\u626b\u63cf\n        self.cursor.execute("SELECT * FROM users WHERE age > 25")\n        \n        # \u2705 \u597d\uff1a\u4f7f\u7528\u7d22\u5f15\n        self.cursor.execute("SELECT * FROM users WHERE age = 25")\n    \n    def batch_insert(self):\n        """\u6279\u91cf\u63d2\u5165\u4f18\u5316"""\n        # \u274c \u574f\uff1a\u9010\u6761\u63d2\u5165\n        start = time.time()\n        for i in range(1000):\n            self.cursor.execute(\n                "INSERT INTO users (username, email, password) VALUES (%s, %s, %s)",\n                (f\'user{i}\', f\'user{i}@example.com\', \'password\')\n            )\n        self.conn.commit()\n        print(f"\u9010\u6761\u63d2\u5165\u8017\u65f6: {time.time() - start:.2f}\u79d2")\n        \n        # \u2705 \u597d\uff1a\u6279\u91cf\u63d2\u5165\n        start = time.time()\n        values = [(f\'user{i}\', f\'user{i}@example.com\', \'password\') for i in range(1000)]\n        self.cursor.executemany(\n            "INSERT INTO users (username, email, password) VALUES (%s, %s, %s)",\n            values\n        )\n        self.conn.commit()\n        print(f"\u6279\u91cf\u63d2\u5165\u8017\u65f6: {time.time() - start:.2f}\u79d2")\n'})}),"\n",(0,E.jsx)(n.h3,{id:"\u8868\u8bbe\u8ba1\u4f18\u5316",children:"\u8868\u8bbe\u8ba1\u4f18\u5316"}),"\n",(0,E.jsx)(n.pre,{children:(0,E.jsx)(n.code,{className:"language-sql",children:"-- 1. \u9009\u62e9\u5408\u9002\u7684\u6570\u636e\u7c7b\u578b\n-- \u274c \u574f\nCREATE TABLE bad_table (\n    id VARCHAR(255),  -- \u5e94\u8be5\u7528BIGINT\n    age VARCHAR(10),  -- \u5e94\u8be5\u7528TINYINT\n    price VARCHAR(20) -- \u5e94\u8be5\u7528DECIMAL\n);\n\n-- \u2705 \u597d\nCREATE TABLE good_table (\n    id BIGINT PRIMARY KEY AUTO_INCREMENT,\n    age TINYINT UNSIGNED,\n    price DECIMAL(10,2)\n);\n\n-- 2. \u907f\u514dNULL\u503c\nCREATE TABLE products (\n    id BIGINT PRIMARY KEY,\n    name VARCHAR(100) NOT NULL DEFAULT '',\n    stock INT NOT NULL DEFAULT 0\n);\n\n-- 3. \u4f7f\u7528ENUM\u4ee3\u66ff\u5b57\u7b26\u4e32\nCREATE TABLE orders (\n    id BIGINT PRIMARY KEY,\n    status ENUM('pending', 'paid', 'shipped', 'completed') NOT NULL\n);\n"})}),"\n",(0,E.jsx)(n.h2,{id:"\u7b2c\u4e03\u90e8\u5206\u5b9e\u6218\u9879\u76ee",children:"\u7b2c\u4e03\u90e8\u5206\uff1a\u5b9e\u6218\u9879\u76ee"}),"\n",(0,E.jsx)(n.h3,{id:"\u9879\u76ee\u7535\u5546\u6570\u636e\u5e93\u8bbe\u8ba1",children:"\u9879\u76ee\uff1a\u7535\u5546\u6570\u636e\u5e93\u8bbe\u8ba1"}),"\n",(0,E.jsx)(n.pre,{children:(0,E.jsx)(n.code,{className:"language-sql",children:"-- \u7528\u6237\u8868\nCREATE TABLE users (\n    id BIGINT PRIMARY KEY AUTO_INCREMENT,\n    username VARCHAR(50) NOT NULL UNIQUE,\n    email VARCHAR(100) NOT NULL UNIQUE,\n    password VARCHAR(255) NOT NULL,\n    phone VARCHAR(20),\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    INDEX idx_email (email)\n) ENGINE=InnoDB;\n\n-- \u5546\u54c1\u8868\nCREATE TABLE products (\n    id BIGINT PRIMARY KEY AUTO_INCREMENT,\n    name VARCHAR(200) NOT NULL,\n    description TEXT,\n    price DECIMAL(10,2) NOT NULL,\n    stock INT NOT NULL DEFAULT 0,\n    category_id BIGINT,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    INDEX idx_category (category_id),\n    INDEX idx_price (price)\n) ENGINE=InnoDB;\n\n-- \u8ba2\u5355\u8868\nCREATE TABLE orders (\n    id BIGINT PRIMARY KEY AUTO_INCREMENT,\n    user_id BIGINT NOT NULL,\n    total_amount DECIMAL(10,2) NOT NULL,\n    status ENUM('pending', 'paid', 'shipped', 'completed', 'cancelled') DEFAULT 'pending',\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    FOREIGN KEY (user_id) REFERENCES users(id),\n    INDEX idx_user (user_id),\n    INDEX idx_status (status),\n    INDEX idx_created (created_at)\n) ENGINE=InnoDB;\n\n-- \u8ba2\u5355\u660e\u7ec6\u8868\nCREATE TABLE order_items (\n    id BIGINT PRIMARY KEY AUTO_INCREMENT,\n    order_id BIGINT NOT NULL,\n    product_id BIGINT NOT NULL,\n    quantity INT NOT NULL,\n    price DECIMAL(10,2) NOT NULL,\n    FOREIGN KEY (order_id) REFERENCES orders(id),\n    FOREIGN KEY (product_id) REFERENCES products(id),\n    INDEX idx_order (order_id),\n    INDEX idx_product (product_id)\n) ENGINE=InnoDB;\n\n-- \u8d2d\u7269\u8f66\u8868\nCREATE TABLE cart (\n    id BIGINT PRIMARY KEY AUTO_INCREMENT,\n    user_id BIGINT NOT NULL,\n    product_id BIGINT NOT NULL,\n    quantity INT NOT NULL DEFAULT 1,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    UNIQUE KEY uk_user_product (user_id, product_id),\n    FOREIGN KEY (user_id) REFERENCES users(id),\n    FOREIGN KEY (product_id) REFERENCES products(id)\n) ENGINE=InnoDB;\n\n-- \u5e38\u7528\u67e5\u8be2\n\n-- 1. \u7528\u6237\u8ba2\u5355\u7edf\u8ba1\nSELECT \n    u.username,\n    COUNT(o.id) as order_count,\n    SUM(o.total_amount) as total_spent\nFROM users u\nLEFT JOIN orders o ON u.id = o.user_id\nGROUP BY u.id, u.username\nORDER BY total_spent DESC\nLIMIT 10;\n\n-- 2. \u70ed\u95e8\u5546\u54c1\nSELECT \n    p.name,\n    SUM(oi.quantity) as total_sold,\n    SUM(oi.quantity * oi.price) as revenue\nFROM products p\nJOIN order_items oi ON p.id = oi.product_id\nJOIN orders o ON oi.order_id = o.id\nWHERE o.status = 'completed'\nGROUP BY p.id, p.name\nORDER BY total_sold DESC\nLIMIT 20;\n\n-- 3. \u7528\u6237\u8d2d\u4e70\u884c\u4e3a\u5206\u6790\nWITH user_orders AS (\n    SELECT \n        user_id,\n        COUNT(*) as order_count,\n        SUM(total_amount) as total_amount,\n        MAX(created_at) as last_order_date\n    FROM orders\n    WHERE status = 'completed'\n    GROUP BY user_id\n)\nSELECT \n    u.username,\n    uo.order_count,\n    uo.total_amount,\n    uo.last_order_date,\n    DATEDIFF(NOW(), uo.last_order_date) as days_since_last_order\nFROM users u\nJOIN user_orders uo ON u.id = uo.user_id\nORDER BY uo.total_amount DESC;\n"})}),"\n",(0,E.jsx)(n.h2,{id:"\u603b\u7ed3",children:"\u603b\u7ed3"}),"\n",(0,E.jsx)(n.p,{children:"MySQL\u662f\u5f3a\u5927\u7684\u5173\u7cfb\u578b\u6570\u636e\u5e93\uff1a"}),"\n",(0,E.jsxs)(n.ol,{children:["\n",(0,E.jsxs)(n.li,{children:[(0,E.jsx)(n.strong,{children:"ACID\u4e8b\u52a1"}),"\uff1a\u4fdd\u8bc1\u6570\u636e\u4e00\u81f4\u6027"]}),"\n",(0,E.jsxs)(n.li,{children:[(0,E.jsx)(n.strong,{children:"\u4e30\u5bcc\u7d22\u5f15"}),"\uff1aB+\u6811\u3001\u5168\u6587\u7d22\u5f15"]}),"\n",(0,E.jsxs)(n.li,{children:[(0,E.jsx)(n.strong,{children:"\u9ad8\u6027\u80fd"}),"\uff1a\u67e5\u8be2\u4f18\u5316\u3001\u7f13\u5b58"]}),"\n",(0,E.jsxs)(n.li,{children:[(0,E.jsx)(n.strong,{children:"\u6613\u7528\u6027"}),"\uff1a\u6807\u51c6SQL\u3001\u5de5\u5177\u4e30\u5bcc"]}),"\n"]}),"\n",(0,E.jsxs)(n.p,{children:["\u8bb0\u4f4f\uff1a",(0,E.jsx)(n.strong,{children:"\u597d\u7684\u6570\u636e\u5e93\u8bbe\u8ba1\u662f\u6027\u80fd\u7684\u57fa\u7840"}),"\uff01"]}),"\n",(0,E.jsx)(n.h2,{id:"\u7ec3\u4e60\u9898",children:"\u7ec3\u4e60\u9898"}),"\n",(0,E.jsxs)(n.ol,{children:["\n",(0,E.jsx)(n.li,{children:"\u8bbe\u8ba1\u4e00\u4e2a\u535a\u5ba2\u7cfb\u7edf\u7684\u6570\u636e\u5e93"}),"\n",(0,E.jsx)(n.li,{children:"\u4f18\u5316\u6162\u67e5\u8be2"}),"\n",(0,E.jsx)(n.li,{children:"\u5b9e\u73b0\u5206\u5e93\u5206\u8868"}),"\n",(0,E.jsx)(n.li,{children:"\u642d\u5efa\u4e3b\u4ece\u590d\u5236"}),"\n"]}),"\n",(0,E.jsxs)(n.p,{children:["\u4e0b\u4e00\u7ae0\uff1a",(0,E.jsx)(n.a,{href:"/weuqiangcreate_website/docs/%E6%95%B0%E6%8D%AE%E5%BA%93/mongodb",children:"MongoDB\u6587\u6863\u6570\u636e\u5e93"})]})]})}function c(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,E.jsx)(n,{...e,children:(0,E.jsx)(o,{...e})}):o(e)}},28453(e,n,s){s.d(n,{R:()=>d,x:()=>i});var r=s(96540);const E={},a=r.createContext(E);function d(e){const n=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(E):e.components||E:d(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);