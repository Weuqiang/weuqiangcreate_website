---
sidebar_position: 1
title: å‰ç«¯é¢è¯•é¢˜ç²¾é€‰
tags: [é¢è¯•, å‰ç«¯, JavaScript, Vue, React]
---

# å‰ç«¯é¢è¯•é¢˜ç²¾é€‰

æœ¬æ–‡ç²¾é€‰å‰ç«¯é«˜é¢‘é¢è¯•é¢˜ï¼Œæ¶µç›–JavaScriptã€Vueã€Reactç­‰æ ¸å¿ƒçŸ¥è¯†ç‚¹ã€‚

## JavaScriptåŸºç¡€

### 1. æ•°æ®ç±»å‹

```javascript
// åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆ7ç§ï¼‰
const types = {
  number: 42,
  string: 'hello',
  boolean: true,
  undefined: undefined,
  null: null,
  symbol: Symbol('id'),
  bigint: 9007199254740991n
};

// å¼•ç”¨æ•°æ®ç±»å‹
const reference = {
  object: {},
  array: [],
  function: function() {},
  date: new Date(),
  regexp: /pattern/
};

// ç±»å‹æ£€æµ‹
console.log(typeof 42);              // 'number'
console.log(typeof 'hello');         // 'string'
console.log(typeof true);            // 'boolean'
console.log(typeof undefined);       // 'undefined'
console.log(typeof null);            // 'object' (å†å²é—ç•™bug)
console.log(typeof Symbol('id'));    // 'symbol'
console.log(typeof 42n);             // 'bigint'

// ç²¾ç¡®ç±»å‹æ£€æµ‹
function getType(value) {
  return Object.prototype.toString.call(value).slice(8, -1);
}

console.log(getType(null));          // 'Null'
console.log(getType([]));            // 'Array'
console.log(getType(new Date()));    // 'Date'
```

### 2. é—­åŒ…

```javascript
/**
 * é—­åŒ…ï¼šå‡½æ•°èƒ½å¤Ÿè®¿é—®å…¶å¤–éƒ¨ä½œç”¨åŸŸçš„å˜é‡
 */

// åŸºç¡€é—­åŒ…
function createCounter() {
  let count = 0;
  
  return {
    increment() {
      return ++count;
    },
    decrement() {
      return --count;
    },
    getCount() {
      return count;
    }
  };
}

const counter = createCounter();
console.log(counter.increment()); // 1
console.log(counter.increment()); // 2
console.log(counter.getCount());  // 2

// é—­åŒ…é™·é˜±
for (var i = 0; i < 5; i++) {
  setTimeout(() => console.log(i), 1000); // è¾“å‡º5ä¸ª5
}

// è§£å†³æ–¹æ¡ˆ1ï¼šä½¿ç”¨let
for (let i = 0; i < 5; i++) {
  setTimeout(() => console.log(i), 1000); // è¾“å‡º0,1,2,3,4
}

// è§£å†³æ–¹æ¡ˆ2ï¼šä½¿ç”¨é—­åŒ…
for (var i = 0; i < 5; i++) {
  (function(j) {
    setTimeout(() => console.log(j), 1000);
  })(i);
}

// é—­åŒ…åº”ç”¨ï¼šæ¨¡å—åŒ–
const Module = (function() {
  let privateVar = 'private';
  
  function privateMethod() {
    console.log(privateVar);
  }
  
  return {
    publicMethod() {
      privateMethod();
    }
  };
})();
```

### 3. åŸå‹ä¸åŸå‹é“¾

```javascript
/**
 * åŸå‹é“¾ï¼šå¯¹è±¡é€šè¿‡__proto__è¿æ¥åˆ°åŸå‹å¯¹è±¡
 */

// æ„é€ å‡½æ•°
function Person(name) {
  this.name = name;
}

Person.prototype.sayHello = function() {
  console.log(`Hello, I'm ${this.name}`);
};

const person = new Person('John');

// åŸå‹é“¾
console.log(person.__proto__ === Person.prototype);           // true
console.log(Person.prototype.__proto__ === Object.prototype); // true
console.log(Object.prototype.__proto__);                      // null

// instanceofåŸç†
function myInstanceof(obj, constructor) {
  let proto = obj.__proto__;
  
  while (proto) {
    if (proto === constructor.prototype) {
      return true;
    }
    proto = proto.__proto__;
  }
  
  return false;
}

// ç»§æ‰¿
// 1. åŸå‹é“¾ç»§æ‰¿
function Parent() {
  this.name = 'parent';
}

function Child() {}
Child.prototype = new Parent();

// 2. æ„é€ å‡½æ•°ç»§æ‰¿
function Child() {
  Parent.call(this);
}

// 3. ç»„åˆç»§æ‰¿
function Child(name) {
  Parent.call(this, name);
}
Child.prototype = new Parent();
Child.prototype.constructor = Child;

// 4. å¯„ç”Ÿç»„åˆç»§æ‰¿ï¼ˆæœ€ä¼˜ï¼‰
function Child(name) {
  Parent.call(this, name);
}
Child.prototype = Object.create(Parent.prototype);
Child.prototype.constructor = Child;

// 5. ES6 Class
class Parent {
  constructor(name) {
    this.name = name;
  }
  
  sayHello() {
    console.log(`Hello, I'm ${this.name}`);
  }
}

class Child extends Parent {
  constructor(name, age) {
    super(name);
    this.age = age;
  }
}
```

### 4. thisæŒ‡å‘

```javascript
/**
 * thisçš„æŒ‡å‘å–å†³äºå‡½æ•°çš„è°ƒç”¨æ–¹å¼
 */

// 1. é»˜è®¤ç»‘å®šï¼šæŒ‡å‘å…¨å±€å¯¹è±¡ï¼ˆä¸¥æ ¼æ¨¡å¼ä¸‹ä¸ºundefinedï¼‰
function foo() {
  console.log(this);
}
foo(); // window (æµè§ˆå™¨) æˆ– global (Node.js)

// 2. éšå¼ç»‘å®šï¼šæŒ‡å‘è°ƒç”¨å¯¹è±¡
const obj = {
  name: 'obj',
  foo() {
    console.log(this.name);
  }
};
obj.foo(); // 'obj'

// éšå¼ç»‘å®šä¸¢å¤±
const bar = obj.foo;
bar(); // undefined

// 3. æ˜¾å¼ç»‘å®šï¼šcallã€applyã€bind
function greet(greeting) {
  console.log(`${greeting}, ${this.name}`);
}

const person = { name: 'John' };
greet.call(person, 'Hello');    // 'Hello, John'
greet.apply(person, ['Hi']);    // 'Hi, John'
const boundGreet = greet.bind(person);
boundGreet('Hey');              // 'Hey, John'

// 4. newç»‘å®šï¼šæŒ‡å‘æ–°åˆ›å»ºçš„å¯¹è±¡
function Person(name) {
  this.name = name;
}
const p = new Person('John');
console.log(p.name); // 'John'

// 5. ç®­å¤´å‡½æ•°ï¼šç»§æ‰¿å¤–å±‚ä½œç”¨åŸŸçš„this
const obj2 = {
  name: 'obj2',
  foo: () => {
    console.log(this.name);
  },
  bar() {
    const arrow = () => {
      console.log(this.name);
    };
    arrow();
  }
};
obj2.foo(); // undefined (ç»§æ‰¿å…¨å±€this)
obj2.bar(); // 'obj2' (ç»§æ‰¿barçš„this)

// æ‰‹å†™bind
Function.prototype.myBind = function(context, ...args) {
  const fn = this;
  
  return function(...newArgs) {
    return fn.apply(context, [...args, ...newArgs]);
  };
};
```

### 5. å¼‚æ­¥ç¼–ç¨‹

```javascript
/**
 * Promiseã€async/await
 */

// PromiseåŸºç¡€
const promise = new Promise((resolve, reject) => {
  setTimeout(() => {
    resolve('success');
  }, 1000);
});

promise
  .then(result => console.log(result))
  .catch(error => console.error(error));

// Promiseé“¾å¼è°ƒç”¨
fetch('/api/user')
  .then(response => response.json())
  .then(user => fetch(`/api/posts/${user.id}`))
  .then(response => response.json())
  .then(posts => console.log(posts))
  .catch(error => console.error(error));

// async/await
async function fetchUserPosts() {
  try {
    const userResponse = await fetch('/api/user');
    const user = await userResponse.json();
    
    const postsResponse = await fetch(`/api/posts/${user.id}`);
    const posts = await postsResponse.json();
    
    return posts;
  } catch (error) {
    console.error(error);
  }
}

// å¹¶å‘æ‰§è¡Œ
async function fetchAll() {
  const [users, posts, comments] = await Promise.all([
    fetch('/api/users').then(r => r.json()),
    fetch('/api/posts').then(r => r.json()),
    fetch('/api/comments').then(r => r.json())
  ]);
  
  return { users, posts, comments };
}

// æ‰‹å†™Promise
class MyPromise {
  constructor(executor) {
    this.state = 'pending';
    this.value = undefined;
    this.callbacks = [];
    
    const resolve = (value) => {
      if (this.state === 'pending') {
        this.state = 'fulfilled';
        this.value = value;
        this.callbacks.forEach(cb => cb.onFulfilled(value));
      }
    };
    
    const reject = (reason) => {
      if (this.state === 'pending') {
        this.state = 'rejected';
        this.value = reason;
        this.callbacks.forEach(cb => cb.onRejected(reason));
      }
    };
    
    try {
      executor(resolve, reject);
    } catch (error) {
      reject(error);
    }
  }
  
  then(onFulfilled, onRejected) {
    return new MyPromise((resolve, reject) => {
      const handle = () => {
        if (this.state === 'fulfilled') {
          try {
            const result = onFulfilled(this.value);
            resolve(result);
          } catch (error) {
            reject(error);
          }
        } else if (this.state === 'rejected') {
          try {
            const result = onRejected(this.value);
            resolve(result);
          } catch (error) {
            reject(error);
          }
        }
      };
      
      if (this.state === 'pending') {
        this.callbacks.push({
          onFulfilled: () => handle(),
          onRejected: () => handle()
        });
      } else {
        handle();
      }
    });
  }
}
```

## Vueé¢è¯•é¢˜

### 1. å“åº”å¼åŸç†

```javascript
/**
 * Vue2ï¼šObject.defineProperty
 * Vue3ï¼šProxy
 */

// Vue2å“åº”å¼å®ç°
function defineReactive(obj, key, val) {
  const dep = new Dep();
  
  Object.defineProperty(obj, key, {
    get() {
      if (Dep.target) {
        dep.depend();
      }
      return val;
    },
    set(newVal) {
      if (newVal !== val) {
        val = newVal;
        dep.notify();
      }
    }
  });
}

class Dep {
  constructor() {
    this.subs = [];
  }
  
  depend() {
    if (Dep.target) {
      this.subs.push(Dep.target);
    }
  }
  
  notify() {
    this.subs.forEach(sub => sub.update());
  }
}

// Vue3å“åº”å¼å®ç°
function reactive(obj) {
  return new Proxy(obj, {
    get(target, key) {
      track(target, key);
      return target[key];
    },
    set(target, key, value) {
      target[key] = value;
      trigger(target, key);
      return true;
    }
  });
}

const targetMap = new WeakMap();

function track(target, key) {
  if (!activeEffect) return;
  
  let depsMap = targetMap.get(target);
  if (!depsMap) {
    targetMap.set(target, (depsMap = new Map()));
  }
  
  let dep = depsMap.get(key);
  if (!dep) {
    depsMap.set(key, (dep = new Set()));
  }
  
  dep.add(activeEffect);
}

function trigger(target, key) {
  const depsMap = targetMap.get(target);
  if (!depsMap) return;
  
  const dep = depsMap.get(key);
  if (dep) {
    dep.forEach(effect => effect());
  }
}
```

### 2. è™šæ‹ŸDOMä¸Diffç®—æ³•

```javascript
/**
 * è™šæ‹ŸDOMï¼šç”¨JavaScriptå¯¹è±¡æè¿°DOMç»“æ„
 */

// åˆ›å»ºè™šæ‹ŸèŠ‚ç‚¹
function h(tag, props, children) {
  return {
    tag,
    props,
    children
  };
}

// æ¸²æŸ“è™šæ‹ŸèŠ‚ç‚¹
function render(vnode) {
  if (typeof vnode === 'string') {
    return document.createTextNode(vnode);
  }
  
  const el = document.createElement(vnode.tag);
  
  // è®¾ç½®å±æ€§
  if (vnode.props) {
    for (const [key, value] of Object.entries(vnode.props)) {
      el.setAttribute(key, value);
    }
  }
  
  // æ¸²æŸ“å­èŠ‚ç‚¹
  if (vnode.children) {
    vnode.children.forEach(child => {
      el.appendChild(render(child));
    });
  }
  
  return el;
}

// Diffç®—æ³•ï¼ˆç®€åŒ–ç‰ˆï¼‰
function diff(oldVNode, newVNode) {
  // èŠ‚ç‚¹ç±»å‹ä¸åŒï¼Œç›´æ¥æ›¿æ¢
  if (oldVNode.tag !== newVNode.tag) {
    return { type: 'REPLACE', newVNode };
  }
  
  // æ–‡æœ¬èŠ‚ç‚¹
  if (typeof newVNode === 'string') {
    if (oldVNode !== newVNode) {
      return { type: 'TEXT', text: newVNode };
    }
    return null;
  }
  
  // å¯¹æ¯”å±æ€§
  const propsPatches = diffProps(oldVNode.props, newVNode.props);
  
  // å¯¹æ¯”å­èŠ‚ç‚¹
  const childrenPatches = diffChildren(oldVNode.children, newVNode.children);
  
  return {
    type: 'UPDATE',
    props: propsPatches,
    children: childrenPatches
  };
}
```

### 3. ç»„ä»¶é€šä¿¡

```javascript
/**
 * Vueç»„ä»¶é€šä¿¡æ–¹å¼
 */

// 1. Props / Emit
// Parent.vue
export default {
  template: `
    <Child :message="msg" @update="handleUpdate" />
  `,
  data() {
    return { msg: 'Hello' };
  },
  methods: {
    handleUpdate(newMsg) {
      this.msg = newMsg;
    }
  }
};

// Child.vue
export default {
  props: ['message'],
  methods: {
    updateMessage() {
      this.$emit('update', 'New message');
    }
  }
};

// 2. EventBus
const EventBus = new Vue();

// å‘é€äº‹ä»¶
EventBus.$emit('event-name', data);

// ç›‘å¬äº‹ä»¶
EventBus.$on('event-name', (data) => {
  console.log(data);
});

// 3. Vuex
const store = new Vuex.Store({
  state: {
    count: 0
  },
  mutations: {
    increment(state) {
      state.count++;
    }
  },
  actions: {
    incrementAsync({ commit }) {
      setTimeout(() => {
        commit('increment');
      }, 1000);
    }
  }
});

// 4. Provide / Inject
// Parent.vue
export default {
  provide() {
    return {
      theme: 'dark'
    };
  }
};

// Child.vue
export default {
  inject: ['theme']
};
```

## Reacté¢è¯•é¢˜

### 1. ç”Ÿå‘½å‘¨æœŸ

```javascript
/**
 * Reactç”Ÿå‘½å‘¨æœŸ
 */

class Component extends React.Component {
  // æŒ‚è½½é˜¶æ®µ
  constructor(props) {
    super(props);
    this.state = { count: 0 };
  }
  
  static getDerivedStateFromProps(props, state) {
    // ä»propsæ´¾ç”Ÿstate
    return null;
  }
  
  componentDidMount() {
    // ç»„ä»¶æŒ‚è½½å
    // é€‚åˆå‘é€ç½‘ç»œè¯·æ±‚ã€è®¢é˜…äº‹ä»¶
  }
  
  // æ›´æ–°é˜¶æ®µ
  shouldComponentUpdate(nextProps, nextState) {
    // æ˜¯å¦éœ€è¦æ›´æ–°
    return true;
  }
  
  getSnapshotBeforeUpdate(prevProps, prevState) {
    // æ›´æ–°å‰è·å–å¿«ç…§
    return null;
  }
  
  componentDidUpdate(prevProps, prevState, snapshot) {
    // ç»„ä»¶æ›´æ–°å
  }
  
  // å¸è½½é˜¶æ®µ
  componentWillUnmount() {
    // ç»„ä»¶å¸è½½å‰
    // é€‚åˆæ¸…ç†å®šæ—¶å™¨ã€å–æ¶ˆè®¢é˜…
  }
  
  // é”™è¯¯å¤„ç†
  static getDerivedStateFromError(error) {
    return { hasError: true };
  }
  
  componentDidCatch(error, info) {
    console.error(error, info);
  }
  
  render() {
    return <div>{this.state.count}</div>;
  }
}
```

### 2. Hooks

```javascript
/**
 * React Hooks
 */

// useState
function Counter() {
  const [count, setCount] = useState(0);
  
  return (
    <div>
      <p>{count}</p>
      <button onClick={() => setCount(count + 1)}>+1</button>
    </div>
  );
}

// useEffect
function DataFetcher() {
  const [data, setData] = useState(null);
  
  useEffect(() => {
    fetch('/api/data')
      .then(r => r.json())
      .then(setData);
    
    // æ¸…ç†å‡½æ•°
    return () => {
      // å–æ¶ˆè¯·æ±‚ã€æ¸…ç†è®¢é˜…
    };
  }, []); // ä¾èµ–æ•°ç»„
  
  return <div>{data}</div>;
}

// useContext
const ThemeContext = React.createContext('light');

function ThemedButton() {
  const theme = useContext(ThemeContext);
  return <button className={theme}>Button</button>;
}

// useReducer
function reducer(state, action) {
  switch (action.type) {
    case 'increment':
      return { count: state.count + 1 };
    case 'decrement':
      return { count: state.count - 1 };
    default:
      return state;
  }
}

function Counter() {
  const [state, dispatch] = useReducer(reducer, { count: 0 });
  
  return (
    <div>
      <p>{state.count}</p>
      <button onClick={() => dispatch({ type: 'increment' })}>+</button>
      <button onClick={() => dispatch({ type: 'decrement' })}>-</button>
    </div>
  );
}

// è‡ªå®šä¹‰Hook
function useLocalStorage(key, initialValue) {
  const [value, setValue] = useState(() => {
    const item = localStorage.getItem(key);
    return item ? JSON.parse(item) : initialValue;
  });
  
  useEffect(() => {
    localStorage.setItem(key, JSON.stringify(value));
  }, [key, value]);
  
  return [value, setValue];
}
```

## æ€»ç»“

å‰ç«¯é¢è¯•æ ¸å¿ƒï¼š
- ğŸ”§ **JavaScript**ï¼šé—­åŒ…ã€åŸå‹ã€thisã€å¼‚æ­¥
- ğŸ¨ **Vue**ï¼šå“åº”å¼ã€è™šæ‹ŸDOMã€ç»„ä»¶é€šä¿¡
- âš›ï¸ **React**ï¼šç”Ÿå‘½å‘¨æœŸã€Hooksã€çŠ¶æ€ç®¡ç†
- ğŸŒ **æµè§ˆå™¨**ï¼šäº‹ä»¶å¾ªç¯ã€æ¸²æŸ“æœºåˆ¶
- ğŸš€ **æ€§èƒ½ä¼˜åŒ–**ï¼šæ‡’åŠ è½½ã€é˜²æŠ–èŠ‚æµ
- ğŸ“¦ **å·¥ç¨‹åŒ–**ï¼šWebpackã€Viteã€CI/CD

è®°ä½ï¼š**ç†è§£åŸç†æ¯”è®°ä½APIæ›´é‡è¦ï¼**

