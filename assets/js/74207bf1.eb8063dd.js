"use strict";(globalThis.webpackChunkweuqiangcreate_website=globalThis.webpackChunkweuqiangcreate_website||[]).push([[93844],{10684(n,e,t){t.r(e),t.d(e,{assets:()=>p,contentTitle:()=>o,default:()=>_,frontMatter:()=>l,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"\u6570\u5b66\u57fa\u7840/\u4fe1\u606f\u8bba","title":"\u4fe1\u606f\u8bba - \u8861\u91cf\u4fe1\u606f\u7684\u6570\u5b66","description":"\u4fe1\u606f\u8bba\u544a\u8bc9\u6211\u4eec\u5982\u4f55\u8861\u91cf\u4fe1\u606f\u91cf\u3002\u8fd9\u4e00\u7ae0\u6559\u4f60\u7406\u89e3\u4e3a\u4ec0\u4e48\u5206\u7c7b\u7528\u4ea4\u53c9\u71b5\uff0c\u4e3a\u4ec0\u4e48Transformer\u7528\u6ce8\u610f\u529b\u673a\u5236\u3002","source":"@site/docs/docs/\u6570\u5b66\u57fa\u7840/\u4fe1\u606f\u8bba.mdx","sourceDirName":"\u6570\u5b66\u57fa\u7840","slug":"/\u6570\u5b66\u57fa\u7840/\u4fe1\u606f\u8bba","permalink":"/weuqiangcreate_website/docs/\u6570\u5b66\u57fa\u7840/\u4fe1\u606f\u8bba","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"\u4fe1\u606f\u8bba - \u8861\u91cf\u4fe1\u606f\u7684\u6570\u5b66"},"sidebar":"tutorialSidebar","previous":{"title":"\u5fae\u79ef\u5206\u4e0e\u4f18\u5316 - \u8bad\u7ec3\u795e\u7ecf\u7f51\u7edc\u7684\u6570\u5b66","permalink":"/weuqiangcreate_website/docs/\u6570\u5b66\u57fa\u7840/\u5fae\u79ef\u5206\u4e0e\u4f18\u5316"},"next":{"title":"\u9009\u62e9\u7f16\u7a0b\u8bed\u8a00","permalink":"/weuqiangcreate_website/docs/\u9009\u62e9\u7f16\u7a0b\u8bed\u8a00/"}}');var s=t(74848),i=t(28453);const l={sidebar_position:4,title:"\u4fe1\u606f\u8bba - \u8861\u91cf\u4fe1\u606f\u7684\u6570\u5b66"},o="\u4fe1\u606f\u8bba - AI\u7684\u635f\u5931\u51fd\u6570\u4ece\u54ea\u6765",p={},a=[{value:"\u7b2c\u4e00\u90e8\u5206\uff1a\u71b5 - \u4fe1\u606f\u91cf",id:"\u7b2c\u4e00\u90e8\u5206\u71b5---\u4fe1\u606f\u91cf",level:2},{value:"\u4ec0\u4e48\u662f\u71b5\uff1f",id:"\u4ec0\u4e48\u662f\u71b5",level:3},{value:"AI\u4e2d\u7684\u5e94\u7528\uff1a\u51b3\u7b56\u6811",id:"ai\u4e2d\u7684\u5e94\u7528\u51b3\u7b56\u6811",level:3},{value:"\u7b2c\u4e8c\u90e8\u5206\uff1a\u4ea4\u53c9\u71b5 - \u5206\u7c7b\u635f\u5931\u51fd\u6570",id:"\u7b2c\u4e8c\u90e8\u5206\u4ea4\u53c9\u71b5---\u5206\u7c7b\u635f\u5931\u51fd\u6570",level:2},{value:"\u4ec0\u4e48\u662f\u4ea4\u53c9\u71b5\uff1f",id:"\u4ec0\u4e48\u662f\u4ea4\u53c9\u71b5",level:3},{value:"\u4e3a\u4ec0\u4e48\u5206\u7c7b\u7528\u4ea4\u53c9\u71b5\uff1f",id:"\u4e3a\u4ec0\u4e48\u5206\u7c7b\u7528\u4ea4\u53c9\u71b5",level:3},{value:"\u5b9e\u6218\uff1a\u5b9e\u73b0Softmax + \u4ea4\u53c9\u71b5",id:"\u5b9e\u6218\u5b9e\u73b0softmax--\u4ea4\u53c9\u71b5",level:3},{value:"\u7b2c\u4e09\u90e8\u5206\uff1aKL\u6563\u5ea6 - \u5206\u5e03\u5dee\u5f02",id:"\u7b2c\u4e09\u90e8\u5206kl\u6563\u5ea6---\u5206\u5e03\u5dee\u5f02",level:2},{value:"\u4ec0\u4e48\u662fKL\u6563\u5ea6\uff1f",id:"\u4ec0\u4e48\u662fkl\u6563\u5ea6",level:3},{value:"AI\u4e2d\u7684\u5e94\u7528\uff1aVAE\u635f\u5931\u51fd\u6570",id:"ai\u4e2d\u7684\u5e94\u7528vae\u635f\u5931\u51fd\u6570",level:3},{value:"\u7b2c\u56db\u90e8\u5206\uff1a\u4e92\u4fe1\u606f - \u6ce8\u610f\u529b\u673a\u5236",id:"\u7b2c\u56db\u90e8\u5206\u4e92\u4fe1\u606f---\u6ce8\u610f\u529b\u673a\u5236",level:2},{value:"\u4ec0\u4e48\u662f\u4e92\u4fe1\u606f\uff1f",id:"\u4ec0\u4e48\u662f\u4e92\u4fe1\u606f",level:3},{value:"\u6ce8\u610f\u529b\u673a\u5236\u7684\u4fe1\u606f\u8bba\u89e3\u91ca",id:"\u6ce8\u610f\u529b\u673a\u5236\u7684\u4fe1\u606f\u8bba\u89e3\u91ca",level:3},{value:"\u603b\u7ed3",id:"\u603b\u7ed3",level:2},{value:"\u7ec3\u4e60\u9898",id:"\u7ec3\u4e60\u9898",level:2}];function d(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"\u4fe1\u606f\u8bba---ai\u7684\u635f\u5931\u51fd\u6570\u4ece\u54ea\u6765",children:"\u4fe1\u606f\u8bba - AI\u7684\u635f\u5931\u51fd\u6570\u4ece\u54ea\u6765"})}),"\n",(0,s.jsxs)(e.p,{children:["\u4fe1\u606f\u8bba\u544a\u8bc9\u6211\u4eec",(0,s.jsx)(e.strong,{children:"\u5982\u4f55\u8861\u91cf\u4fe1\u606f\u91cf"}),"\u3002\u8fd9\u4e00\u7ae0\u6559\u4f60\u7406\u89e3\u4e3a\u4ec0\u4e48\u5206\u7c7b\u7528\u4ea4\u53c9\u71b5\uff0c\u4e3a\u4ec0\u4e48Transformer\u7528\u6ce8\u610f\u529b\u673a\u5236\u3002"]}),"\n",(0,s.jsx)(e.h2,{id:"\u7b2c\u4e00\u90e8\u5206\u71b5---\u4fe1\u606f\u91cf",children:"\u7b2c\u4e00\u90e8\u5206\uff1a\u71b5 - \u4fe1\u606f\u91cf"}),"\n",(0,s.jsx)(e.h3,{id:"\u4ec0\u4e48\u662f\u71b5",children:"\u4ec0\u4e48\u662f\u71b5\uff1f"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u71b5\u662f\u4e0d\u786e\u5b9a\u6027\u7684\u5ea6\u91cf"}),"\u3002\u8d8a\u4e0d\u786e\u5b9a\uff0c\u71b5\u8d8a\u5927\u3002"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:"import numpy as np\nimport matplotlib.pyplot as plt\n\ndef entropy(p):\n    \"\"\"\u8ba1\u7b97\u71b5\uff1aH(X) = -\u03a3 p(x) * log(p(x))\"\"\"\n    p = np.array(p)\n    p = p[p > 0]  # \u53bb\u96640\u6982\u7387\n    return -np.sum(p * np.log2(p))\n\n# \u4f8b\u5b501\uff1a\u629b\u786c\u5e01\np_fair = [0.5, 0.5]  # \u516c\u5e73\u786c\u5e01\np_biased = [0.9, 0.1]  # \u504f\u5411\u786c\u5e01\np_certain = [1.0, 0.0]  # \u786e\u5b9a\u7ed3\u679c\n\nprint(\"\u516c\u5e73\u786c\u5e01\u71b5:\", entropy(p_fair))  # 1.0 bit\nprint(\"\u504f\u5411\u786c\u5e01\u71b5:\", entropy(p_biased))  # 0.47 bit\nprint(\"\u786e\u5b9a\u7ed3\u679c\u71b5:\", entropy(p_certain))  # 0.0 bit\n\n# \u53ef\u89c6\u5316\uff1a\u71b5\u4e0e\u6982\u7387\u7684\u5173\u7cfb\np_values = np.linspace(0.01, 0.99, 100)\nh_values = [-p * np.log2(p) - (1-p) * np.log2(1-p) for p in p_values]\n\nplt.figure(figsize=(10, 6))\nplt.plot(p_values, h_values, linewidth=2)\nplt.xlabel('\u6982\u7387 p')\nplt.ylabel('\u71b5 H(p)')\nplt.title('\u4e8c\u5143\u71b5\u51fd\u6570')\nplt.grid(True)\nplt.axvline(x=0.5, color='r', linestyle='--', label='\u6700\u5927\u71b5\u70b9')\nplt.legend()\nplt.show()\n"})}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u71b5\u7684\u610f\u4e49"}),"\uff1a"]}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsx)(e.li,{children:"\u71b5 = 0\uff1a\u5b8c\u5168\u786e\u5b9a\uff0c\u6ca1\u6709\u4fe1\u606f"}),"\n",(0,s.jsx)(e.li,{children:"\u71b5 = 1\uff1a\u6700\u4e0d\u786e\u5b9a\uff0c\u4fe1\u606f\u91cf\u6700\u5927"}),"\n",(0,s.jsx)(e.li,{children:"\u71b5\u8d8a\u5927\uff0c\u8d8a\u96be\u9884\u6d4b"}),"\n"]}),"\n",(0,s.jsx)(e.h3,{id:"ai\u4e2d\u7684\u5e94\u7528\u51b3\u7b56\u6811",children:"AI\u4e2d\u7684\u5e94\u7528\uff1a\u51b3\u7b56\u6811"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:'class DecisionTree:\n    """\u57fa\u4e8e\u4fe1\u606f\u589e\u76ca\u7684\u51b3\u7b56\u6811"""\n    \n    def __init__(self, max_depth=3):\n        self.max_depth = max_depth\n    \n    def entropy(self, y):\n        """\u8ba1\u7b97\u71b5"""\n        _, counts = np.unique(y, return_counts=True)\n        probs = counts / len(y)\n        return -np.sum(probs * np.log2(probs + 1e-10))\n    \n    def information_gain(self, X, y, feature_idx, threshold):\n        """\u8ba1\u7b97\u4fe1\u606f\u589e\u76ca"""\n        # \u7236\u8282\u70b9\u71b5\n        parent_entropy = self.entropy(y)\n        \n        # \u5206\u88c2\n        left_mask = X[:, feature_idx] <= threshold\n        right_mask = ~left_mask\n        \n        if np.sum(left_mask) == 0 or np.sum(right_mask) == 0:\n            return 0\n        \n        # \u5b50\u8282\u70b9\u71b5\n        n = len(y)\n        left_entropy = self.entropy(y[left_mask])\n        right_entropy = self.entropy(y[right_mask])\n        \n        # \u52a0\u6743\u5e73\u5747\n        child_entropy = (np.sum(left_mask) / n * left_entropy +\n                        np.sum(right_mask) / n * right_entropy)\n        \n        # \u4fe1\u606f\u589e\u76ca\n        return parent_entropy - child_entropy\n    \n    def find_best_split(self, X, y):\n        """\u627e\u6700\u4f73\u5206\u88c2\u70b9"""\n        best_gain = 0\n        best_feature = None\n        best_threshold = None\n        \n        for feature_idx in range(X.shape[1]):\n            thresholds = np.unique(X[:, feature_idx])\n            \n            for threshold in thresholds:\n                gain = self.information_gain(X, y, feature_idx, threshold)\n                \n                if gain > best_gain:\n                    best_gain = gain\n                    best_feature = feature_idx\n                    best_threshold = threshold\n        \n        return best_feature, best_threshold, best_gain\n\n# \u6d4b\u8bd5\nfrom sklearn.datasets import load_iris\niris = load_iris()\nX, y = iris.data, iris.target\n\ntree = DecisionTree()\nfeature, threshold, gain = tree.find_best_split(X, y)\n\nprint(f"\u6700\u4f73\u5206\u88c2\u7279\u5f81: {iris.feature_names[feature]}")\nprint(f"\u6700\u4f73\u9608\u503c: {threshold:.2f}")\nprint(f"\u4fe1\u606f\u589e\u76ca: {gain:.4f}")\n'})}),"\n",(0,s.jsx)(e.h2,{id:"\u7b2c\u4e8c\u90e8\u5206\u4ea4\u53c9\u71b5---\u5206\u7c7b\u635f\u5931\u51fd\u6570",children:"\u7b2c\u4e8c\u90e8\u5206\uff1a\u4ea4\u53c9\u71b5 - \u5206\u7c7b\u635f\u5931\u51fd\u6570"}),"\n",(0,s.jsx)(e.h3,{id:"\u4ec0\u4e48\u662f\u4ea4\u53c9\u71b5",children:"\u4ec0\u4e48\u662f\u4ea4\u53c9\u71b5\uff1f"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u4ea4\u53c9\u71b5\u8861\u91cf\u4e24\u4e2a\u6982\u7387\u5206\u5e03\u7684\u5dee\u5f02"}),"\u3002"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:'def cross_entropy(y_true, y_pred):\n    """\u4ea4\u53c9\u71b5\uff1aH(p, q) = -\u03a3 p(x) * log(q(x))"""\n    y_pred = np.clip(y_pred, 1e-10, 1 - 1e-10)  # \u907f\u514dlog(0)\n    return -np.sum(y_true * np.log(y_pred))\n\n# \u4f8b\u5b50\uff1a\u5206\u7c7b\u95ee\u9898\ny_true = np.array([0, 0, 1])  # \u771f\u5b9e\u6807\u7b7e\uff1a\u7c7b\u522b2\ny_pred1 = np.array([0.1, 0.2, 0.7])  # \u9884\u6d4b1\uff1a\u63a5\u8fd1\u771f\u5b9e\ny_pred2 = np.array([0.4, 0.4, 0.2])  # \u9884\u6d4b2\uff1a\u8fdc\u79bb\u771f\u5b9e\n\nprint("\u9884\u6d4b1\u7684\u4ea4\u53c9\u71b5:", cross_entropy(y_true, y_pred1))  # 0.36\nprint("\u9884\u6d4b2\u7684\u4ea4\u53c9\u71b5:", cross_entropy(y_true, y_pred2))  # 1.61\n\n# \u53ef\u89c6\u5316\npred_probs = np.linspace(0.01, 0.99, 100)\nce_values = [-np.log(p) for p in pred_probs]\n\nplt.figure(figsize=(10, 6))\nplt.plot(pred_probs, ce_values, linewidth=2)\nplt.xlabel(\'\u9884\u6d4b\u6982\u7387\')\nplt.ylabel(\'\u4ea4\u53c9\u71b5\u635f\u5931\')\nplt.title(\'\u4ea4\u53c9\u71b5\u635f\u5931\u51fd\u6570\')\nplt.grid(True)\nplt.show()\n'})}),"\n",(0,s.jsx)(e.h3,{id:"\u4e3a\u4ec0\u4e48\u5206\u7c7b\u7528\u4ea4\u53c9\u71b5",children:"\u4e3a\u4ec0\u4e48\u5206\u7c7b\u7528\u4ea4\u53c9\u71b5\uff1f"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:'# \u5bf9\u6bd4\u4e0d\u540c\u635f\u5931\u51fd\u6570\ndef mse_loss(y_true, y_pred):\n    """\u5747\u65b9\u8bef\u5dee"""\n    return np.mean((y_true - y_pred) ** 2)\n\ndef cross_entropy_loss(y_true, y_pred):\n    """\u4ea4\u53c9\u71b5"""\n    y_pred = np.clip(y_pred, 1e-10, 1 - 1e-10)\n    return -np.mean(y_true * np.log(y_pred))\n\n# \u771f\u5b9e\u6807\u7b7e\ny_true = np.array([1, 0])  # \u7c7b\u522b0\n\n# \u4e0d\u540c\u9884\u6d4b\npredictions = np.linspace(0.01, 0.99, 100)\nmse_losses = [mse_loss(y_true, np.array([p, 1-p])) for p in predictions]\nce_losses = [cross_entropy_loss(y_true, np.array([p, 1-p])) for p in predictions]\n\nplt.figure(figsize=(12, 5))\n\nplt.subplot(1, 2, 1)\nplt.plot(predictions, mse_losses, label=\'MSE\', linewidth=2)\nplt.xlabel(\'\u9884\u6d4b\u6982\u7387\')\nplt.ylabel(\'\u635f\u5931\')\nplt.title(\'\u5747\u65b9\u8bef\u5dee\')\nplt.grid(True)\nplt.legend()\n\nplt.subplot(1, 2, 2)\nplt.plot(predictions, ce_losses, label=\'Cross Entropy\', linewidth=2, color=\'orange\')\nplt.xlabel(\'\u9884\u6d4b\u6982\u7387\')\nplt.ylabel(\'\u635f\u5931\')\nplt.title(\'\u4ea4\u53c9\u71b5\')\nplt.grid(True)\nplt.legend()\n\nplt.tight_layout()\nplt.show()\n\nprint("\u4ea4\u53c9\u71b5\u7684\u4f18\u52bf\uff1a")\nprint("1. \u68af\u5ea6\u66f4\u5927\uff0c\u8bad\u7ec3\u66f4\u5feb")\nprint("2. \u6982\u7387\u89e3\u91ca\u66f4\u81ea\u7136")\nprint("3. \u60e9\u7f5a\u9519\u8bef\u9884\u6d4b\u66f4\u4e25\u5389")\n'})}),"\n",(0,s.jsx)(e.h3,{id:"\u5b9e\u6218\u5b9e\u73b0softmax--\u4ea4\u53c9\u71b5",children:"\u5b9e\u6218\uff1a\u5b9e\u73b0Softmax + \u4ea4\u53c9\u71b5"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:'class SoftmaxCrossEntropy:\n    """Softmax + \u4ea4\u53c9\u71b5"""\n    \n    @staticmethod\n    def softmax(x):\n        """Softmax\u51fd\u6570"""\n        exp_x = np.exp(x - np.max(x, axis=1, keepdims=True))\n        return exp_x / np.sum(exp_x, axis=1, keepdims=True)\n    \n    @staticmethod\n    def forward(logits, labels):\n        """\u524d\u5411\u4f20\u64ad"""\n        probs = SoftmaxCrossEntropy.softmax(logits)\n        \n        # \u4ea4\u53c9\u71b5\n        m = labels.shape[0]\n        log_probs = -np.log(probs[range(m), labels])\n        loss = np.sum(log_probs) / m\n        \n        return loss, probs\n    \n    @staticmethod\n    def backward(probs, labels):\n        """\u53cd\u5411\u4f20\u64ad"""\n        m = labels.shape[0]\n        grad = probs.copy()\n        grad[range(m), labels] -= 1\n        grad /= m\n        return grad\n\n# \u6d4b\u8bd5\nlogits = np.array([\n    [2.0, 1.0, 0.1],\n    [0.5, 2.5, 0.3],\n    [1.0, 0.5, 2.0]\n])\nlabels = np.array([0, 1, 2])\n\nloss, probs = SoftmaxCrossEntropy.forward(logits, labels)\ngrad = SoftmaxCrossEntropy.backward(probs, labels)\n\nprint("\u9884\u6d4b\u6982\u7387:")\nprint(probs)\nprint(f"\\n\u635f\u5931: {loss:.4f}")\nprint("\\n\u68af\u5ea6:")\nprint(grad)\n'})}),"\n",(0,s.jsx)(e.h2,{id:"\u7b2c\u4e09\u90e8\u5206kl\u6563\u5ea6---\u5206\u5e03\u5dee\u5f02",children:"\u7b2c\u4e09\u90e8\u5206\uff1aKL\u6563\u5ea6 - \u5206\u5e03\u5dee\u5f02"}),"\n",(0,s.jsx)(e.h3,{id:"\u4ec0\u4e48\u662fkl\u6563\u5ea6",children:"\u4ec0\u4e48\u662fKL\u6563\u5ea6\uff1f"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"KL\u6563\u5ea6\u8861\u91cf\u4e24\u4e2a\u6982\u7387\u5206\u5e03\u7684\u5dee\u5f02"}),"\u3002"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:'def kl_divergence(p, q):\n    """KL\u6563\u5ea6\uff1aD_KL(P||Q) = \u03a3 p(x) * log(p(x) / q(x))"""\n    p = np.array(p)\n    q = np.array(q)\n    q = np.clip(q, 1e-10, 1)\n    return np.sum(p * np.log(p / q))\n\n# \u4f8b\u5b50\np = np.array([0.5, 0.3, 0.2])  # \u771f\u5b9e\u5206\u5e03\nq1 = np.array([0.5, 0.3, 0.2])  # \u5b8c\u5168\u76f8\u540c\nq2 = np.array([0.4, 0.4, 0.2])  # \u7565\u6709\u4e0d\u540c\nq3 = np.array([0.2, 0.3, 0.5])  # \u5f88\u4e0d\u540c\n\nprint("KL(P||Q1):", kl_divergence(p, q1))  # 0.0\nprint("KL(P||Q2):", kl_divergence(p, q2))  # 0.02\nprint("KL(P||Q3):", kl_divergence(p, q3))  # 0.33\n\n# KL\u6563\u5ea6\u7684\u6027\u8d28\nprint("\\nKL\u6563\u5ea6\u7684\u6027\u8d28\uff1a")\nprint("1. \u975e\u8d1f\uff1aD_KL(P||Q) >= 0")\nprint("2. \u4e0d\u5bf9\u79f0\uff1aD_KL(P||Q) != D_KL(Q||P)")\nprint("3. P=Q\u65f6\u4e3a0")\n\n# \u9a8c\u8bc1\u4e0d\u5bf9\u79f0\u6027\nprint(f"\\nD_KL(P||Q3) = {kl_divergence(p, q3):.4f}")\nprint(f"D_KL(Q3||P) = {kl_divergence(q3, p):.4f}")\n'})}),"\n",(0,s.jsx)(e.h3,{id:"ai\u4e2d\u7684\u5e94\u7528vae\u635f\u5931\u51fd\u6570",children:"AI\u4e2d\u7684\u5e94\u7528\uff1aVAE\u635f\u5931\u51fd\u6570"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:'class VAE:\n    """\u53d8\u5206\u81ea\u7f16\u7801\u5668\uff08\u7b80\u5316\u7248\uff09"""\n    \n    @staticmethod\n    def kl_loss(mu, log_var):\n        """KL\u6563\u5ea6\u635f\u5931\uff1aD_KL(N(\u03bc,\u03c3\xb2) || N(0,1))"""\n        # KL\u6563\u5ea6\u7684\u89e3\u6790\u89e3\n        kl = -0.5 * np.sum(1 + log_var - mu**2 - np.exp(log_var))\n        return kl\n    \n    @staticmethod\n    def reconstruction_loss(x, x_recon):\n        """\u91cd\u6784\u635f\u5931"""\n        return np.sum((x - x_recon) ** 2)\n    \n    @staticmethod\n    def total_loss(x, x_recon, mu, log_var, beta=1.0):\n        """\u603b\u635f\u5931 = \u91cd\u6784\u635f\u5931 + \u03b2 * KL\u6563\u5ea6"""\n        recon_loss = VAE.reconstruction_loss(x, x_recon)\n        kl_loss = VAE.kl_loss(mu, log_var)\n        return recon_loss + beta * kl_loss\n\n# \u6d4b\u8bd5\nx = np.random.randn(10)\nx_recon = x + np.random.randn(10) * 0.1\nmu = np.random.randn(5)\nlog_var = np.random.randn(5)\n\nrecon = VAE.reconstruction_loss(x, x_recon)\nkl = VAE.kl_loss(mu, log_var)\ntotal = VAE.total_loss(x, x_recon, mu, log_var)\n\nprint(f"\u91cd\u6784\u635f\u5931: {recon:.4f}")\nprint(f"KL\u6563\u5ea6: {kl:.4f}")\nprint(f"\u603b\u635f\u5931: {total:.4f}")\n'})}),"\n",(0,s.jsx)(e.h2,{id:"\u7b2c\u56db\u90e8\u5206\u4e92\u4fe1\u606f---\u6ce8\u610f\u529b\u673a\u5236",children:"\u7b2c\u56db\u90e8\u5206\uff1a\u4e92\u4fe1\u606f - \u6ce8\u610f\u529b\u673a\u5236"}),"\n",(0,s.jsx)(e.h3,{id:"\u4ec0\u4e48\u662f\u4e92\u4fe1\u606f",children:"\u4ec0\u4e48\u662f\u4e92\u4fe1\u606f\uff1f"}),"\n",(0,s.jsxs)(e.p,{children:[(0,s.jsx)(e.strong,{children:"\u4e92\u4fe1\u606f\u8861\u91cf\u4e24\u4e2a\u53d8\u91cf\u7684\u76f8\u5173\u6027"}),"\u3002"]}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:'def mutual_information(x, y, bins=10):\n    """\u4e92\u4fe1\u606f\uff1aI(X;Y) = H(X) + H(Y) - H(X,Y)"""\n    # \u8ba1\u7b97\u8054\u5408\u5206\u5e03\n    hist_xy, _, _ = np.histogram2d(x, y, bins=bins)\n    hist_xy = hist_xy / np.sum(hist_xy)\n    \n    # \u8ba1\u7b97\u8fb9\u7f18\u5206\u5e03\n    hist_x = np.sum(hist_xy, axis=1)\n    hist_y = np.sum(hist_xy, axis=0)\n    \n    # \u8ba1\u7b97\u71b5\n    def entropy_from_hist(hist):\n        hist = hist[hist > 0]\n        return -np.sum(hist * np.log2(hist))\n    \n    h_x = entropy_from_hist(hist_x)\n    h_y = entropy_from_hist(hist_y)\n    h_xy = entropy_from_hist(hist_xy.flatten())\n    \n    # \u4e92\u4fe1\u606f\n    mi = h_x + h_y - h_xy\n    return mi\n\n# \u6d4b\u8bd5\nn = 1000\n\n# \u5b8c\u5168\u72ec\u7acb\nx1 = np.random.randn(n)\ny1 = np.random.randn(n)\n\n# \u5f3a\u76f8\u5173\nx2 = np.random.randn(n)\ny2 = x2 + np.random.randn(n) * 0.1\n\n# \u5b8c\u5168\u76f8\u5173\nx3 = np.random.randn(n)\ny3 = x3\n\nprint("\u72ec\u7acb\u53d8\u91cf\u7684\u4e92\u4fe1\u606f:", mutual_information(x1, y1))\nprint("\u5f3a\u76f8\u5173\u53d8\u91cf\u7684\u4e92\u4fe1\u606f:", mutual_information(x2, y2))\nprint("\u5b8c\u5168\u76f8\u5173\u53d8\u91cf\u7684\u4e92\u4fe1\u606f:", mutual_information(x3, y3))\n'})}),"\n",(0,s.jsx)(e.h3,{id:"\u6ce8\u610f\u529b\u673a\u5236\u7684\u4fe1\u606f\u8bba\u89e3\u91ca",children:"\u6ce8\u610f\u529b\u673a\u5236\u7684\u4fe1\u606f\u8bba\u89e3\u91ca"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-python",children:'class Attention:\n    """\u6ce8\u610f\u529b\u673a\u5236"""\n    \n    @staticmethod\n    def scaled_dot_product_attention(Q, K, V):\n        """\u7f29\u653e\u70b9\u79ef\u6ce8\u610f\u529b"""\n        # Q: (batch, seq_len, d_k)\n        # K: (batch, seq_len, d_k)\n        # V: (batch, seq_len, d_v)\n        \n        d_k = Q.shape[-1]\n        \n        # \u8ba1\u7b97\u6ce8\u610f\u529b\u5206\u6570\n        scores = np.matmul(Q, K.transpose(0, 2, 1)) / np.sqrt(d_k)\n        \n        # Softmax\n        attention_weights = np.exp(scores - np.max(scores, axis=-1, keepdims=True))\n        attention_weights = attention_weights / np.sum(attention_weights, axis=-1, keepdims=True)\n        \n        # \u52a0\u6743\u6c42\u548c\n        output = np.matmul(attention_weights, V)\n        \n        return output, attention_weights\n    \n    @staticmethod\n    def visualize_attention(attention_weights, tokens):\n        """\u53ef\u89c6\u5316\u6ce8\u610f\u529b\u6743\u91cd"""\n        plt.figure(figsize=(10, 8))\n        plt.imshow(attention_weights, cmap=\'hot\', interpolation=\'nearest\')\n        plt.colorbar()\n        plt.xticks(range(len(tokens)), tokens, rotation=45)\n        plt.yticks(range(len(tokens)), tokens)\n        plt.title(\'\u6ce8\u610f\u529b\u6743\u91cd\u77e9\u9635\')\n        plt.tight_layout()\n        plt.show()\n\n# \u6d4b\u8bd5\nseq_len = 5\nd_k = 64\nd_v = 64\n\nQ = np.random.randn(1, seq_len, d_k)\nK = np.random.randn(1, seq_len, d_k)\nV = np.random.randn(1, seq_len, d_v)\n\noutput, attention_weights = Attention.scaled_dot_product_attention(Q, K, V)\n\nprint("\u8f93\u51fa\u5f62\u72b6:", output.shape)\nprint("\u6ce8\u610f\u529b\u6743\u91cd\u5f62\u72b6:", attention_weights.shape)\nprint("\\n\u6ce8\u610f\u529b\u6743\u91cd\uff08\u6bcf\u884c\u548c\u4e3a1\uff09:")\nprint(attention_weights[0])\nprint("\\n\u6bcf\u884c\u548c:", np.sum(attention_weights[0], axis=1))\n\n# \u53ef\u89c6\u5316\ntokens = [\'\u6211\', \'\u7231\', \'\u5b66\u4e60\', \'AI\', \'\uff01\']\nAttention.visualize_attention(attention_weights[0], tokens)\n'})}),"\n",(0,s.jsx)(e.h2,{id:"\u603b\u7ed3",children:"\u603b\u7ed3"}),"\n",(0,s.jsx)(e.p,{children:"\u4fe1\u606f\u8bba\u662fAI\u7684\u7406\u8bba\u57fa\u7840\uff1a"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u71b5"}),"\uff1a\u8861\u91cf\u4e0d\u786e\u5b9a\u6027\uff0c\u7528\u4e8e\u51b3\u7b56\u6811"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u4ea4\u53c9\u71b5"}),"\uff1a\u5206\u7c7b\u635f\u5931\u51fd\u6570\u7684\u7406\u8bba\u57fa\u7840"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"KL\u6563\u5ea6"}),"\uff1a\u8861\u91cf\u5206\u5e03\u5dee\u5f02\uff0c\u7528\u4e8eVAE"]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"\u4e92\u4fe1\u606f"}),"\uff1a\u8861\u91cf\u76f8\u5173\u6027\uff0c\u89e3\u91ca\u6ce8\u610f\u529b\u673a\u5236"]}),"\n"]}),"\n",(0,s.jsxs)(e.p,{children:["\u8bb0\u4f4f\uff1a",(0,s.jsx)(e.strong,{children:"\u4fe1\u606f\u8bba\u8ba9AI\u7684\u635f\u5931\u51fd\u6570\u6709\u4e86\u6570\u5b66\u4f9d\u636e"}),"\uff01"]}),"\n",(0,s.jsx)(e.h2,{id:"\u7ec3\u4e60\u9898",children:"\u7ec3\u4e60\u9898"}),"\n",(0,s.jsxs)(e.ol,{children:["\n",(0,s.jsx)(e.li,{children:"\u5b9e\u73b0\u4e00\u4e2a\u57fa\u4e8e\u4fe1\u606f\u589e\u76ca\u7684\u51b3\u7b56\u6811"}),"\n",(0,s.jsx)(e.li,{children:"\u6bd4\u8f83MSE\u548c\u4ea4\u53c9\u71b5\u5728\u5206\u7c7b\u4efb\u52a1\u4e0a\u7684\u8868\u73b0"}),"\n",(0,s.jsx)(e.li,{children:"\u5b9e\u73b0VAE\u5e76\u53ef\u89c6\u5316\u6f5c\u5728\u7a7a\u95f4"}),"\n",(0,s.jsx)(e.li,{children:"\u5b9e\u73b0\u591a\u5934\u6ce8\u610f\u529b\u673a\u5236"}),"\n"]}),"\n",(0,s.jsxs)(e.p,{children:["\u4e0a\u4e00\u7ae0\uff1a",(0,s.jsx)(e.a,{href:"/weuqiangcreate_website/docs/%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/%E5%BE%AE%E7%A7%AF%E5%88%86%E4%B8%8E%E4%BC%98%E5%8C%96",children:"\u5fae\u79ef\u5206\u4e0e\u4f18\u5316"})]})]})}function _(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(d,{...n})}):d(n)}},28453(n,e,t){t.d(e,{R:()=>l,x:()=>o});var r=t(96540);const s={},i=r.createContext(s);function l(n){const e=r.useContext(i);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:l(n.components),r.createElement(i.Provider,{value:e},n.children)}}}]);