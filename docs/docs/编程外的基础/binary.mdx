---
sidebarDepth: 4
---
# 

## 

``` js
//  -> 
const num = 255;
num.toString(2) // '11111111'

//  -> 
const num = 255;
num.toString(16) // 'ff'

//  -> 
parseInt(0b1111) // 15

//  -> 
parseInt(0xff) // 255
```


##  

`features`

`Feature`

``` js
const Feature = {
  One: 0b01,
  Two: 0b10,
  Three: 0b100,
  Four: 0b1000,
}
```

`features``0b1111`



### 

`Feature`

``` js
let shift = 0
const Feature = {
  One: 1 << shift++,
  Two: 1 << shift++,
  Three: 1 << shift++,
  Four: 1 << shift++,
}
```

`<<`****`1 << 3``0b1`3`0b1000`8



### 

****`>>``8 >> 3``0b1000`3`0b1`1



### 

`0b0101``Feature.One``Feature.Two`**|**

``` js
const features = Feature.One | Feature.Three
```



### 

`Feature.One``features`1**&**

``` js
const hasFeature = (feature & Features.One) > 0
```

## Buffer

`Buffer`**`Buffer``Node.js`****`ArrayBuffer`**API

`fs``encoding``Buffer`



### `Buffer.alloc()` 

BufferBuffer

``` js
const buffer = Buffer.alloc(10) // <Buffer 00 00 00 00 00 00 00 00 00 00>
const buffer = Buffer.alloc(10, 0xfc) // <Buffer fc fc fc fc fc fc fc fc fc fc>
```

### `Buffer.from(string[, encoding])`

`Buffer``utf-8`

``` js
const buffer = Buffer.from('aka') // <Buffer 61 6b 61>  
const buffer = Buffer.from('') // <Buffer e4 bd a0 e5 a5 bd>
```

### `buffer.toString([encoding])`

`Buffer``utf-8`

``` js
const buffer = Buffer.from('aka') 
const str = buffer.toString() // aka
```





## ArrayBuffer
``` js
const buffer = new ArrayBuffer(3) // 3ArrayBuffer
```


Node`Buffer`**`ArrayBuffer`**`ArrayBuffer`**`Typed Array`****`DataView`******ArrayBuffer/ArrayBuffer



1. ****`Typed Array``Uint32Array`324****`DataView``getUint8``getUint32`
2. ****`Typed Array``DataView`

:::info
************0x0102[02, 01][01, 02]


::: 


### Typed Array

`Typed Array``Uint8Array``Int8Array``Uint32Array``Int32Array``Uint8ClampedArray`

``` js title=""
const buffer = new ArrayBuffer(3)
const typedArray1 = new Uint8Array(buffer) // length: 3, byteLength: 3
buffer === typedArray1.buffer // true

const typedArray2 = new Uint32Array([65]) // length: 1, byteLength: 4
```

``` js title=""
const typedArray3 = new Uint8Array([65, 66, 67, 68]) // length: 4, byteLength: 4
const typedArray4 = new Uint16Array(typedArray3.buffer) // length: 2, byteLength: 4

typedArray4[0] = 0;
typedArray3[0] === 0 // true;
typedArray3[1] === 0 // true 
```

``` js title="TypedArray"
const buffer = new ArrayBuffer(4)

const typedArray1 = new Uint8Array(buffer)
const typedArray2 = new Uint16Array(buffer)
typedArray2[0] = 255

typedArray1[0] === 255 // true 
typedArray1[1] === 0 // true
```

``` js title="Uint8ClampedArray2550"
const buffer = new ArrayBuffer(2)
const typedArray1 = new Uint8Array(buffer)
typedArray1[0] = 256
typedArray1[0] === 0 // true

const typedArray2 = new Uint8ClampedArray(buffer)
typedArray2[0] = 256
typedArray2[0] === 255 // true
```

### DataView

``` js title=""
const buffer = new ArrayBuffer(3)
const view1 = new DataView(buffer)
const view2 = new DataView(new Uint8Array([65, 66, 67, 68]).buffer)
```


``` js title="DataView"
const buffer = new ArrayBuffer(4)

const typedArray1 = new Uint8Array(buffer)
const view = new DataView(buffer)

view.setUint16(0, 255) 
typedArray1[0] === 0 // true;
typedArray1[1] === 255 // true

view.setUint16(0, 255, true) // DataView 
typedArray1[0] === 255 // true 
typedArray1[1] === 0 // true
```



## 

### 
`Buffer``ArrayBuffer``ascii``gbk``utf-8``utf-16``utf-8``Buffer.from``fs.writeFile``fs.readFile``TextEncoder``TextDecoder`

JavaScript**`utf-16`**`charCodeAt`JS

``` js
'A'.charCodeAt(0) // 
```

:::info 

`utf-16``\u0003``\x03`

``` js
'\x03'.length // 1
'\x03'.charCodeAt(0) // 3
```
:::





### 
UnicodeCodePoint`utf-8``utf-16``utf-32`

``` js title=""
''.codePointAt(0)
```



### HTMLcharacter Entities

``` html
<span>&ZeroWidthSpace;</span>
<span>&#8203;</span> <!-- unicode-->
```



### JavaScript

``` js
//  zeroWidthSpace
const str = '\u200B' // unicode
```





### TextEncoder

`TextEncoder``utf-8`Typed Arraybuffer

``` js
const arr = new TextEncoder().encode('akara') // Uint8Array(5) [97, 107, 97, 114, 97, buffer: ArrayBuffer(5)]
const buffer = arr.buffer // ArrayBuffer(5)
```

``` js title="utf-16"
[...new TextEncoder().encode('')].map(i => i.toString(16)) // utf-8 ['e4', 'bd', 'a0']
''.charCodeAt().toString(16) // utf-16 4f60
```


### TextDecoder

``` js
const arr = new Uint8Array([97, 107, 97, 114, 97])
new TextDecoder().decode(arr) // akara
```



### encodeURI
HTTPASCII`encodeURI``encodeURIComponent``utf-8`****


``` js
encodeURI('') // '%E4%BD%A0%E5%A5%BD'

[...new TextEncoder().encode("")].map(item => item.toString(16)) // ['e4', 'bd', 'a0', 'e5', 'a5', 'bd']

const buffer = Buffer.from('') // Nodejs <Buffer e4 bd a0 e5 a5 bd>
```


### decodeURI

``` js
decodeURI('%E4%BD%A0%E5%A5%BD') // 
```

:::info 
`encodeURI``encodeURIComponent`URL
``` js
encodeURI('http://baidu.com') // 'http://baidu.com'

encodeURIComponent('http://baidu.com') // 'http%3A%2F%2Fbaidu.com'
```
:::


### Base64
`Base64`

:::info 

242446`00`6`ASCII`64`2^6``Base64`

:::


`Base64``Base64``window.btoa``Base64`binary string`window.btoa``Base64`ASCII

`Base64``<img src="data:img/gif;base64,xxxxx" />``Base64`

``` js
fetch('data:image/png;base64,xxxxx').then(res => res.arrayBuffer())
```



### `window.btoa()`

`window.btoa``base64`

``` js
window.btoa('hello akara') // aGVsbG8gYWthcmE=
```

`window.btoa``encodeURIComponent()`

``` js
window.btoa(encodeURIComponent('')) // JUU0JUJEJUEwJUU1JUE1JUJE
```

### `window.atob()`

``` js
window.atob('aGVsbG8gYWthcmE=') // hello akara

decodeURIComponent(window.atob('JUU0JUJEJUEwJUU1JUE1JUJE')) // 
```





## Blob

**`Blob`**`File`

``` js
fetch()
.then(res => res.blob())
.then(blob => {
    console.log(blob)
})
```



### `new Blob()`

`ArrayBuffer``Blob`

``` js
new Blob([JSON.stringify({
    name: 'akara'
})], { type: 'application/json' })
```

``` js
new Blob([new Uint8Array([10, 20]).buffer]) // 
```





### `blob.arrayBuffer()`

`Blob``ArrayBuffer``Promise`



### `blob.text()`

`Blob``utf-8``Promise`

``` js
blob.text().then(text => console.log(text))
```

### `blob.slice()`

`blob``blob`



### `URL.createObjectURL(blob)`

①②

`blob`URL`a``img`

``` js
const url = URL.createObjectURL(blob)
a.href = url //  blob:http://localhost:3000/486ef892-d4fc-485f-b4ab-fae272d35e55
a.download = '.txt' // 

const url2 = URL.createObjectURL(blob)
img.src = url2
```



## File

`File``Blob``Blob``name``lastModified``lastModifiedDate``input`



``` js
const el = document.querySelector('input')
console.log(el.files) // FileList
el.files[0] // File
```



## FormData

`formData`

``` javascript
// 
fetch(url, {
  data: {
    file: new File(), // JSON.stringify
   	name: 'akara',
  }
})

// 
const formData = new FormData();
formData.append('file', new File());
formData.append('name', 'akara')

fetch(url, {
  data: formData
})
```





## 

`ArrayBuffer``String``Blob`

1. `String -> Uint8ArrayTextEncoder`
2. `Uint8Array -> StringTextDecoder`
3. `Uint8Array -> ArrayBuffer.buffer`
4. `ArrayBuffer -> Uint8Arraynew Uint8Array`
5. `ArrayBuffer -> Blobnew Blob`
6. `Blob -> ArrayBufferarrayBuffer`
7. `Blob -> Stringtext`
8. `String -> Blobnew Blob`







## FileReader

`FileReader``Blob``ArrayBuffer``FileReader`

``` js
const reader = new FileReader()
reader.onload = function() {
    console.log(reader.result)
}
reader.readAsXXX(blob)
```

### `readAsArrayBuffer()`

`blob.arrayBuffer()`

### `readAsText()`

`blob.text()`



### `readAsDataURL()`

`URL.createObjectURL`

Base64`data:application/octet-stream;base64,`URL`URL.createObjectURL()``blob:http://xxx.com/xxx`URLURL



### `readAsBinaryString()`
JSUTF-16

``` js
const blob = new Blob([new Uint8Array([0, 255, 0, 255, 100, 200])])

const reader = new FileReader();
reader.onload = function () {
    console.log(Uint8Array.from(reader.result, char => char.charCodeAt(0))) // Uint8Array([0, 255, 0, 255, 100, 200])
    // console.log(reader.result)  ÿÿdÈ
}
reader.readAsBinaryString(blob)
```









## stream

Node`Stream``eventEmitter``on``pipe`



- `Writable``fs.createWriteStream``process.stdout``res`
- `Readable``fs.createReadStream``process.stdin``req`
- `Duplex``Writable``Readable`
- `Transform`



### Writable

`Writable``write()``end()`



### Readable

`Readable``on('data')``on('end')`



### `pipeline`

``` js
const { stdout, stdin } = require('process')
const { pipeline } = require('stream')

// 
stdin.on('data', chunk => {
    stdout.write(chunk)
})

// 
stdin.pipe(stdout)

// 
pipeline(stdin, stdout)
```



## zlib

Node`Zlib``Stream`API`gzip`

``` js
const zlib = require('zlib')
const { pipeline } = require('stream')
const gzip = zlib.createGzip() // 
const source = fs.createReadStream('./a.txt')
const target = fs.createWriteStream('./a.txt.gz')

pipeline(source, gzip, target, err => console.log(err)) // a.txt.gz
```



160Kb4Kb`Content-Encoding: gzip`****

``` js
// server.js
const { promisify } = require('util')
const fs = require('fs')
const zlib = require('zlib')
const readFile = promisify(fs.readFile)
const gzip = promisify(zlib.gzip)
const http = require('http')

http.createServer(async (req, res) => {
    if (req.url === '/') {
        const page = await readFile('./index.html')
        const data = await gzip(page)
        res.setHeader('Content-Encoding', 'gzip')
        res.end(data)
    } 
    else if (req.url === '/test') {
        let obj = {}
        for (let i = 0; i < 10000; i++) {
            obj[i] = i
        }
        const data = await gzip(JSON.stringify(obj))
        res.setHeader('Content-Encoding', 'gzip')
        res.end(data)
    }
}).listen(3000)

// client.js
fetch('/test')
.then(res => res.json())
.then(data => console.log(data)) // obj
```





