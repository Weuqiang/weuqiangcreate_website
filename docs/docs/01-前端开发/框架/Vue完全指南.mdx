---
sidebarDepth: 4
---
# Vue

:::caution 
ReactVue
:::

## 

``` vue
<div id="counter">
  Counter: {{ counter }}
</div>
<script>
	const Counter = {
      	data() {
        	return {
          		counter: 0
        	}
      	},
        computed: { // 
            A() {
                return counter * counter
            }
        },
        watch: {
            counter(newValue, oldValue) { // counter
                
            }
        },
        methods: {
            fn() {
                console.log(this.counter)
            }
        },
        mounted() {
            
        }
    }
	const app = Vue.createApp(Counter)
    app.mount('#counter')
</script>
```

##### 

`app.component('name', {})`Vue



##### 

`v-bind``:``v-on``@``v-for``v-model``v-if``v-show`

``` vue
<!-- 
	post: {
		id: 1,
		title: 'aka'
	}
-->
<blog-post v-bind="post"></blog-post>
<!--  -->
<blog-post v-bind:id="post.id" v-bind:title="post.title"></blog-post>
```

> `v-if` “”
>
> `v-if` ****——
>
> `v-show` —— CSS 
>
> `v-if`  `v-show`  `v-show`  `v-if` 

##### 

`beforeCreate``created``beforeMount``mounted``beforeUpdate``updated``beforeUnmount``mounted`

[](https://v3.cn.vuejs.org/guide/instance.html#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E9%92%A9%E5%AD%90)

##### 

`props`Vuex



##### Props

ReactVue`props``props`

Vue3Fragment`props`

``` vue
<!-- Layout.vue -->
<template>
  	<header>...</header>
  	<main v-bind="$attrs">...</main>
  	<footer>...</footer>
</template>
```

##### Provider and Inject

VueContext`Provider/Inject`

##### Teleport

VuePortalsModal

ModalTeleport****`body`

``` vue
app.component('modal-button', {
  template: `
    <button @click="modalOpen = true">
        Open full screen modal! (With teleport!)
    </button>

    <teleport to="body">
      <div v-if="modalOpen" class="modal">
        <div>
          I'm a teleported modal! 
          (My parent is "body")
          <button @click="modalOpen = false">
            Close
          </button>
        </div>
      </div>
    </teleport>
  `,
  data() {
    return { 
      modalOpen: false
    }
  }
})
```

##### API

APIComposition APIVue 3

****

ReactHookVue`data``computed``watch``computed``lifecycle`API

****

```vue
<template>
  <div>
    <p>: {{ count }}</p>
    <p>: {{ doubleCount }}</p>
    <button @click="increment"></button>
  </div>
</template>

<script>
import { ref, computed, onMounted } from 'vue'

export default {
  setup() {
    // 
    const count = ref(0)
    
    // 
    const doubleCount = computed(() => count.value * 2)
    
    // 
    const increment = () => {
      count.value++
    }
    
    // 
    onMounted(() => {
      console.log('')
    })
    
    // 
    return {
      count,
      doubleCount,
      increment
    }
  }
}
</script>
```

****

```javascript
// useCounter.js
import { ref, computed } from 'vue'

export function useCounter(initialValue = 0) {
  const count = ref(initialValue)
  const doubleCount = computed(() => count.value * 2)
  
  const increment = () => count.value++
  const decrement = () => count.value--
  const reset = () => count.value = initialValue
  
  return {
    count,
    doubleCount,
    increment,
    decrement,
    reset
  }
}
```

****

```vue
<script>
import { useCounter } from './useCounter'

export default {
  setup() {
    const { count, doubleCount, increment, decrement, reset } = useCounter(10)
    
    return {
      count,
      doubleCount,
      increment,
      decrement,
      reset
    }
  }
}
</script>
```

****

1. ****: 
2. ****: TypeScript
3. ****: 
4. ****: setupJavaScript



## Vuex

``` javascript
const store = new Vuex.Store({
    state: {
        count: 0
    },

    getters: {
        countPlus: state => {
            return state.count + 1
        }
    },

    mutations: {
        increment: (state, payload) => {
            state.count += payload
        }
    }
})
new Vue({
    el: '.app',
    store,
    computed: {
        count: function() {
            return this.$store.state.count
        }
    },
    methods: {
        increment: function() {
            this.$store.commit('increment', 10)
        }
    },
    template: `
        <div>
            {{ count }}
            <button @click='increment'></button>
        </div>
    `
})
```

##### mutation  action

actionmutation

- Action  mutation
- Action Mutation

## Vue Router

``` html
<div class="app">
    <router-link :to="/login"></router-link>
    <router-link :to="/logout"></router-link>
    <router-view></router-view>
</div>
```

``` javascript
const routes = [
    {
        path: '/login',
        component: { template: '<login></login>' }
    },
    {
        path: '/logout',
        component: { template: '<logout></logout>' }
    },
]

const router = new VueRouter({
    routes
})

const vm = new Vue({
    el: '.app',
    router
})
```

##### 

/user/:id/user/akara/user/messiah

``` javascript
const User = {
  template: '<div>User {{ $route.params.id }}</div>'
}

const router = new VueRouter({
  routes: [
    //  
    { path: '/user/:id', component: User }
  ]
})
```

##### 

router-viewrouter-view

``` html
const User = {
  template: `
    <div class="user">
      <h2>User {{ $route.params.id }}</h2>
      <router-view></router-view>
    </div>
  `
}
```

``` javascript
const router = new VueRouter({
  routes: [
    { path: '/user/:id', component: User,
      children: [
        {
          //  /user/:id/profile 
          // UserProfile  User  <router-view> 
          path: 'profile',
          component: UserProfile
        },
        {
          //  /user/:id/posts 
          // UserPosts  User  <router-view> 
          path: 'posts',
          component: UserPosts
        }
      ]
    }
  ]
})
```

##### 

`router-link``this.$router.push`

``` javascript
// 
router.push('home')

// 
router.push({ path: 'home' })

// 
router.push({ name: 'user', params: { userId: '123' }})

//  /register?plan=private
router.push({ path: 'register', query: { plan: 'private' }})
```

##### 

VueVue-Router

Vue-Router`Hash``History``Hash`Url`https://example.com/#user/akara``History`Url`https://example.com/user/akara`

`Hash``a`****`onhashchange`****

`History``a``a``history.pushState`********`popstate``popstate`



```js
// history
const router = new VueRouter({
  mode: 'history',
  routes: [...]
})
```

History `https://example.com/user/akara`404URL`index.html`





## 

##### nextTick

`State`DOM****`State``tick``tick`DOM

DOM`this.$nextTick`



``` vue
<template>
	<div>
        {{ count }}
    </div>
</template>
<script>
    export default {
        data() {
            return {
                count: 0
            }
        },
        methods: {
            onClick() {
                this.count++
                this.count++
                
                new Promise((resolve) => {
                  	resolve(100)
                }).then(() => {
                  	this.count++
                  	this.count++
                  	this.$nextTick(() => {
                      	console.log(this.$el.textContent); // 4
                  	})
                })
                // DOM
                console.log(this.$el.textContent) // 0
                this.$nextTick(() => {
                    console.log(this.$el.textContent) // 2
                })
            }
        },
        updated() {
            console.log('') // 
        }
    }
</script>
```

``` markdown
0

2

4
```







##### 

Vue-Object.defineProperty()gettersetter

1. Observer Object.defineProperty
2. Compiler 
   1. parsetemplateclassstyleAST
   2. optimizediff
   3. generateASTDOM
3. Watcher ObserverCompiler
   1. getterdepswatch
   2. setterdeps.notifywatchupdate
   3. watchupdateDOMDiff



###### 

`new Vue()  `VueVue._init 

1. initRender

2. BeforeCreate

3. initInjections

   1. Object.definePropertydata
   2. getWatcherdep
   3. setdepnotifydepWatcherupdate

4. Created

5. elvm.$mount()

6. templatetemplateelouterHTMLDOM

   1. parsetemplateclassstyleAST
   2. optimizediff
   3. generateAST

7. beforeMount

8. DOMDOMel

9. Mounted

   

   1. beforeUpdate

   2. WatcherupdateWatchertickDOM

   3. DOMVDompatchpatchdiff

      1. oldVnodenewVnode

      2. sameVnodeoldVnodenewVnodekey tag isCommentdata inputtypesameVnodeVNodepatchVnodesameVode

         1. VNodekeyVNodev-oncecloneelmcomponentsinstance
         2. VNodechildrenupdateChildrendiff

            1. oldVnodechildrenoldChnewVnodechildrennewCh
            2.  oldStartIdxnewStartIdxoldEndIdx  newEndIdx  children  oldStartVnodenewStartVnodeoldEndVnode  newEndVnode VNode 
            3. whileoldStartIdxoldEndIdxnewStartIdxnewEndIdx
            4. oldStartVnodenewStartVnodeoldEndVnodenewEndVnode     oldStartVnodenewEndVnode   oldEndVnodenewStartVnodesameVnodepatchVnode, 
            5. sameVnodeoldChnewStartVnodesameVnode
               1.  keynewStartVnodekeykeyVnode
               2. keysameVnode**keydiff**
               3. VnodeVnode
            6. oldStartIdx > oldEndIdx   newStartIdx > newEndIdx 
   
         3. oldVnodechildrennewVnodeDOM
   
         4. oldVnodechildrennewVnode
   
         5. DOM

10. updated
11. vm.$destroy()
12. beforeDestroy
13. watchers
14. destroyed





##### Vue2

`Object.defineProperty`

Vue3.0`proxy`

###### Vue 

```js
var vm = new Vue({
  data: {
    a: 1
  }
})
// `vm.a` 

vm.b = 2
// `vm.b` 
```

Vue  `Vue.set(object, key, value)` 

```js
var vm = new Vue({
  data: {
    userProfile: {
      name: 'Anika'
    }
  }
})
```

 `age`  `userProfile` 

```js
Vue.set(vm.userProfile, 'age', 27)
```

 `vm.$set`  `Vue.set` 

```js
vm.$set(vm.userProfile, 'age', 27)
```

###### 

`Object.defineProperty`

Vue`push``pop``shift``unshift``splice``sort``reverse`



 JavaScript Vue 

1. `vm.items[indexOfItem] = newValue`
2. `vm.items.length = newLength`

 `vm.items[indexOfItem] = newValue` 

```js
// Vue.set
Vue.set(example1.items, indexOfItem, newValue)

// Array.prototype.splice
example1.items.splice(indexOfItem, 1, newValue)
```

 `splice`

```
example1.items.splice(newLength)
```