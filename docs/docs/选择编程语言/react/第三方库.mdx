---
sidebarDepth: 4
---

# 

## redux

### 

``` javascript
import { createStore } from 'redux'

const reducer = (state = 0, action) => {
    switch(action.type) {
    	case 'add':
        	return state + action.payload
    	case 'delete':
        	return 	state - action.payload
      	default:
        	return state
    }
}

let store = createStore(reducer)


store.getState()

const action1 = {
	type: 'add',
	payload: 2,
}

const createAction = (val) => ({
	type: 'add',
	payload: val
})

store.dispatch(action1)
store.dispatch(createAction(111))

store.subscribe(() => {
	console.log('change state')
})
```



### [](https://github.com/Messiahhh/redux-core)

``` javascript
const createStore = (reducer, enhancer) => {

    if (enhancer) {
        return enhancer(createStore)(reducer)
    }
    let state

    const getState = () => state

    const dispatch = (action) => {
        state = reducer(state, action)
        return action
    }

    dispatch({})

    return {
        getState,
        dispatch,
    }
}

const compose = (...funcs) => {
    return funcs.reduce((a, b) => (...args) => a(b(...args)))
}

const logger = ({
    getState,
}) => next => action => {
    console.log(getState());
    next(action)
    console.log(getState());
}

const thunk = ({
    dispatch,
    getState,
}) => next => action => {
    if (typeof action === 'function') {
        return action(dispatch, getState)
    } else {
        return next(action)
    }
}

const applyMiddleWares = (...middlewares) => {
    return (createStore) => (reducer) => {
        const store = createStore(reducer)

        let dispatch
        let middlewareAPI = {
            getState: store.getState,
            dispatch: (action, ...args) => dispatch(action, ...args),
        }

        // const chain = middlewares.map(middleware => middleware(middlewareAPI))
        dispatch = middlewares[0](middlewareAPI)(store.dispatch)
        return {
            ...store,
            dispatch
        }
    }
}

const reducer = (state = 10, action) => {
    switch (action.type) {
        case "ADD":
            return state + action.payload
        case "DELETE":
            return state - action.payload
        default: 
            return state
    }
}

store = createStore(reducer, applyMiddleWares(thunk))

function fetchData(dispatch, getState) {
    dispatch({
        type: 'ADD',
        payload: 10,
    })

    setTimeout(() => {
        dispatch({
            type: 'ADD',
            payload: 30,
        })
    }, 2000)
}

store.dispatch(fetchData)
console.log(store.getState());
```



## react-redux

`redux`React`react-redux`



```javascript
// action.js
export const CHANGE_CHANNEL = 'CHANGE_CHANNEL'
export const changeChannel = (channel) => ({
    type: CHANGE_CHANNEL,
    channel
})
```

``` javascript
// reducers.js
import {
	CHANGE_CHANNEL
} from './action.js'

import { combineReducers } from 'redux'

const channel = (state = "nintendo", action) => {
    switch(action.type) {
        case CHANGE_CHANNEL:
            return action.channel
        default:
            return state
    }
}

const name = (state = "test", action) => {
	return state
}

const rootReducer = combineReducers({
	channel,
  	name,
})

export default rootReducer
```


``` javascript
// index.js
import React from 'react'
import ReactDOM from 'react-dom'
import { createStore } from 'redux'
import { Provider } from 'react-redux'
import reducer from './reducers.js'
import App from './app.js'
let store = createStore(reducer)

ReactDOM.render(
	<Provider store={store}>
        <App />
    </Provider>,
    document.querySelector('#root')
)
```



#### HOC

``` javascript
// app.js
import { connect } from 'react-redux'
import {
	changeChannel
} from './action.js'
const App = ({
	channel,
  	handlerClick,
}) => {
	return (
    	<div>
      		<span>{channel}</span>
      		<button onClick={handlerClick}>Click me</button>
      	</div>
    )
}

// UIAPP
// mapStateToProps props
const mapStateToProps = (state) => {
    return {
      	// props  state.channel
        channel: state.channel
    }
}

// mapDispatchToProps Dispatchprops
const mapDispatchToProps = (dispatch) => {
    return {
        handlerClick: (value) => {
            dispatch(changeChannel(value))
        }
    }
}
// or mapDispatchToProps 
// const mapDispatchToProps = {
//   	// action creator
// 	handlerClick: () => {
// 		type: 'add'
//     }
// }

export default connect(
	mapStateToProps,
	mapDispatchToProps,
)(App)

```

#### Hook

``` jsx
import { useSelector, useDispatch } from 'react-redux' 

const App = () => {
	const channel = useSelector(state => state.channel)
    const postsByChannel = useSelector(state => state.postsByChannel)

    return (
    	<div>
    		<div>...</div>
      	</div>
    )
}
```







## react-router

``` javascript
import React from 'react'
import {
    BrowserRouter as Router, // History modehash mode
    Link,
    Switch,
    Route
} from 'react-router-dom' // webreact-router-dom

function App () {
    return (
    	<Router>
        	<Link to='/'></Link>
        	<Link to='/blog'></Link>
            <Link to='/about'></Link>

        	<Switch>
        		<Route path='/about'>
        			<About />
        		</Route>
        		<Route path='/blog'>
        			<Blog />
        		</Route>
        		<Route path='/'>
        			<Home />
        		</Route>
        	</Switch>
        </Router>
    )
}


```



### api

#### useLocation



``` jsx
// /profile/akara?name=aa#code
const location = useLocation()
{
    hash: "#code"
    pathname: "/profile/akara"
    search: "?name=aa"
    state: undefined
}
```



#### useHistory



``` jsx
const history = useHistory()
history.push('/')
```



#### useParams

`/profile/:id``id`

``` jsx
// /profile/akara
<Route path="/profile/:id">
    <Test />
</Route>

const params = useParams() //   { id: akara }

```



#### useRouteMatch

`<Route path="">``path`

`useRouteMatch`

> The `useRouteMatch` hook attempts to [match](https://reactrouter.com/web/api/match) the current URL in the same way that a `<Route>` would





`useRouteMatch`

> - takes no argument and returns the match object of the current  `<Route>` 
> - takes a single argument, which is identical to [props argument of matchPath](https://reactrouter.com/web/api/matchPath/props). It can be either a pathname as a string (like the example above) or an object with the matching props that `Route` accepts, like this:





``` jsx
// 
// /profile/akara

<Route path="/profile/:id">
    <Test />
</Route>

function Test() {
    // <Route path="/profile/:id">
    const match = useRouteMatch() 
    const {
        path, //    /profile/:id
        url, //    /profile/akara
        params, //   { id: akara }
    } = match
    
    return (
        <div>
            <Link to={`${url}/avatar`}></Link> 
            
            <Route path={`${path}/avatar`}>
            	<div>content...</div>
            </Route>
        </div>
    )
}
```



``` jsx
// 
// /profile/test
const match = useRouteMatch({
    path: '/test'
})
console.log(match); // null
```



#### `<Redirect>`

``` jsx
<Redirect
    to={{
      pathname: "/login",
      state: { from: location }
    }}
/>
```



### 

**`<Route path="">`**

`Route``path`

``` jsx
<Link to="/a/b">1</Link>
<Link to="/b">2</Link>

<Route path="/a">
    <div>aaa</div>
	<Route path="/b">
        <div>bbb</div>
    </Route>
    <Route path="/a/b">
        <div>abab</div>
    </Route>
</Route>
```

1`/a/b`

`<Route path="/a">``path``Route``<Route path="/a/b">`



2`/b`

`<Route path="/a">``path`



### 

``` javascript
import {
    ...
    useParams,
} from 'react-router-dom'

<Switch>
    <Route path='/user/:id'>
    	<User />    
    </Route>
</Switch>


function User() {
    let { id } = useParams()

    return (
    	<div>
        	user: { id }
        </div>
    )
}
```



### 

`react-transition-group`



### react-transition-group



`expose ``stages``enter``entering/enter-active``enter-done`

> 
>
> /state**A -> B**
>
> ItementerBItem01
>
> ItemexitAItem10B
>
> 







### CSSTransition

``` jsx
import { CSSTransition } from 'react-transition-group'

<CSSTransition
    in={show} // stages
    timeout={2000} // 
    classNames="prefix" // aa-enter a-enter-active a-enter-done
    unmountOnExit
>
   <div>hello world</div>
</CSSTransition>
<button onClick={() => setShow(true)}></button>
<button onClick={() => setShow(false)}></button>
```

#### in

`in`

1. `in``true``prefix-enter prefix-enter-active``timeout``prefix-enter-done`

2. `in``false``prefix-exit prefix-exit-active``timeout``prefix-exit-done`



/

``` css
/*  */
.prefix-enter {
  opacity: 0;
}

.prefix-enter-active {
  opacity: 1;
  transition: all 3s;
}

/*  */

.prefix-exit-active {
  opacity: 0;
  transition: all 2s;
}

.prefix-exit {
  opacity: 1;
}
```

`in``true`****()`prefix-enter``prefix-enter-active``opacity`01

> When the `in` prop is set to `true`, the child component will first receive the class `example-enter`, then the `example-enter-active` will be added in the next tick.`CSSTransition` [forces a reflow](https://github.com/reactjs/react-transition-group/blob/5007303e729a74be66a21c3e2205e4916821524b/src/CSSTransition.js#L208-L215) between before adding the `example-enter-active`. This is an important trick because it allows us to transition between `example-enter` and `example-enter-active` even though they were added immediately one after another.



#### appear

`in``true``false`

`in``true``appear`:

``` jsx
 <CSSTransition
    in={true}
    timeout={2000}
    classNames="prefix"
    appear={true}
>
```

`prefix-appear prefix-appear-active``timeout``prefix-appear-done prefix-enter-done`



#### unmountOnExit

prop`exit`



#### onEnter

`enter``exit``node`



`onEnter`

> A  callback fired immediately after the 'enter' or 'appear' class is applied.

`onEntering`

> A  callback fired immediately after the 'enter-active' or 'appear-active' class is applied.

`onEntered`

> A callback fired immediately after the 'enter' or 'appear' classes are **removed** and the `done` class is added to the DOM node.

``` js
<CSSTransition
	// node: 
	// appear: appeartrue
    onEnter={(node, appear) => {}} 
>
```



### TransitionGroup



``` jsx
<TransitionGroup>
    {item.map(({ id, text }) => (
        <CSSTransition
            key={id}
            timeout={500}
            classNames="prefix"
        >
            <div>{text}</div>
        </CSSTransition>
    ))}
</TransitionGroup>
```

`item`A -> BDOM`key`

`item``A, B`

1. `item`CDOM`key`DOMCDOMC`*-enter *-enter-active`

2. `item`ADOM`key`DOMAA`*-exit *-exit-active``*-exit-done`DOM





### react-router

``` jsx
// const location = useLocation()
<TransitionGroup>
  <CSSTransition
    key={location.key}
    classNames="fade"
    timeout={300}
  >
    <Switch location={location}>
      <Route path="/hsl/:h/:s/:l" children={<HSL />} />
      <Route path="/rgb/:r/:g/:b" children={<RGB />} />
    </Switch>
  </CSSTransition>
</TransitionGroup>
```







## antd

> 

### Input

``` jsx
// 1. e.target.value
<Input />  

// 2. 
<Input value={count} onChange={(e) => this.setState({count: e.target.value})}/>

```

### Select

``` jsx
// 1. 
<Select value="" >
    <Option value=""></Option>
    <Option value=""></Option>
    <Option value=""></Option>
</Select>

// 2. 
<Select value={v} onChange={(value) => this.setState({v: value})}> // e
    <Option value=""></Option>
    <Option value=""></Option>
    <Option value=""></Option>
</Select>
```

### Form

``` jsx
// 3. 
  <Form
    name="data"
    onFinish={this.handleFinish}
  >
    <Form.Item	
      label=""
      name="username"
      rules={[{required: true, message: 'Please input your username!'}]}
    >
      <Input />
    </Form.Item>
    <Form.Item
      label=""
      name="password"
    >
      <Input />
    </Form.Item>
    <Form.Item
      label=""
      name="sex"
    >
      <Select> {/* defaultValue */}
        <Option value="male">male</Option>
        <Option value="female">female</Option>
        <Option value="other">other</Option>
      </Select>
    </Form.Item>
    <Form.Item>
      <Button htmlType="submit"></Button>
    </Form.Item>
  </Form>
```

`getFieldsValue/setFieldsValue/resetFields`//

`class``ref``Form.useForm`

``` jsx
// class 
myRef = React.createRef()
// ...
this.myRef.current.getFieldsValue()
// ...
<Form ref={myRef}>
    
// 
const [form] = React.useForm()
// ...
form.getFieldsValue()
// ...
<Form form={form}>
```

#### Form

Form`horizontal(default),vertical,inline`

``` jsx
<Form layout="inline"></Form>
```

`labelCol/wrapperCol`props`Form``Form.Item`

``` jsx
<Form
	labelCol={{ span: 8 }}
    wrapperCol={{ span: 14 }}
>
	<Form.Item></Form.Item>
    <Form.Item></Form.Item>
    <Form.Item
    	labelCol={{ offset: 8 }}    
    ></Form.Item>
</Form>
```

`labelCol``label``wrapperCol``Form.Item``Input/Select/Button`

`span``offset``span``offset`

`labelAlign``label``right`

#### 



``` jsx
<Item name="a"></Item>
<Item name="b"></Item>
<Item name={['c', 'c1']}></Item>
<Item name={['c', 'c2']}></Item>


// 
- a: 1
- b: 2
- c
  - c1: 3
  - c2: 4
```

#### 

``` jsx
<Form.List name="userLists">
      {(fields, {add}) => (
        <>
          {
            fields.map(field => {
              return (
                <Space key={field.key}>
                <Form.Item {...field}  name={[field.name, 'name']}>
                 <Input />
                 </Form.Item>
                 <Form.Item {...field}  name={[field.name, 'psw']}>
                   <Input />
                 </Form.Item>
               </Space>
              )
            })
          }
          <Form.Item>
            <Button onClick={() => add()}></Button>
          </Form.Item>
        </>
      )}
</Form.List>

// 

- userList: [{name: 'aaa', psw: 'bbb'}, {name: 'ccc', psw: 'ddd'}]
```



## react-DnD



``` jsx
import { DndProvider } from 'react-dnd'
import { HTML5Backend } from 'react-dnd-html5-backend'

function App() {
    return (
    	<DndProvider backend={HTML5Backend}>
            <Example />
        </DndProvider>
    )
}
```

`Drag Source`

``` jsx
function S() {
    const [{ isDragging }, drag] = useDrag({
        item: { type: 'test' },
        collect: (monitor) => ({
          isDragging: !!monitor.isDragging(), // 
        }),
      })
    return (
    	<div ref={drag}></div>
    )
}
```

`Drop Target`

``` jsx
function T() {
    const [{ isOver, canDrop }, drop] = useDrop({
        accept: 'test', // 
        canDrop: () => canMoveKnight(x, y), // canDrop
        drop: () => moveKnight(x, y), // 
        collect: (monitor) => ({
          isOver: !!monitor.isOver(), // 
          canDrop: !!monitor.canDrop(),
        }),
      })
    return (
    	<div ref={drop}></div>
    )
}
```

#### Item Type

ABCAC

``` jsx
// A
item: { type: 'a' }
// B
item: { type: 'b' }
// C
accept: 'a'
```





## Mobx

