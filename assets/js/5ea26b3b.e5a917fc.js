"use strict";(globalThis.webpackChunkweuqiangcreate_website=globalThis.webpackChunkweuqiangcreate_website||[]).push([[55179],{94212(e,n,s){s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>h,frontMatter:()=>a,metadata:()=>i,toc:()=>t});const i=JSON.parse('{"id":"\u9009\u62e9\u7f16\u7a0b\u8bed\u8a00/node/publish","title":"\u53d1\u5e03\u6a21\u5757","description":"\u6a21\u5757\u4ea7\u7269\u7c7b\u578b","source":"@site/docs/docs/\u9009\u62e9\u7f16\u7a0b\u8bed\u8a00/node/publish.mdx","sourceDirName":"\u9009\u62e9\u7f16\u7a0b\u8bed\u8a00/node","slug":"/\u9009\u62e9\u7f16\u7a0b\u8bed\u8a00/node/publish","permalink":"/weuqiangcreate_website/docs/\u9009\u62e9\u7f16\u7a0b\u8bed\u8a00/node/publish","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"pnpm","permalink":"/weuqiangcreate_website/docs/\u9009\u62e9\u7f16\u7a0b\u8bed\u8a00/node/pnpm"},"next":{"title":"React","permalink":"/weuqiangcreate_website/docs/\u9009\u62e9\u7f16\u7a0b\u8bed\u8a00/react/"}}');var l=s(74848),r=s(28453);const a={},d="\u53d1\u5e03\u6a21\u5757",c={},t=[{value:"\u6a21\u5757\u4ea7\u7269\u7c7b\u578b",id:"\u6a21\u5757\u4ea7\u7269\u7c7b\u578b",level:2},{value:"\u53d1\u5e03\u524d\u51c6\u5907",id:"\u53d1\u5e03\u524d\u51c6\u5907",level:2},{value:"1. \u5b8c\u5584package.json",id:"1-\u5b8c\u5584packagejson",level:3},{value:"2. \u521b\u5efa.npmignore\u6587\u4ef6",id:"2-\u521b\u5efanpmignore\u6587\u4ef6",level:3},{value:"3. \u7f16\u5199README.md",id:"3-\u7f16\u5199readmemd",level:3},{value:"\u6784\u5efa\u914d\u7f6e",id:"\u6784\u5efa\u914d\u7f6e",level:2},{value:"Babel\u914d\u7f6e\uff08.babelrc\uff09",id:"babel\u914d\u7f6ebabelrc",level:3},{value:"Webpack\u914d\u7f6e\uff08webpack.config.js\uff09",id:"webpack\u914d\u7f6ewebpackconfigjs",level:3},{value:"\u53d1\u5e03\u6d41\u7a0b",id:"\u53d1\u5e03\u6d41\u7a0b",level:2},{value:"1. \u767b\u5f55npm",id:"1-\u767b\u5f55npm",level:3},{value:"2. \u68c0\u67e5\u5305\u540d\u662f\u5426\u53ef\u7528",id:"2-\u68c0\u67e5\u5305\u540d\u662f\u5426\u53ef\u7528",level:3},{value:"3. \u7248\u672c\u7ba1\u7406",id:"3-\u7248\u672c\u7ba1\u7406",level:3},{value:"4. \u53d1\u5e03",id:"4-\u53d1\u5e03",level:3},{value:"\u53d1\u5e03\u6700\u4f73\u5b9e\u8df5",id:"\u53d1\u5e03\u6700\u4f73\u5b9e\u8df5",level:2},{value:"1. \u8bed\u4e49\u5316\u7248\u672c\u63a7\u5236",id:"1-\u8bed\u4e49\u5316\u7248\u672c\u63a7\u5236",level:3},{value:"2. \u4f7f\u7528npm scripts",id:"2-\u4f7f\u7528npm-scripts",level:3},{value:"3. \u4f7f\u7528\u6807\u7b7e\u7ba1\u7406\u4e0d\u540c\u7248\u672c",id:"3-\u4f7f\u7528\u6807\u7b7e\u7ba1\u7406\u4e0d\u540c\u7248\u672c",level:3},{value:"4. \u64a4\u9500\u53d1\u5e03",id:"4-\u64a4\u9500\u53d1\u5e03",level:3},{value:"\u79c1\u6709\u5305\u53d1\u5e03",id:"\u79c1\u6709\u5305\u53d1\u5e03",level:2},{value:"1. \u53d1\u5e03\u5230npm\u79c1\u6709\u4ed3\u5e93",id:"1-\u53d1\u5e03\u5230npm\u79c1\u6709\u4ed3\u5e93",level:3},{value:"2. \u53d1\u5e03\u5230\u79c1\u6709registry",id:"2-\u53d1\u5e03\u5230\u79c1\u6709registry",level:3},{value:"\u81ea\u52a8\u5316\u53d1\u5e03",id:"\u81ea\u52a8\u5316\u53d1\u5e03",level:2},{value:"\u4f7f\u7528GitHub Actions",id:"\u4f7f\u7528github-actions",level:3},{value:"\u53d1\u5e03\u540e\u7ef4\u62a4",id:"\u53d1\u5e03\u540e\u7ef4\u62a4",level:2},{value:"1. \u76d1\u63a7\u4e0b\u8f7d\u91cf",id:"1-\u76d1\u63a7\u4e0b\u8f7d\u91cf",level:3},{value:"2. \u5904\u7406issue\u548cPR",id:"2-\u5904\u7406issue\u548cpr",level:3},{value:"3. \u5b9a\u671f\u66f4\u65b0\u4f9d\u8d56",id:"3-\u5b9a\u671f\u66f4\u65b0\u4f9d\u8d56",level:3},{value:"4. \u6587\u6863\u7ef4\u62a4",id:"4-\u6587\u6863\u7ef4\u62a4",level:3}];function p(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"\u53d1\u5e03\u6a21\u5757",children:"\u53d1\u5e03\u6a21\u5757"})}),"\n",(0,l.jsx)(n.h2,{id:"\u6a21\u5757\u4ea7\u7269\u7c7b\u578b",children:"\u6a21\u5757\u4ea7\u7269\u7c7b\u578b"}),"\n",(0,l.jsx)(n.p,{children:"\u901a\u5e38\u4f1a\u7f16\u8bd1\u591a\u4efd\u4ea7\u7269\u4ee5\u9002\u5e94\u4e0d\u540c\u7684\u4f7f\u7528\u573a\u666f\uff1a"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"ES\u4ea7\u7269"}),"\uff1a\u65b9\u4fbf\u4f7f\u7528\u8005\u8fdb\u884ctree shaking"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"lib\u4ea7\u7269\uff08CommonJS\uff09"}),"\uff1a\u9ed8\u8ba4\u65e0\u6cd5\u6309\u9700\u52a0\u8f7d\uff0c\u4f46\u4f7f\u7528\u8005\u53ef\u4ee5\u4f7f\u7528\u5177\u4f53\u7684\u8def\u5f84\u6765\u53ea\u5f15\u7528\u60f3\u8981\u7684\u5185\u5bb9\uff0c\u6216\u8005\u4f7f\u7528\u63d2\u4ef6\uff08\u5982babel-plugins-import\uff09"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"dist\u4ea7\u7269\uff08UMD\uff09"}),"\uff1a\u65e0\u6cd5\u6309\u9700\u52a0\u8f7d\uff0c\u53ef\u4ee5\u6d4f\u89c8\u5668\u76f4\u63a5\u52a0\u8f7d"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"\u53d1\u5e03\u524d\u51c6\u5907",children:"\u53d1\u5e03\u524d\u51c6\u5907"}),"\n",(0,l.jsx)(n.h3,{id:"1-\u5b8c\u5584packagejson",children:"1. \u5b8c\u5584package.json"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "name": "my-awesome-package",\n  "version": "1.0.0",\n  "description": "A brief description of your package",\n  "main": "lib/index.js",\n  "module": "es/index.js",\n  "types": "lib/index.d.ts",\n  "files": [\n    "lib",\n    "es",\n    "dist",\n    "README.md"\n  ],\n  "scripts": {\n    "build": "npm run build:lib && npm run build:es && npm run build:dist",\n    "build:lib": "babel src --out-dir lib --env-name lib",\n    "build:es": "babel src --out-dir es --env-name es",\n    "build:dist": "webpack --mode production",\n    "prepublishOnly": "npm run build"\n  },\n  "keywords": ["javascript", "utility"],\n  "author": "Your Name <your.email@example.com>",\n  "license": "MIT",\n  "repository": {\n    "type": "git",\n    "url": "https://github.com/username/my-awesome-package.git"\n  },\n  "bugs": {\n    "url": "https://github.com/username/my-awesome-package/issues"\n  },\n  "homepage": "https://github.com/username/my-awesome-package#readme"\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"2-\u521b\u5efanpmignore\u6587\u4ef6",children:"2. \u521b\u5efa.npmignore\u6587\u4ef6"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"src/\ntests/\n*.test.js\n.babelrc\nwebpack.config.js\ntsconfig.json\n.eslintrc\n.gitignore\n.github/\ndocs/\nexamples/\n"})}),"\n",(0,l.jsx)(n.h3,{id:"3-\u7f16\u5199readmemd",children:"3. \u7f16\u5199README.md"}),"\n",(0,l.jsx)(n.p,{children:"\u4e00\u4e2a\u597d\u7684README\u5e94\u8be5\u5305\u542b\uff1a"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u9879\u76ee\u7b80\u4ecb"}),"\n",(0,l.jsx)(n.li,{children:"\u5b89\u88c5\u65b9\u6cd5"}),"\n",(0,l.jsx)(n.li,{children:"\u4f7f\u7528\u793a\u4f8b"}),"\n",(0,l.jsx)(n.li,{children:"API\u6587\u6863"}),"\n",(0,l.jsx)(n.li,{children:"\u8d21\u732e\u6307\u5357"}),"\n",(0,l.jsx)(n.li,{children:"\u8bb8\u53ef\u8bc1\u4fe1\u606f"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"\u6784\u5efa\u914d\u7f6e",children:"\u6784\u5efa\u914d\u7f6e"}),"\n",(0,l.jsx)(n.h3,{id:"babel\u914d\u7f6ebabelrc",children:"Babel\u914d\u7f6e\uff08.babelrc\uff09"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "env": {\n    "lib": {\n      "presets": [\n        ["@babel/preset-env", {\n          "modules": "cjs"\n        }]\n      ]\n    },\n    "es": {\n      "presets": [\n        ["@babel/preset-env", {\n          "modules": false\n        }]\n      ]\n    }\n  }\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"webpack\u914d\u7f6ewebpackconfigjs",children:"Webpack\u914d\u7f6e\uff08webpack.config.js\uff09"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-javascript",children:"const path = require('path');\n\nmodule.exports = {\n  entry: './src/index.js',\n  output: {\n    path: path.resolve(__dirname, 'dist'),\n    filename: 'index.js',\n    library: 'MyAwesomePackage',\n    libraryTarget: 'umd',\n    globalObject: 'this'\n  },\n  module: {\n    rules: [\n      {\n        test: /\\.js$/,\n        exclude: /node_modules/,\n        use: {\n          loader: 'babel-loader',\n          options: {\n            presets: ['@babel/preset-env']\n          }\n        }\n      }\n    ]\n  }\n};\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u53d1\u5e03\u6d41\u7a0b",children:"\u53d1\u5e03\u6d41\u7a0b"}),"\n",(0,l.jsx)(n.h3,{id:"1-\u767b\u5f55npm",children:"1. \u767b\u5f55npm"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"npm login\n"})}),"\n",(0,l.jsx)(n.h3,{id:"2-\u68c0\u67e5\u5305\u540d\u662f\u5426\u53ef\u7528",children:"2. \u68c0\u67e5\u5305\u540d\u662f\u5426\u53ef\u7528"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"npm view <package-name>\n"})}),"\n",(0,l.jsx)(n.h3,{id:"3-\u7248\u672c\u7ba1\u7406",children:"3. \u7248\u672c\u7ba1\u7406"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u8865\u4e01\u7248\u672c\uff08bug\u4fee\u590d\uff09\nnpm version patch\n\n# \u6b21\u8981\u7248\u672c\uff08\u65b0\u529f\u80fd\uff09\nnpm version minor\n\n# \u4e3b\u8981\u7248\u672c\uff08\u7834\u574f\u6027\u66f4\u6539\uff09\nnpm version major\n"})}),"\n",(0,l.jsx)(n.h3,{id:"4-\u53d1\u5e03",children:"4. \u53d1\u5e03"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u6b63\u5f0f\u53d1\u5e03\nnpm publish\n\n# \u53d1\u5e03beta\u7248\u672c\nnpm publish --tag beta\n\n# \u53d1\u5e03\u5230\u6307\u5b9aregistry\nnpm publish --registry https://registry.npmjs.org/\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u53d1\u5e03\u6700\u4f73\u5b9e\u8df5",children:"\u53d1\u5e03\u6700\u4f73\u5b9e\u8df5"}),"\n",(0,l.jsx)(n.h3,{id:"1-\u8bed\u4e49\u5316\u7248\u672c\u63a7\u5236",children:"1. \u8bed\u4e49\u5316\u7248\u672c\u63a7\u5236"}),"\n",(0,l.jsxs)(n.p,{children:["\u9075\u5faa",(0,l.jsx)(n.a,{href:"https://semver.org/",children:"Semantic Versioning"}),"\u89c4\u8303\uff1a"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"MAJOR"}),"\uff1a\u4e0d\u517c\u5bb9\u7684API\u66f4\u6539"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"MINOR"}),"\uff1a\u5411\u540e\u517c\u5bb9\u7684\u529f\u80fd\u6dfb\u52a0"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"PATCH"}),"\uff1a\u5411\u540e\u517c\u5bb9\u7684bug\u4fee\u590d"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"2-\u4f7f\u7528npm-scripts",children:"2. \u4f7f\u7528npm scripts"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "scripts": {\n    "test": "jest",\n    "lint": "eslint src/",\n    "build": "npm run build:lib && npm run build:es && npm run build:dist",\n    "prepublishOnly": "npm run test && npm run lint && npm run build",\n    "postpublish": "git push && git push --tags"\n  }\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"3-\u4f7f\u7528\u6807\u7b7e\u7ba1\u7406\u4e0d\u540c\u7248\u672c",children:"3. \u4f7f\u7528\u6807\u7b7e\u7ba1\u7406\u4e0d\u540c\u7248\u672c"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u53d1\u5e03alpha\u7248\u672c\nnpm publish --tag alpha\n\n# \u53d1\u5e03beta\u7248\u672c\nnpm publish --tag beta\n\n# \u5c06beta\u7248\u672c\u8bbe\u4e3alatest\nnpm dist-tag add my-package@1.0.0-beta.1 latest\n"})}),"\n",(0,l.jsx)(n.h3,{id:"4-\u64a4\u9500\u53d1\u5e03",children:"4. \u64a4\u9500\u53d1\u5e03"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'# \u64a4\u9500\u6307\u5b9a\u7248\u672c\uff0824\u5c0f\u65f6\u5185\uff09\nnpm unpublish my-package@1.0.0\n\n# \u64a4\u9500\u6574\u4e2a\u5305\uff0824\u5c0f\u65f6\u5185\u4e14\u65e0\u5176\u4ed6\u4eba\u4f9d\u8d56\uff09\nnpm unpublish my-package --force\n\n# \u5e9f\u5f03\u7248\u672c\uff08\u63a8\u8350\uff09\nnpm deprecate my-package@1.0.0 "This version has been deprecated"\n'})}),"\n",(0,l.jsx)(n.h2,{id:"\u79c1\u6709\u5305\u53d1\u5e03",children:"\u79c1\u6709\u5305\u53d1\u5e03"}),"\n",(0,l.jsx)(n.h3,{id:"1-\u53d1\u5e03\u5230npm\u79c1\u6709\u4ed3\u5e93",children:"1. \u53d1\u5e03\u5230npm\u79c1\u6709\u4ed3\u5e93"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u53d1\u5e03scoped\u79c1\u6709\u5305\nnpm publish --access restricted\n\n# \u53d1\u5e03scoped\u516c\u5f00\u5305\nnpm publish --access public\n"})}),"\n",(0,l.jsx)(n.h3,{id:"2-\u53d1\u5e03\u5230\u79c1\u6709registry",children:"2. \u53d1\u5e03\u5230\u79c1\u6709registry"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'# \u8bbe\u7f6eregistry\nnpm config set registry https://your-private-registry.com/\n\n# \u6216\u5728package.json\u4e2d\u6307\u5b9a\n{\n  "publishConfig": {\n    "registry": "https://your-private-registry.com/"\n  }\n}\n'})}),"\n",(0,l.jsx)(n.h2,{id:"\u81ea\u52a8\u5316\u53d1\u5e03",children:"\u81ea\u52a8\u5316\u53d1\u5e03"}),"\n",(0,l.jsx)(n.h3,{id:"\u4f7f\u7528github-actions",children:"\u4f7f\u7528GitHub Actions"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"name: Publish Package\n\non:\n  push:\n    tags:\n      - 'v*'\n\njobs:\n  publish:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v2\n      - uses: actions/setup-node@v2\n        with:\n          node-version: '16'\n          registry-url: 'https://registry.npmjs.org'\n      - run: npm ci\n      - run: npm test\n      - run: npm run build\n      - run: npm publish\n        env:\n          NODE_AUTH_TOKEN: ${{ secrets.NPM_TOKEN }}\n"})}),"\n",(0,l.jsx)(n.h2,{id:"\u53d1\u5e03\u540e\u7ef4\u62a4",children:"\u53d1\u5e03\u540e\u7ef4\u62a4"}),"\n",(0,l.jsx)(n.h3,{id:"1-\u76d1\u63a7\u4e0b\u8f7d\u91cf",children:"1. \u76d1\u63a7\u4e0b\u8f7d\u91cf"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"npm view my-package\n"})}),"\n",(0,l.jsx)(n.h3,{id:"2-\u5904\u7406issue\u548cpr",children:"2. \u5904\u7406issue\u548cPR"}),"\n",(0,l.jsx)(n.p,{children:"\u53ca\u65f6\u56de\u5e94\u7528\u6237\u53cd\u9988\uff0c\u7ef4\u62a4\u9879\u76ee\u7684\u6d3b\u8dc3\u5ea6\u3002"}),"\n",(0,l.jsx)(n.h3,{id:"3-\u5b9a\u671f\u66f4\u65b0\u4f9d\u8d56",children:"3. \u5b9a\u671f\u66f4\u65b0\u4f9d\u8d56"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"npm audit\nnpm audit fix\n"})}),"\n",(0,l.jsx)(n.h3,{id:"4-\u6587\u6863\u7ef4\u62a4",children:"4. \u6587\u6863\u7ef4\u62a4"}),"\n",(0,l.jsx)(n.p,{children:"\u4fdd\u6301README\u3001CHANGELOG\u548cAPI\u6587\u6863\u7684\u66f4\u65b0\u3002"})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(p,{...e})}):p(e)}},28453(e,n,s){s.d(n,{R:()=>a,x:()=>d});var i=s(96540);const l={},r=i.createContext(l);function a(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:a(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);